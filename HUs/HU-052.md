# HU-052 — Funcionalidad de Página Principal (Home)

**Como** usuario externo  
**Quiero** interactuar con todos los elementos de la página principal  
**Para** navegar al catálogo de adopción, ver detalles de animales/productos y acceder a la tienda

---

## Dependencias

- HU-001 (Next.js App Router)
- HU-007 (Tailwind configurado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-011 (Conexión a Supabase configurada)
- HU-016 (Sistema de traducciones configurado)
- HU-026 (Catálogo de adopción implementado) - **REQUERIDO**
- HU-027 (Detalle de animal implementado) - **REQUERIDO**
- HU-028 (Tienda Solidaria implementada) - **REQUERIDO**
- HU-035 (Detalle de producto implementado) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU da **funcionalidad completa** a todos los elementos interactivos de la página principal.
- La página principal actualmente tiene elementos estáticos que no responden a interacciones.
- Se debe mantener el diseño existente (`docs/design/code_home_screen.html` y `docs/design/home_screen.png`).
- El hero dice "Encuentra tu Compañero Ideal" y debe llevar a la búsqueda de adopción.
- La sección de "Amigos Destacados" debe permitir navegar a detalles de animales.
- La sección "Compra con Propósito" debe permitir navegar a detalles de productos o a la tienda.
- El banner de IA se reemplaza por un **carousel de anuncios** (solo UI por ahora, sin funcionalidad real de anuncios).

Modelo de datos disponible:
- `animals`: para hero y amigos destacados
- `products`: para sección de tienda (si existen, sino usar mocks)

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/code_home_screen.html`
- Imagen: `docs/design/home_screen.png`
- Design System: `docs/design/system.md`

Estructura de la página:
- **Hero Section**:
  - Búsqueda funcional que navega a `/adopt` con query params
  - Animales del hero clickeables → `/adopt/[id]`
- **Banner de Anuncios** (reemplaza AI Banner):
  - Carousel de anuncios (UI estática por ahora)
  - Navegación entre slides
  - Indicadores de posición
- **Amigos Destacados**:
  - Cards clickeables → `/adopt/[id]`
  - Botón "Ver todos" → `/adopt`
- **Compra con Propósito**:
  - Productos clickeables → `/shop/[id]` (si existen en BD)
  - Si no hay productos, usar mocks y llevar a `/shop`
  - Botón "Visitar tienda" → `/shop`

Reglas:
- Respetar jerarquía visual del diseño existente.
- Usar tokens del Design System.
- Mantener responsive design.
- Transiciones suaves en navegación.

---

## Alcance

Incluye:
- Hacer funcional el hero:
  - Búsqueda navega a `/adopt` con query params (`?search=...`)
  - Filtros aplicados se pasan como query params
  - Animales del hero clickeables a `/adopt/[id]`
- Reemplazar AI Banner por carousel de anuncios:
  - Componente de carousel con navegación
  - Slides de anuncios (UI estática, sin backend)
  - Auto-play opcional
  - Indicadores de posición
- Hacer funcional "Amigos Destacados":
  - Cards clickeables a `/adopt/[id]`
  - Botón "Ver todos" navega a `/adopt`
- Hacer funcional "Compra con Propósito":
  - Obtener productos publicados desde Supabase
  - Si hay productos: cards clickeables a `/shop/[id]`
  - Si no hay productos: usar mocks y cards clickeables a `/shop`
  - Botón "Visitar tienda" navega a `/shop`
- Estados de loading y error
- Traducciones completas (ES/EN)

No incluye:
- Sistema real de anuncios (solo UI estática)
- Favoritos reales
- Tests automatizados

---

## Criterios de aceptación (Given / When / Then)

### 1) Hero - Búsqueda funcional

- **Dado** que escribo en el buscador del hero
- **Cuando** hago clic en "Buscar" o presiono Enter
- **Entonces** navego a `/adopt` con query param `?search=...`
- **Y** el catálogo muestra resultados filtrados

---

### 2) Hero - Filtros aplicados

- **Dado** que selecciono filtros en el hero (especie, ubicación)
- **Cuando** hago clic en "Buscar"
- **Entonces** navego a `/adopt` con query params correspondientes
- **Y** los filtros se aplican en el catálogo

---

### 3) Hero - Animales clickeables

- **Dado** los animales mostrados en el hero
- **Cuando** hago clic en la imagen de un animal
- **Entonces** navego a `/adopt/[id]` del animal
- **Y** veo el detalle del animal

---

### 4) Banner de anuncios (carousel)

- **Dado** el banner de anuncios
- **Cuando** se carga la página
- **Entonces** se muestra un carousel con anuncios
- **Y** puedo navegar entre slides
- **Y** se muestran indicadores de posición

---

### 5) Amigos Destacados - Cards clickeables

- **Dado** un animal en "Amigos Destacados"
- **Cuando** hago clic en la card del animal
- **Entonces** navego a `/adopt/[id]`
- **Y** veo el detalle del animal

---

### 6) Amigos Destacados - Botón "Ver todos"

- **Dado** el botón "Ver todos" en "Amigos Destacados"
- **Cuando** hago clic
- **Entonces** navego a `/adopt`
- **Y** veo el catálogo completo

---

### 7) Compra con Propósito - Productos reales

- **Dado** productos publicados en Supabase
- **Cuando** se carga la sección
- **Entonces** se muestran productos reales
- **Y** al hacer clic en un producto navego a `/shop/[id]`

---

### 8) Compra con Propósito - Mocks si no hay productos

- **Dado** que no hay productos publicados
- **Cuando** se carga la sección
- **Entonces** se muestran productos mock
- **Y** al hacer clic navego a `/shop` (no a detalle)

---

### 9) Compra con Propósito - Botón "Visitar tienda"

- **Dado** el botón "Visitar tienda"
- **Cuando** hago clic
- **Entonces** navego a `/shop`
- **Y** veo el catálogo de la tienda

---

### 10) Estados de loading

- **Dado** que se cargan datos de Supabase
- **Cuando** se consultan productos o animales
- **Entonces** se muestra un estado de loading
- **Y** desaparece al finalizar

---

### 11) Manejo de errores

- **Dado** que ocurre un error al consultar Supabase
- **Cuando** falla la carga de datos
- **Entonces** se muestra un mensaje traducido
- **Y** la UI no se rompe (muestra mocks o estado vacío)

---

### 12) Traducciones

- **Dado** la implementación
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations`
- **Y** existen traducciones en `src/messages/es/home.json` y `src/messages/en/home.json`

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC.
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- Supabase solo vive en Infrastructure.

### Navegación
- Hero búsqueda: `router.push('/adopt?search=...&species=...&location=...')`
- Animales: `router.push('/adopt/[id]')`
- Productos: `router.push('/shop/[id]')` o `router.push('/shop')` si es mock
- Usar `next/navigation` para navegación en App Router.

### Supabase / Queries
- Productos publicados:
  - `SELECT * FROM products WHERE is_published = true LIMIT 3`
- Si no hay productos, usar mocks definidos en el componente.

### Carousel de anuncios
- Componente reutilizable con:
  - Navegación manual (flechas)
  - Indicadores de posición
  - Auto-play opcional (configurable)
  - Responsive
- Anuncios como datos estáticos (array de objetos con imagen, título, descripción).

### Traducciones
- Usar `useTranslations('home')`.
- No hardcodear textos.
- Agregar nuevas keys si es necesario.

### Dependencias / Paquetes
- No agregar dependencias nuevas.
- Usar componentes existentes de MUI para el carousel.

---

## Implementación sugerida

```
src/presentation/components/home/
├── HeroSection.tsx (modificar)
├── AnnouncementsCarousel.tsx (nuevo, reemplaza AiBanner.tsx)
├── FeaturedAnimalsSection.tsx (modificar)
├── StoreSection.tsx (modificar)
└── hooks/
    └── useHomeNavigation.ts (nuevo, helper para navegación)

src/domain/
└── usecases/
    └── home/
        └── GetHomeProductsUseCase.ts (nuevo, opcional si se necesita)

src/infrastructure/
└── repositories/
    └── ProductRepository.ts (extender si es necesario)

src/messages/
├── es/
│   └── home.json (actualizar)
└── en/
    └── home.json (actualizar)
```

---

## Validación

Comandos mínimos:
- `npm run dev`
- `npm run build`

Verificaciones:
- Hero navega correctamente a `/adopt` con filtros
- Animales del hero clickeables
- Carousel de anuncios funcional
- Amigos destacados clickeables
- Productos clickeables (reales o mocks)
- Botones de navegación funcionan
- Traducciones completas

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Hero funcional con búsqueda y navegación
- [ ] Carousel de anuncios implementado
- [ ] Amigos destacados clickeables
- [ ] Compra con propósito funcional (reales o mocks)
- [ ] Navegación correcta a todas las rutas
- [ ] Traducciones incluidas (ES/EN)
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add home page interactivity and navigation`
