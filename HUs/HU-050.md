# HU-050 — Pantalla intermedia de selección de tipo de registro

**Como** usuario nuevo  
**Quiero** ver una pantalla donde pueda elegir si me registro como adoptante/external o como fundación  
**Para** ser dirigido al formulario de registro correcto según mi tipo de usuario

---

## Dependencias

- HU-001 (Next.js App Router)
- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-016 (Sistema de traducciones configurado)
- HU-015 (Registro de fundación implementado)
- HU-040 (Registro de usuario externo implementado)

**Conexión con HU-051:**
- Esta HU (HU-050) crea la pantalla de selección de tipo de registro en `/register`.
- HU-051 actualiza el login para que todos los enlaces de registro apunten a `/register` (esta pantalla).
- **Flujo completo:** Login (HU-051) → Pantalla de selección (HU-050) → Formulario de registro correspondiente.

---

## Contexto / Notas

- Esta HU implementa una **pantalla intermedia de selección** que aparece antes de los formularios de registro.
- El flujo actual tiene:
  - `/register` → Formulario de registro de fundación
  - `/register/external` → Formulario de registro de usuario externo
- **Nuevo flujo propuesto:**
  - `/register` → **Nueva pantalla de selección** (esta HU)
  - `/register/foundation` → Formulario de registro de fundación (mover desde `/register`)
  - `/register/external` → Formulario de registro de usuario externo (mantener)
- La pantalla de login (`/login`) debe actualizar los enlaces (esto se hace en **HU-051**):
  - "Create an account" → `/register` (pantalla de selección)
  - "Register your foundation" → `/register` (pantalla de selección)
- **Nota:** Los cambios en el login se implementan en HU-051, que depende de esta HU.
- Esta pantalla debe ser **pública** (no requiere autenticación).
- Los usuarios autenticados que intenten acceder deben ser redirigidos según su rol.

---

## Diseño (OBLIGATORIO si hay UI)

Referencias:
- Diseño: `docs/design/dual_register_screen.png`
- Código HTML: `docs/design/dual_register_code.html`
- Design System: `docs/design/system.md`

Reglas:
- Respetar jerarquía visual del diseño.
- Usar tokens definidos en el Design System (no inventar tamaños/colores).
- La pantalla debe mostrar dos tarjetas grandes:
  - **Tarjeta 1: "Adopters & Sponsors"**
    - Icono: `pets` (Material Symbols)
    - Título: "Adopters & Sponsors"
    - Descripción: "Looking to find your new best friend or support a specific pet? Join our community of animal lovers and start browsing thousands of pets waiting for a home."
    - Botón: "Join to Adopt" (estilo primary)
    - Al hacer clic → redirige a `/register/external`
  - **Tarjeta 2: "Foundations"**
    - Icono: `home_health` (Material Symbols)
    - Título: "Foundations"
    - Descripción: "Are you a shelter or an organization? Manage your pets, track sponsorships, and connect with potential adopters through our professional platform."
    - Botón: "Register your Foundation" (estilo secondary/outline)
    - Al hacer clic → redirige a `/register/foundation`
- Header debe incluir:
  - Logo de Amigo Gigante
  - Enlace "Already have an account? Log in" (apunta a `/login`)
- Footer debe incluir enlaces: About, Privacy, Terms, Contact
- Diseño responsive:
  - Desktop: 2 columnas (grid)
  - Mobile: 1 columna (stack)
- Efectos hover en las tarjetas (elevación y sombra).
- Gradiente de fondo según el diseño.

---

## Alcance

Incluye:
- Crear nueva página `/register` con la pantalla de selección
- Crear componente `RegisterTypeSelectionPage` o similar
- Mover el formulario de registro de fundación de `/register` a `/register/foundation`
- Actualizar enlaces en la pantalla de login (`/login`) para que apunten a `/register`
- Actualizar cualquier enlace interno que apunte a `/register` para que apunte a `/register/foundation` o `/register/external` según corresponda
- Agregar traducciones para todos los textos de la nueva pantalla
- Implementar redirección para usuarios autenticados:
  - Si el usuario ya está autenticado y accede a `/register`, redirigir según su rol:
    - `foundation_user` → `/foundations`
    - `external` → `/` (home)
    - `admin` → `/admin`

No incluye:
- Modificar los formularios de registro existentes (solo mover rutas)
- Cambiar la lógica de registro (use cases y repositorios se mantienen igual)

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Estructura de rutas
```
/[locale]/register                    → Nueva pantalla de selección (esta HU)
/[locale]/register/foundation         → Formulario de registro de fundación (mover desde /register)
/[locale]/register/external           → Formulario de registro de usuario externo (mantener)
```

### Redirecciones
- Usuarios autenticados que accedan a `/register` deben ser redirigidos según su rol.
- Usuarios no autenticados pueden acceder libremente a `/register` y sus subrutas.

### Traducciones (OBLIGATORIO si hay UI con texto)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/register.json` (español)
  - `src/messages/en/register.json` (inglés)
- Keys sugeridas:
  - `register.selection.title` → "How do you want to start your journey?"
  - `register.selection.subtitle` → "Choose your path to make a difference in the lives of our furry friends."
  - `register.selection.adopter.title` → "Adopters & Sponsors"
  - `register.selection.adopter.description` → "Looking to find your new best friend..."
  - `register.selection.adopter.button` → "Join to Adopt"
  - `register.selection.foundation.title` → "Foundations"
  - `register.selection.foundation.description` → "Are you a shelter or an organization?..."
  - `register.selection.foundation.button` → "Register your Foundation"
  - `register.selection.header.login` → "Already have an account?"
  - `register.selection.header.loginLink` → "Log in"

### Componentes a crear/modificar
1. **Nuevo componente**: `RegisterTypeSelectionPage` o similar
   - Ubicación: `src/presentation/components/register/RegisterTypeSelectionPage.tsx`
   - Renderiza las dos tarjetas de selección
   - Maneja la navegación a `/register/foundation` y `/register/external`
2. **Nueva página**: `src/app/[locale]/register/page.tsx`
   - Reemplaza el contenido actual (que se moverá a `/register/foundation`)
   - Renderiza `RegisterTypeSelectionPage`
   - Implementa redirección para usuarios autenticados
3. **Mover página existente**: `src/app/[locale]/register/page.tsx` → `src/app/[locale]/register/foundation/page.tsx`
   - Mover todo el contenido actual de `/register` a `/register/foundation`
4. **Actualizar login** (esto se hace en **HU-051**):
   - Actualizar enlaces "Create an account" y "Register your foundation" para que apunten a `/register`
   - Actualizar el botón "Get Started" en el header del login

### Validación de usuarios autenticados
- En `src/app/[locale]/register/page.tsx`, verificar si el usuario está autenticado.
- Si está autenticado, redirigir según su rol usando `useRouter` y `getSession()`.
- Si no está autenticado, mostrar la pantalla de selección normalmente.

---

## Criterios de aceptación

- [ ] La pantalla `/register` muestra las dos tarjetas de selección según el diseño
- [ ] Al hacer clic en "Join to Adopt", redirige a `/register/external`
- [ ] Al hacer clic en "Register your Foundation", redirige a `/register/foundation`
- [ ] El formulario de registro de fundación funciona correctamente en `/register/foundation`
- [ ] El formulario de registro de usuario externo funciona correctamente en `/register/external`
- [ ] Los enlaces en la pantalla de login apuntan correctamente a `/register` (verificado en HU-051)
- [ ] Los usuarios autenticados son redirigidos automáticamente desde `/register` según su rol
- [ ] Todos los textos están traducidos (español e inglés)
- [ ] El diseño es responsive (desktop y mobile)
- [ ] Los efectos hover funcionan correctamente en las tarjetas
- [ ] El header y footer se muestran correctamente según el diseño

---

## Notas de implementación

- **Importante**: No modificar la lógica de los use cases de registro (`RegisterFoundationUseCase`, `RegisterExternalUserUseCase`). Solo se mueven rutas y se crea la pantalla de selección.
- La pantalla de selección es **puramente de presentación** (no tiene lógica de negocio).
- Considerar usar `next/link` para la navegación entre páginas.
- Mantener la consistencia visual con el resto de la aplicación (header, footer, colores, tipografía).
