# HU-025 — Dashboard de Fundación (UI y Funcionalidad con Supabase)

**Como** usuario de una fundación  
**Quiero** ver un dashboard con métricas, gráficos y actividad reciente de mi fundación  
**Para** tener una vista general del estado de mis animales, eventos y operaciones

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-014 (Formik y Yup configurados)
- HU-016 (Sistema de traducciones configurado)
- HU-018 (Layout del dashboard de fundaciones con sidebar) - **REQUERIDO**
- HU-022 (UI de gestión de animales implementada)
- HU-023 (Funcionalidad de gestión de animales con Supabase)

---

## Contexto / Notas

- Esta HU implementa el **dashboard principal** de la fundación con métricas, gráficos y actividad reciente.
- El dashboard debe seguir el diseño exacto de `docs/design/dashboard_screen.png` y `docs/design/dashboard_code.html`.
- El dashboard se mostrará en `/foundations` (página principal del área de fundaciones).
- El layout del dashboard de fundaciones (HU-018) ya está implementado y debe usarse.
- **Adaptación al modelo de datos**: Algunas métricas no existen en la BD actual, se usarán mocks o valores calculados.

Modelo de datos disponible (según `docs/scripts/db.sql`):
- Tabla `animals`: `id`, `foundation_id`, `name`, `species`, `breed`, `status`, `cover_image_url`, `created_at`
- Tabla `events`: `id`, `foundation_id`, `title`, `description`, `starts_at`, `ends_at`, `created_at`
- Tabla `products`: `id`, `foundation_id`, `name`, `price`, `image_url`, `created_at`
- Tabla `foundations`: `id`, `name`, `logo_url`

Métricas disponibles desde BD:
- **Animales en Cuidado**: Contar `animals` de la fundación (todos los estados)
- **Patrocinios Activos**: No existe tabla de patrocinios → usar mock o 0
- **Adopciones Pendientes**: No existe tabla de adopciones → usar mock o 0
- **Recaudado (Mes)**: No existe tabla de transacciones → usar mock o 0

Embudo de Adopción:
- No existe tabla de adopciones → usar mock o datos calculados basados en animales con `status = 'adopted'`

Actividad Reciente:
- Mostrar animales recientes (últimos 5-10)
- Mostrar eventos recientes (últimos 3-5)
- Mostrar productos recientes (últimos 3-5)
- Combinar y ordenar por fecha

Requiere Atención:
- Animales con `status = 'in_treatment'` (revisión veterinaria)
- Productos con stock bajo (si existe campo, sino mock)
- Eventos próximos (si `starts_at` está cerca)

Reglas de autorización:
- El usuario debe estar autenticado y ser miembro de la fundación.
- Solo puede ver datos de su propia fundación.
- Obtener `foundation_id` del usuario autenticado (vía `foundation_members`).

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/dashboard_code.html`
- Imagen: `docs/design/dashboard_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del dashboard:
- **Header**:
  - Saludo: "Hola, [Nombre Fundación]!"
  - Fecha: "Oct 26, 2023 - Resumen diario de actividad"
  - Botón de notificaciones (icono)
  - Botón "Modo Vista" (dropdown o botón)
- **KPI Cards** (4 cards en grid):
  - **Animales en Cuidado**: número, icono de paw, badge de tendencia (+2%)
  - **Patrocinios Activos**: número, icono de corazón, badge de tendencia (+12%)
  - **Adopciones Pendientes**: número, icono de casa, badge de tendencia (0%)
  - **Recaudado (Mes)**: monto, icono de dinero, badge de tendencia (+5%)
- **Embudo de Adopción** (sección izquierda):
  - Título: "Estado del Embudo de Adopción"
  - Botón "Ver reporte"
  - 4 barras de progreso:
    - Solicitudes Recibidas (24, 100%)
    - Entrevistas Programadas (12, 50%)
    - Visitas Domiciliarias (5, 20%)
    - Adopciones Completadas (3, 12%)
  - Leyenda: "En proceso" (azul), "Entrada total" (gris)
- **Actividad Reciente** (tabla, sección izquierda):
  - Título: "Actividad Reciente"
  - Tabla con columnas: Animal/Asunto, Tipo, Fecha, Estado
  - Filas con animales, eventos, productos recientes
  - Badges de estado según tipo
- **Acciones Rápidas** (sección derecha):
  - Título: "Acciones Rápidas"
  - Botón primario: "+ Nuevo Animal" (navega a `/foundations/animals/add`)
  - Botón secundario: "Registrar Gasto" (solo UI, sin funcionalidad)
  - Botón secundario: "Crear Campaña" (solo UI, sin funcionalidad)
- **Requiere Atención** (sección derecha):
  - Título: "Requiere Atención"
  - Badge con número de alertas (ej: "3")
  - Cards de alertas:
    - Revisión Veterinaria (rojo): "Rocky necesita su vacuna anual antes del viernes."
    - Stock Bajo (amarillo): "Quedan menos de 5 bolsas de alimento cachorro."
    - Voluntarios Sábado (gris): "Faltan 2 cupos para la jornada de limpieza."
  - Botón "Ver todas las tareas" (solo UI)

Reglas:
- Usar tokens del Design System.
- El dashboard debe ser responsive.
- Los KPI cards deben tener hover effects.
- Las barras de progreso deben ser visuales (CSS, no librerías de gráficos).
- La tabla debe ser responsive (scroll horizontal en móvil).

---

## Alcance

Incluye:
- Crear página `/foundations` (página principal del dashboard)
- Implementar header del dashboard con saludo y fecha
- Implementar 4 KPI cards con métricas:
  - Animales en Cuidado (desde BD)
  - Patrocinios Activos (mock, ya que no existe en BD)
  - Adopciones Pendientes (mock, ya que no existe en BD)
  - Recaudado (Mes) (mock, ya que no existe en BD)
- Implementar sección "Embudo de Adopción" con barras de progreso (mock o calculado)
- Implementar tabla "Actividad Reciente" con datos reales:
  - Animales recientes (desde BD)
  - Eventos recientes (desde BD)
  - Productos recientes (desde BD)
- Implementar sección "Acciones Rápidas" con botones
- Implementar sección "Requiere Atención" con alertas:
  - Animales con `status = 'in_treatment'` (desde BD)
  - Otras alertas (mock si no hay datos)
- Conectar con Supabase para cargar datos reales
- Obtener `foundation_id` del usuario autenticado
- Calcular métricas desde BD
- Manejar estados de loading
- Manejar errores y mostrar mensajes traducidos
- Agregar traducciones completas (español e inglés)
- Navegación funcional desde botones (ej: "+ Nuevo Animal" → `/foundations/animals/add`)

No incluye:
- Funcionalidad de "Registrar Gasto" (HU futura)
- Funcionalidad de "Crear Campaña" (HU futura)
- Funcionalidad de "Ver reporte" del embudo (HU futura)
- Funcionalidad de "Ver todas las tareas" (HU futura)
- Gestión de notificaciones (HU futura)
- Modo Vista (dropdown funcional, solo UI)
- Tests automatizados (si luego se define estrategia de tests, se hará en HU futura)
- Optimización avanzada de queries (indexes, etc. se asume que ya están en BD)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página del dashboard creada

- **Dado** que necesito ver el dashboard de mi fundación
- **Cuando** navego a la ruta `/foundations`
- **Entonces** veo el dashboard completo
- **Y** la página usa el layout del dashboard de fundaciones (HU-018)
- **Y** la página se carga sin errores
- **Y** el sidebar muestra "Dashboard" como activo

---

### 2) Header del dashboard implementado

- **Dado** que estoy en el dashboard
- **Cuando** observo el header
- **Entonces** veo:
  - Saludo: "Hola, [Nombre Fundación]!" (nombre desde BD)
  - Fecha actual formateada: "[Fecha] - Resumen diario de actividad"
  - Botón de notificaciones (icono)
  - Botón "Modo Vista"
- **Y** el nombre de la fundación se obtiene desde Supabase

---

### 3) KPI Cards implementadas

- **Dado** que estoy en el dashboard
- **Cuando** observo las KPI cards
- **Entonces** veo 4 cards:
  - Animales en Cuidado (número desde BD)
  - Patrocinios Activos (mock o 0)
  - Adopciones Pendientes (mock o 0)
  - Recaudado (Mes) (mock o 0)
- **Y** cada card tiene icono, número, label y badge de tendencia
- **Y** las cards tienen hover effects
- **Y** el número de "Animales en Cuidado" se calcula desde BD

---

### 4) Métrica "Animales en Cuidado" desde BD

- **Dado** que tengo animales en mi fundación
- **Cuando** se carga el dashboard
- **Entonces** se consulta Supabase para contar animales de la fundación
- **Y** se muestra el total correcto
- **Y** se muestra badge de tendencia (mock o calculado vs mes anterior)

---

### 5) Sección "Embudo de Adopción" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección "Embudo de Adopción"
- **Entonces** veo:
  - Título y botón "Ver reporte"
  - 4 barras de progreso con valores y porcentajes
  - Leyenda con colores
- **Y** las barras son visuales (CSS)
- **Y** los datos son mock o calculados (ya que no existe tabla de adopciones)

---

### 6) Tabla "Actividad Reciente" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la tabla "Actividad Reciente"
- **Entonces** veo una tabla con:
  - Headers: Animal/Asunto, Tipo, Fecha, Estado
  - Filas con animales, eventos y productos recientes
  - Badges de estado según tipo
- **Y** los datos se obtienen desde Supabase
- **Y** se ordenan por fecha (más recientes primero)
- **Y** se muestran máximo 10-15 items

---

### 7) Actividad Reciente desde BD

- **Dado** que tengo animales, eventos y productos en mi fundación
- **Cuando** se carga el dashboard
- **Entonces** se consultan:
  - Últimos 5-10 animales (desde `animals`)
  - Últimos 3-5 eventos (desde `events`)
  - Últimos 3-5 productos (desde `products`)
- **Y** se combinan y ordenan por fecha
- **Y** se muestran en la tabla con formato correcto

---

### 8) Sección "Acciones Rápidas" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección "Acciones Rápidas"
- **Entonces** veo:
  - Título: "Acciones Rápidas"
  - Botón primario: "+ Nuevo Animal" (navega a `/foundations/animals/add`)
  - Botón secundario: "Registrar Gasto" (solo UI)
  - Botón secundario: "Crear Campaña" (solo UI)
- **Y** el botón "+ Nuevo Animal" navega correctamente

---

### 9) Sección "Requiere Atención" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección "Requiere Atención"
- **Entonces** veo:
  - Título con badge de número de alertas
  - Cards de alertas con iconos y mensajes
  - Botón "Ver todas las tareas"
- **Y** se muestran alertas basadas en datos reales:
  - Animales con `status = 'in_treatment'` (desde BD)
  - Otras alertas (mock si no hay datos)

---

### 10) Alertas desde BD

- **Dado** que tengo animales con `status = 'in_treatment'`
- **Cuando** se carga el dashboard
- **Entonces** se consultan animales con ese status
- **Y** se generan alertas de "Revisión Veterinaria"
- **Y** se muestran en la sección "Requiere Atención"

---

### 11) Estados de loading

- **Dado** que se cargan datos del dashboard
- **Cuando** se están consultando datos de Supabase
- **Entonces** se muestra un estado de loading (spinner, skeleton, etc.)
- **Y** la UI indica que se está cargando
- **Y** al finalizar, el estado de loading desaparece

---

### 12) Manejo de errores

- **Dado** que ocurre un error al cargar datos
- **Cuando** Supabase retorna error (sin permisos, conectividad, etc.)
- **Entonces** se muestra un mensaje traducido apropiado
- **Y** la UI no se rompe
- **Y** el usuario puede intentar nuevamente

---

### 13) Obtener foundation_id del usuario

- **Dado** que el usuario está autenticado
- **Cuando** se carga el dashboard
- **Entonces** se obtiene `foundation_id` del usuario (vía `foundation_members`)
- **Y** se usan todas las queries con ese `foundation_id`
- **Y** si no tiene fundación, se muestra error apropiado

---

### 14) Traducciones implementadas

- **Dado** que se implementa el dashboard
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/dashboard.json` y `src/messages/en/dashboard.json`
- **Y** no hay textos hardcodeados

---

### 15) Layout responsive

- **Dado** que estoy en el dashboard
- **Cuando** cambio el tamaño de la ventana
- **Entonces** el dashboard se adapta:
  - Grid de KPI cards: 1 columna en móvil, 2 en tablet, 4 en desktop
  - Secciones se apilan verticalmente en móvil
  - Tabla tiene scroll horizontal en móvil
- **Y** todos los elementos son legibles y accesibles

---

### 16) Reglas de arquitectura cumplidas

- **Dado** que se implementa la funcionalidad
- **Cuando** se revisan imports y capas
- **Entonces** Domain no importa Supabase/React/Next/MUI/Tailwind/Inversify
- **Y** Presentation consume UseCases vía IoC
- **Y** Infrastructure contiene las implementaciones de repositorios y el wiring
- **Y** Supabase solo vive en Infrastructure

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de carga del dashboard

1. Usuario navega a `/foundations` (Presentation)
2. `DashboardPage` llama a `GetDashboardDataUseCase` (Presentation → Domain)
3. UseCase obtiene `foundation_id` del usuario (vía `GetSessionUseCase` o `FoundationMembershipRepository`)
4. UseCase llama a múltiples repositorios:
   - `AnimalRepository.getAnimalsCount()` (Domain → Infrastructure)
   - `AnimalRepository.getRecentAnimals()` (Domain → Infrastructure)
   - `EventRepository.getRecentEvents()` (Domain → Infrastructure)
   - `ProductRepository.getRecentProducts()` (Domain → Infrastructure)
5. Repositorios consultan Supabase
6. UseCase retorna datos consolidados
7. Presentation muestra datos en el dashboard

### Obtener foundation_id del usuario

- Usar `supabaseClient.auth.getUser()` para obtener `user.id`.
- Query: `SELECT foundation_id FROM foundation_members WHERE user_id = :userId LIMIT 1`
- Si no existe membership, manejar como error (usuario sin fundación).
- Puede reutilizar lógica de `FoundationProfileRepository.getFoundationIdForUser()`.

### Consultas de métricas

- **Animales en Cuidado**: `SELECT COUNT(*) FROM animals WHERE foundation_id = :foundationId`
- **Animales recientes**: `SELECT * FROM animals WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 10`
- **Eventos recientes**: `SELECT * FROM events WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 5`
- **Productos recientes**: `SELECT * FROM products WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 5`
- **Animales en tratamiento**: `SELECT * FROM animals WHERE foundation_id = :foundationId AND status = 'in_treatment'`

### Métricas mock

- **Patrocinios Activos**: Usar valor mock (ej: 120) o 0 si no hay datos
- **Adopciones Pendientes**: Usar valor mock (ej: 3) o 0 si no hay datos
- **Recaudado (Mes)**: Usar valor mock (ej: $1,250) o $0 si no hay datos
- **Embudo de Adopción**: Usar valores mock o calcular basado en animales con `status = 'adopted'`

### Formato de datos

- Fechas: Formatear con `Intl.DateTimeFormat` o librería de fechas
- Monedas: Formatear con `Intl.NumberFormat` (ej: "$1,250")
- Porcentajes: Calcular y formatear (ej: "+2%")
- Nombres de fundación: Obtener desde `foundations.name`

### Manejo de errores

- Los errores de Supabase deben traducirse a mensajes legibles en español e inglés.
- Usar `PostgrestError` de Supabase para identificar tipos de error.
- Los mensajes de error deben estar en los archivos de traducción.
- Mostrar errores en la UI sin romper el layout.

### Traducciones
- **TODOS los mensajes visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/dashboard.json` (español)
  - `src/messages/en/dashboard.json` (inglés)
- Incluir traducciones para:
  - Títulos y subtítulos
  - Labels de métricas
  - Mensajes de error
  - Estados de loading
  - Tipos de actividad
  - Alertas
- Usar `useTranslations('dashboard')` hook de `next-intl` para acceder a traducciones.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Supabase ya está configurado (HU-011).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/app/[locale]/foundations/
└── page.tsx                        # Página principal del dashboard

src/presentation/components/dashboard/
├── DashboardPage.tsx               # Componente principal del dashboard
├── DashboardHeader.tsx             # Header con saludo y fecha
├── DashboardKPICards.tsx          # Grid de 4 KPI cards
├── DashboardKPICard.tsx           # Card individual de KPI
├── AdoptionFunnelSection.tsx      # Sección del embudo de adopción
├── RecentActivityTable.tsx        # Tabla de actividad reciente
├── QuickActionsSection.tsx        # Sección de acciones rápidas
└── NeedsAttentionSection.tsx     # Sección de requiere atención

src/domain/
├── models/
│   └── DashboardData.ts           # Modelo de datos del dashboard
├── repositories/
│   ├── IAnimalRepository.ts       # Extender con getAnimalsCount, getRecentAnimals
│   ├── IEventRepository.ts        # Nuevo: para eventos
│   └── IProductRepository.ts      # Nuevo: para productos
└── usecases/
    └── dashboard/
        └── GetDashboardDataUseCase.ts # UseCase para obtener datos del dashboard

src/infrastructure/
├── repositories/
│   ├── AnimalRepository.ts        # Extender con nuevos métodos
│   ├── EventRepository.ts          # Nuevo: implementación para eventos
│   └── ProductRepository.ts       # Nuevo: implementación para productos
└── ioc/
    └── ...                        # Agregar bindings de nuevos repositorios y use cases

src/messages/
├── es/
│   └── dashboard.json             # Traducciones en español
└── en/
    └── dashboard.json             # Traducciones en inglés
```

### Flujo de implementación:

1. **Extender IAnimalRepository**:
   ```typescript
   export interface IAnimalRepository {
     getHomeAnimals(): Promise<HomeAnimals>;
     getAnimals(params: GetAnimalsParams): Promise<GetAnimalsResult>;
     getAnimalsCount(foundationId: string): Promise<number>; // Nuevo
     getRecentAnimals(foundationId: string, limit: number): Promise<AnimalManagement[]>; // Nuevo
     getAnimalsInTreatment(foundationId: string): Promise<AnimalManagement[]>; // Nuevo
   }
   ```

2. **Crear IEventRepository**:
   ```typescript
   export interface RecentEvent {
     id: number;
     title: string;
     startsAt: string | null;
     createdAt: string;
   }
   
   export interface IEventRepository {
     getRecentEvents(foundationId: string, limit: number): Promise<RecentEvent[]>;
   }
   ```

3. **Crear IProductRepository**:
   ```typescript
   export interface RecentProduct {
     id: number;
     name: string;
     price: number | null;
     createdAt: string;
   }
   
   export interface IProductRepository {
     getRecentProducts(foundationId: string, limit: number): Promise<RecentProduct[]>;
   }
   ```

4. **Crear GetDashboardDataUseCase**:
   ```typescript
   export interface DashboardData {
     foundationName: string;
     animalsCount: number;
     recentActivity: ActivityItem[];
     animalsInTreatment: AnimalManagement[];
     // Métricas mock
     sponsorshipsCount: number;
     pendingAdoptions: number;
     monthlyRevenue: number;
   }
   
   export class GetDashboardDataUseCase {
     constructor(
       private readonly animalRepository: IAnimalRepository,
       private readonly eventRepository: IEventRepository,
       private readonly productRepository: IProductRepository,
       private readonly foundationRepository: IFoundationRepository,
       private readonly foundationMembershipRepository: IFoundationMembershipRepository
     ) {}
     
     async execute(): Promise<DashboardData> {
       // 1. Obtener usuario autenticado
       // 2. Obtener foundation_id del usuario
       // 3. Obtener nombre de fundación
       // 4. Consultar métricas y datos recientes
       // 5. Consolidar y retornar
     }
   }
   ```

5. **Implementar repositorios**:
   - Extender `AnimalRepository` con nuevos métodos
   - Crear `EventRepository` con implementación en Supabase
   - Crear `ProductRepository` con implementación en Supabase

6. **Crear componentes del dashboard**:
   - `DashboardPage`: componente principal que estructura el dashboard
   - `DashboardHeader`: header con saludo y fecha
   - `DashboardKPICards`: grid de 4 cards
   - `AdoptionFunnelSection`: sección del embudo
   - `RecentActivityTable`: tabla de actividad
   - `QuickActionsSection`: acciones rápidas
   - `NeedsAttentionSection`: alertas

7. **Conectar con UseCase**:
   - Inyectar `GetDashboardDataUseCase` vía IoC
   - Cargar datos al montar el componente
   - Manejar estados de loading y error
   - Mostrar datos en los componentes

8. **Agregar traducciones**:
   - Extender `src/messages/es/dashboard.json` y `src/messages/en/dashboard.json`
   - Agregar todas las keys necesarias

### Estructura de traducciones sugerida:

**src/messages/es/dashboard.json:**
```json
{
  "header": {
    "greeting": "Hola, {foundationName}!",
    "subtitle": "{date} - Resumen diario de actividad",
    "viewMode": "Modo Vista"
  },
  "kpi": {
    "animalsInCare": {
      "label": "Animales en Cuidado",
      "trend": "+{percent}%"
    },
    "activeSponsorships": {
      "label": "Patrocinios Activos",
      "trend": "+{percent}%"
    },
    "pendingAdoptions": {
      "label": "Adopciones Pendientes",
      "trend": "{percent}%"
    },
    "monthlyRevenue": {
      "label": "Recaudado (Mes)",
      "trend": "+{percent}%"
    }
  },
  "adoptionFunnel": {
    "title": "Estado del Embudo de Adopción",
    "viewReport": "Ver reporte",
    "applicationsReceived": "Solicitudes Recibidas",
    "interviewsScheduled": "Entrevistas Programadas",
    "homeVisits": "Visitas Domiciliarias",
    "adoptionsCompleted": "Adopciones Completadas",
    "inProcess": "En proceso",
    "totalInput": "Entrada total"
  },
  "recentActivity": {
    "title": "Actividad Reciente",
    "columns": {
      "subject": "Animal / Asunto",
      "type": "Tipo",
      "date": "Fecha",
      "status": "Estado"
    },
    "types": {
      "animal": "Animal",
      "event": "Evento",
      "product": "Producto",
      "adoptionApplication": "Solicitud Adopción",
      "newSponsor": "Nuevo Padrino",
      "onlineSale": "Venta Online"
    },
    "status": {
      "pending": "Pendiente",
      "active": "Activo",
      "sent": "Enviado"
    }
  },
  "quickActions": {
    "title": "Acciones Rápidas",
    "newAnimal": "Nuevo Animal",
    "registerExpense": "Registrar Gasto",
    "createCampaign": "Crear Campaña"
  },
  "needsAttention": {
    "title": "Requiere Atención",
    "viewAllTasks": "Ver todas las tareas",
    "alerts": {
      "veterinaryReview": {
        "title": "Revisión Veterinaria",
        "message": "{animalName} necesita su vacuna anual antes del {date}."
      },
      "lowStock": {
        "title": "Stock Bajo",
        "message": "Quedan menos de {count} bolsas de alimento cachorro."
      },
      "volunteersNeeded": {
        "title": "Voluntarios Sábado",
        "message": "Faltan {count} cupos para la jornada de limpieza."
      }
    }
  },
  "errors": {
    "loadFailed": "Error al cargar el dashboard",
    "unauthorized": "No tienes permisos para ver el dashboard"
  }
}
```

**src/messages/en/dashboard.json:** (traducciones en inglés de manera similar)

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el dashboard se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones manuales:
- [ ] El dashboard se ve igual al diseño de referencia
- [ ] Las métricas se cargan correctamente desde Supabase
- [ ] La actividad reciente muestra datos reales
- [ ] Las alertas se generan correctamente
- [ ] Los estados de loading funcionan
- [ ] Se manejan errores correctamente
- [ ] Los mensajes están traducidos
- [ ] El dashboard es responsive
- [ ] La navegación funciona correctamente

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página del dashboard creada y accesible
- [ ] Header del dashboard implementado
- [ ] 4 KPI cards implementadas (1 desde BD, 3 mock)
- [ ] Métrica "Animales en Cuidado" funciona con Supabase
- [ ] Sección "Embudo de Adopción" implementada (mock)
- [ ] Tabla "Actividad Reciente" implementada con datos reales
- [ ] Sección "Acciones Rápidas" implementada
- [ ] Sección "Requiere Atención" implementada con alertas desde BD
- [ ] `GetDashboardDataUseCase` creado y funcional
- [ ] Repositorios extendidos/creados (Animal, Event, Product)
- [ ] Dashboard conectado con UseCase
- [ ] Manejo de errores implementado y traducido
- [ ] Estados de loading implementados
- [ ] Obtener `foundation_id` del usuario funciona correctamente
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/dashboard.json`
  - [ ] Textos agregados en `src/messages/en/dashboard.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Layout responsive
- [ ] Navegación funcional desde botones
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add foundation dashboard with metrics and recent activity`

