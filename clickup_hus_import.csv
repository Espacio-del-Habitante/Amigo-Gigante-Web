Task Name,Description,Status,Priority,Tags
HU-001 — Bootstrap del proyecto con Next.js (App Router + TypeScript),"# HU-001 — Bootstrap del proyecto con Next.js (App Router + TypeScript)

**Como** desarrollador  
**Quiero** inicializar el proyecto web usando **Next.js (App Router) + TypeScript**  
**Para** tener una base moderna, soportada y alineada con las recomendaciones actuales de Next.js

---

## Contexto

Este proyecto **debe usar App Router**, que es la aproximación **oficial y recomendada**
por Next.js para proyectos nuevos.

No se utilizará `pages/`.

---

## Alcance

Esta HU **solo** crea el proyecto Next.js funcional y deja el repo listo para continuar.

Incluye:
- Next.js + TypeScript
- App Router
- Ejecución local funcional

No incluye:
- Redux
- Supabase
- Inversify
- Arquitectura por capas dentro de `src/`
- Lógica de negocio

---

## Criterios de aceptación (Given / When / Then)

### 1) Inicialización

- **Dado** un repositorio vacío o recién creado  
- **Cuando** se inicialice el proyecto con `create-next-app`  
- **Entonces** el proyecto debe usar:
  - App Router
  - TypeScript
  - ESLint

---

### 2) Estructura inicial

- **Dado** el proyecto generado  
- **Cuando** se inspeccione la estructura  
- **Entonces** debe existir:
  - `app/` (App Router)
  - `app/page.tsx`
  - `app/layout.tsx`
  - `public/`
  - `package.json`
  - `tsconfig.json`

---

### 3) Ejecución local

- **Dado** el proyecto inicializado  
- **Cuando** se ejecute `npm run dev`  
- **Entonces** la aplicación debe estar disponible en  
  `http://localhost:3000` sin errores.

---

### 4) Build

- **Dado** el proyecto inicializado  
- **Cuando** se ejecute `npm run build`  
- **Entonces** el build debe completarse sin errores.

---

### 5) Configuración mínima adicional

- **Dado** el repositorio  
- **Cuando** se revise configuración base  
- **Entonces** debe existir:
  - `.env.example` (vacío o con placeholders)
  - Scripts estándar de Next (`dev`, `build`, `start`, `lint`)

---

## Reglas técnicas

- Framework: **Next.js (última versión estable)**.
- Router: **App Router (obligatorio)**.
- Lenguaje: **TypeScript**.
- Package manager: **npm**.
- Tailwind CSS: **NO** (a menos que se indique en una HU posterior).
- Directorio `src/`: **NO** (se crea en HU-002).
- No mover carpetas ni refactorizar estructura generada por Next en esta HU.

---

## Pasos sugeridos (operativos)

Ejecutar:

```bash
npx create-next-app@latest amigo-gigante
```

Seleccionar explícitamente:

- TypeScript: **Yes**
- ESLint: **Yes**
- Tailwind CSS: **No**
- `src/` directory: **No**
- App Router: **Yes**
- Import alias: **Yes** (`@/*`)
- Turbopack: **Opcional** (Yes o No, indistinto)

---

## Archivos esperados

- `app/layout.tsx`
- `app/page.tsx`
- `next.config.*`
- `package.json`
- `tsconfig.json`
- `.env.example`

---

## Definición de Hecho

- `npm install` OK
- `npm run dev` OK
- `npm run build` OK
- App Router activo (no `pages/`)
- Commit sugerido:  
  `chore: bootstrap nextjs app router project`",Backlog,Normal,HU
HU-002 — Crear estructura por capas dentro de `src/` (Domain / Infrastructure / Presentation / Lib),"# HU-002 — Crear estructura por capas dentro de `src/` (Domain / Infrastructure / Presentation / Lib)

**Como** desarrollador  
**Quiero** crear la estructura de carpetas por capas dentro de `src/`  
**Para** garantizar separación de responsabilidades desde el inicio, conforme a la arquitectura

---

## Dependencias

- Requiere HU-001 completada.

---

## Criterios de aceptación (Given / When / Then)

1) **Estructura**
- **Dado** el proyecto Next.js funcionando
- **Cuando** se cree el directorio `src/`
- **Entonces** deben existir como mínimo:
  - `src/domain`
  - `src/infrastructure`
  - `src/presentation`
  - `src/lib`

2) **Estructura interna mínima**
- **Dado** `src/`
- **Cuando** se creen subcarpetas base
- **Entonces** deben existir:
  - `src/domain/models`
  - `src/domain/repositories`
  - `src/domain/usecases`
  - `src/infrastructure/config`
  - `src/infrastructure/ioc`
  - `src/presentation/pages` *(si se usa pages propias; con Next App Router se puede mapear a `src/app`, ver nota)*
  - `src/presentation/components`
  - `src/presentation/hooks`
  - `src/presentation/store`
  - `src/lib/errors`

3) **Compatibilidad con Next**
- **Dado** Next.js (App Router)
- **Cuando** se mueva el punto de entrada
- **Entonces** el proyecto debe seguir levantando en `npm run dev`.

4) **Documentación**
- **Dado** el repo
- **Cuando** se termine esta HU
- **Entonces** se debe actualizar el README (o `docs/`) indicando:
  - que la arquitectura vive en `docs/01_arquitectura.md`
  - y que el código se organiza bajo `src/` por capas.

---

## Reglas técnicas

- Respetar `docs/01_arquitectura.md`.
- No introducir lógica de negocio aún.
- No agregar Supabase aún.
- No agregar Redux aún.
- No agregar Inversify aún (eso va en HU-003).
- Crear `index.ts` vacíos en carpetas clave solo si ayuda a exports (opcional).

---
## Nota sobre conectividad

Si tienes algun error 403 o de conectividad por que no alcanzas el dominio solicitar el listado de dominios que requieres habilitar y el por que es necesario habilitarlo

---
## Nota sobre Next.js (App Router)

Si el scaffold actual trae `app/` en la raíz, se debe:
- mover `app/` a `src/app/` (recomendado),
- y mantener `src/presentation` para UI reutilizable (components/hooks/store).

El routing de Next seguirá viviendo en `src/app`, pero los componentes/hook/store deben vivir en `src/presentation`.

---

## Archivos esperados (ejemplo mínimo)

- `src/domain/models/.gitkeep` (o archivo placeholder)
- `src/domain/repositories/.gitkeep`
- `src/domain/usecases/.gitkeep`
- `src/infrastructure/config/.gitkeep`
- `src/infrastructure/ioc/.gitkeep`
- `src/presentation/components/.gitkeep`
- `src/presentation/hooks/.gitkeep`
- `src/presentation/store/.gitkeep`
- `src/lib/errors/.gitkeep`

*(Puedes usar `.gitkeep` o un `README.md` mínimo por carpeta.)*

---

## Definición de Hecho

- `npm run dev` OK
- No se rompe el enrutamiento
- Estructura creada y commiteada
- Commit sugerido: `chore: add layered src structure`",Backlog,Normal,HU
HU-003 — Configurar IoC con Inversify (container + types + módulos),"# HU-003 — Configurar IoC con Inversify (container + types + módulos)

**Como** desarrollador  
**Quiero** configurar **InversifyJS** en la capa Infrastructure  
**Para** inyectar dependencias sin acoplar Presentation a implementaciones concretas

---

## Dependencias

- Requiere HU-001 y HU-002 completadas.

---

## Criterios de aceptación (Given / When / Then)

1) **Dependencias**
- **Dado** el proyecto base
- **Cuando** se instale Inversify
- **Entonces** deben existir las dependencias:
  - `inversify`
  - `reflect-metadata`

2) **Container base**
- **Dado** `src/infrastructure/ioc`
- **Cuando** se cree el contenedor
- **Entonces** debe existir:
  - `src/infrastructure/ioc/container.ts`

3) **Estructura IoC (types + módulos)**
- **Dado** el contenedor
- **Cuando** se prepare la estructura
- **Entonces** deben existir carpetas y archivos base:
  - `src/infrastructure/ioc/services/services.types.ts`
  - `src/infrastructure/ioc/repositories/repositories.types.ts`
  - `src/infrastructure/ioc/usecases/usecases.types.ts`
  - `src/infrastructure/ioc/services/services.container.ts`
  - `src/infrastructure/ioc/repositories/repositories.container.ts`
  - `src/infrastructure/ioc/usecases/usecases.container.ts`

4) **Smoke test de IoC**
- **Dado** el contenedor configurado
- **Cuando** se registre una dependencia de ejemplo (dummy)
- **Entonces** se debe poder resolver desde el container sin error.

---

## Reglas técnicas

- Todo IoC vive en `src/infrastructure/ioc`.
- Presentation **no** instancia dependencias con `new`.
- Se permite un “dummy service” solo para validar el wiring.
- No agregar Supabase aún (eso va en HU-010).
- No agregar Redux aún (eso va en HU-004).

---

## Implementación sugerida (mínima)

1) En `src/infrastructure/ioc/container.ts`:
- Crear `Container`
- Cargar módulos en orden:
  1. services
  2. repositories
  3. usecases

2) Crear un `ExampleService` (dummy) en:
- `src/infrastructure/services/ExampleService.ts`

3) Registrar `ExampleService` en `services.container.ts` y exponer su símbolo en `services.types.ts`.

4) Crear un pequeño script/test (puede ser unit test o un archivo node ejecutable) para resolverlo.

---

## Definición de Hecho

- `npm run dev` OK
- Al resolver el servicio dummy desde el container no hay errores
- No hay imports de `inversify` dentro de Domain
- Commit sugerido: `chore: setup inversify container`",Backlog,Normal,HU
HU-004 — Flujo Debug End-to-End (Presentation → UseCase → Repository → Infrastructure),"# HU-004 — Flujo Debug End-to-End (Presentation → UseCase → Repository → Infrastructure)

**Como** desarrollador  
**Quiero** un flujo mínimo “Debug” que conecte todas las capas (Presentation → Domain → Infrastructure)  
**Para** validar que la arquitectura, el enrutamiento (Next App Router) y el IoC (Inversify) funcionan de punta a punta

---

## Dependencias

- Requiere HU-001 (Next.js App Router funcionando)
- Requiere HU-002 (estructura por capas en `src/`)
- Requiere HU-003 (Inversify configurado con container + types + módulos)

---

## Alcance

Incluye:
- Un caso de uso `DebugUseCase`
- Un repositorio de dominio `IDebugRepository`
- Una implementación `DebugRepository`
- Un servicio de infraestructura opcional `DebugService` (o `ExampleService`) para demostrar wiring
- Una página UI `/debug` con un botón que ejecute el UseCase y muestre el resultado
- Manejo básico de `loading` y `error` en UI

No incluye:
- Redux
- Supabase
- Estilos avanzados
- Tests exhaustivos (solo smoke test mínimo requerido abajo)

---

## Criterios de aceptación (Given / When / Then)

### 1) Contratos en Domain

- **Dado** el directorio `src/domain`
- **Cuando** se implemente Debug
- **Entonces** debe existir:
  - `src/domain/repositories/IDebugRepository.ts`
  - `src/domain/usecases/debug/DebugUseCase.ts`
  - exports en `src/domain/repositories/index.ts` y `src/domain/usecases/index.ts` (si existen)

Y la interfaz `IDebugRepository` debe declarar al menos:

- `run(): Promise<string>`

---

### 2) Implementación en Infrastructure

- **Dado** el directorio `src/infrastructure`
- **Cuando** se implemente Debug
- **Entonces** debe existir:
  - `src/infrastructure/repositories/DebugRepository.ts`
  - (Opcional) `src/infrastructure/services/DebugService.ts`

`DebugRepository` debe:
- Implementar `IDebugRepository`
- Retornar un string generado en Infrastructure (ej: timestamp ISO o UUID simple)
- No usar APIs externas ni red

---

### 3) Registro en IoC (Inversify)

- **Dado** el contenedor IoC existente
- **Cuando** se registre Debug
- **Entonces** debe ser posible resolver:
  - `DebugUseCase` desde el container
  - `IDebugRepository` (binding a `DebugRepository`)

Debe existir un símbolo en:
- `src/infrastructure/ioc/repositories/repositories.types.ts`
- `src/infrastructure/ioc/usecases/usecases.types.ts`

Y sus bindings en:
- `repositories.container.ts`
- `usecases.container.ts`

---

### 4) Página /debug funcional

- **Dado** el proyecto Next.js con App Router
- **Cuando** el usuario visite `/debug`
- **Entonces** debe ver:
  - Título “Debug”
  - Botón “Run debug”
  - Área para mostrar resultado o error

- **Dado** el usuario en `/debug`
- **Cuando** haga clic en “Run debug”
- **Entonces** se debe ejecutar el flujo:

```
Presentation → UseCase → Repository → (Service opcional)
```

y se debe mostrar un string resultado en pantalla.

---

### 5) Smoke test manual + build

- **Dado** el repo actualizado
- **Cuando** se ejecute:
  - `npm run dev`
  - `npm run build`
- **Entonces** no debe haber errores.

---

## Reglas técnicas

- ❌ No agregar dependencias nuevas
- ❌ No Redux
- ❌ No Supabase
- `Domain` no importa nada de `inversify`, `next`, `react`
- `Presentation` no importa `DebugRepository` directamente (solo `DebugUseCase` vía container)
- `Infrastructure` es el único lugar donde vive el wiring IoC

---

## Implementación sugerida (estructura)

### Domain
- `src/domain/repositories/IDebugRepository.ts`
- `src/domain/usecases/debug/DebugUseCase.ts`

### Infrastructure
- `src/infrastructure/repositories/DebugRepository.ts`
- `src/infrastructure/services/DebugService.ts` (opcional)
- `src/infrastructure/ioc/repositories/repositories.types.ts` (agregar símbolo)
- `src/infrastructure/ioc/repositories/repositories.container.ts` (agregar binding)
- `src/infrastructure/ioc/usecases/usecases.types.ts` (agregar símbolo)
- `src/infrastructure/ioc/usecases/usecases.container.ts` (agregar binding)

### Presentation (Next App Router)
- `src/app/debug/page.tsx`
- (Opcional) `src/presentation/hooks/useDebug.ts`

---

## Definición de Hecho

- `/debug` existe y funciona en `npm run dev`
- Click en “Run debug” muestra un resultado
- `npm run build` OK
- Sin violaciones de capas
- Commit sugerido:
  `feat: add debug end-to-end flow`",Backlog,Normal,HU
HU-005 — Configurar Material UI (MUI) en Next.js (App Router),"# HU-005 — Configurar Material UI (MUI) en Next.js (App Router)

**Como** desarrollador  
**Quiero** configurar **Material UI (MUI)** en el proyecto Next.js  
**Para** comenzar a construir UI con estilos consistentes y componentes listos para producción

---

## Dependencias

- Requiere HU-001 (Next.js App Router funcionando)
- Requiere HU-002 (estructura por capas en `src/`)
- (Recomendado) HU-004 para tener una página `/debug` donde validar visualmente

---

## Alcance

Incluye:
- Instalación de MUI (Material UI) y sus dependencias
- Configuración para Next.js App Router
- Setup de `ThemeProvider` global
- Configuración de caché/SSR para App Router usando el enfoque recomendado por MUI
- Uso mínimo de MUI en `/debug` (ej: `Button`, `Container`, `Typography`)

No incluye:
- Diseño final del producto
- Componentes complejos
- Redux / Supabase

---

## Criterios de aceptación (Given / When / Then)

### 1) Dependencias instaladas

- **Dado** el proyecto Next.js
- **Cuando** se instalen dependencias
- **Entonces** deben existir en `package.json`:
  - `@mui/material`
  - `@emotion/react`
  - `@emotion/styled`

Y opcionalmente (recomendado):
  - `@mui/icons-material`

---

### 2) Provider global

- **Dado** App Router
- **Cuando** se configure MUI globalmente
- **Entonces** debe existir un `ThemeProvider` aplicado a toda la app desde `src/app/layout.tsx`
  (o el layout principal donde viva el árbol del App Router).

---

### 3) Configuración App Router (cache / SSR)

- **Dado** Next.js App Router
- **Cuando** se configure MUI
- **Entonces** debe existir un provider de caché para MUI/Emotion compatible con App Router
  (por ejemplo, un componente `MuiProvider` en `src/presentation/providers/` o similar)
  siguiendo el patrón recomendado por MUI para App Router.

> Nota: No se busca “inventar” SSR. Solo aplicar el wrapper recomendado para evitar problemas de estilos/hidratación.

---

### 4) Tema básico

- **Dado** MUI instalado
- **Cuando** se cree el tema
- **Entonces** debe existir un archivo de tema base, por ejemplo:
  - `src/presentation/theme/theme.ts`

Y debe incluir al menos:
- `palette.mode = ""light""` (default)
- `typography` básico (puede ser default)

---

### 5) Validación visual en /debug

- **Dado** la página `/debug`
- **Cuando** se actualice la UI
- **Entonces** el botón “Run debug” debe ser un `Button` de MUI y debe verse con estilo MUI.

Mínimo requerido:
- `Container`
- `Typography`
- `Button`

---

## Reglas técnicas

- No cambiar la arquitectura por capas.
- No agregar librerías de estilos adicionales (Tailwind, styled-components, etc.).
- No crear diseño avanzado; solo wiring + tema básico.
- El código de providers y tema debe vivir en Presentation (`src/presentation/...`).
- `Domain` e `Infrastructure` no deben conocer MUI.

---

## Implementación sugerida (estructura)

- `src/presentation/theme/theme.ts`
- `src/presentation/providers/MuiProvider.tsx` (o nombre equivalente)
- `src/app/layout.tsx` (usar el provider global)
- `src/app/debug/page.tsx` (reemplazar HTML por MUI)

---

## Validación

Ejecutar:

- `npm run dev`
- Abrir `http://localhost:3000/debug`
- Verificar que el botón y textos sean de MUI
- `npm run build` sin errores

---

## Definición de Hecho

- MUI instalado y configurado con App Router sin warnings críticos de estilos/hidratación
- Tema base creado
- `/debug` usando componentes MUI
- `npm run dev` OK
- `npm run build` OK
- Commit sugerido:
  `chore: setup mui`",Backlog,Normal,HU
HU-006 — Home MVP (UI only) basado en diseño Stitch,"# HU-006 — Home MVP (UI only) basado en diseño Stitch

**Como** visitante  
**Quiero** ver una página Home clara, divertida y coherente con el diseño  
**Para** entender rápidamente el propósito de Amigo Gigante y explorar animales

---

## Dependencias

- Requiere HU-001 (Next.js App Router)
- Requiere HU-002 (estructura por capas)
- Requiere HU-005 (MUI configurado)

---

## Alcance

Incluye **únicamente la Home** (`/`) con UI funcional basada en el diseño entregado por Stitch.

Incluye:
- Implementación visual de la Home usando **MUI**
- Estructura de layout y secciones según diseño
- Componentes reutilizables mínimos (ej: cards)
- Data **mock** (hardcodeada) solo para renderizar UI

No incluye:
- Navegación completa
- Catálogo de animales
- Supabase
- Redux
- Lógica de negocio real
- SEO avanzado

---

## Diseño (OBLIGATORIO)

Antes de implementar, **leer y respetar fielmente** el diseño ubicado en:

```
docs/design/home_screen.png
docs/design/code_home_screen.png
```

Notas importantes:
- No inventar secciones que no estén en el diseño
- No cambiar jerarquía visual
- Colores, spacing y tono deben aproximarse al diseño
- Si algo no es claro en la imagen, preguntar antes de asumir

---

## Criterios de aceptación (Given / When / Then)

### 1) Ruta Home

- **Dado** el proyecto Next.js
- **Cuando** el usuario navega a `/`
- **Entonces** se renderiza la Home basada en el diseño Stitch.

---

### 2) Estructura visual

- **Dado** la Home
- **Cuando** se renderiza
- **Entonces** deben existir las secciones visibles del diseño, por ejemplo:
  - Header / Hero principal
  - Sección introductoria (mensaje principal)
  - Sección de animales destacados (cards)
  - CTA principal

*(Los nombres exactos dependen del diseño, no inventarlos)*

---

### 3) Componentes MUI

- **Dado** la implementación UI
- **Cuando** se revisa el código
- **Entonces**:
  - Se usan componentes MUI (`Container`, `Box`, `Typography`, `Button`, `Card`, etc.)
  - No se usa HTML plano salvo wrappers mínimos
  - El layout es responsive básico (desktop primero)

---

### 4) Data mock

- **Dado** la sección que lista animales (si existe en el diseño)
- **Cuando** se renderiza
- **Entonces** se usa data mock local (array hardcodeado) con:
  - nombre
  - imagen placeholder
  - fundación (texto)

La data mock **no** vive en Presentation directamente:
- Debe exponerse vía un UseCase simple o helper mock en Infrastructure.

---

### 5) Calidad

- **Dado** el proyecto
- **Cuando** se ejecute:
  - `npm run dev`
  - `npm run build`
- **Entonces** no deben existir errores.

---

## Reglas técnicas

- UI hecha con **MUI**.
- No agregar nuevas dependencias.
- No implementar navegación real aún.
- No conectar a Supabase.
- No usar Redux.
- Mantener el código simple y legible.
- Respetar separación de capas incluso para mocks.

---

## Implementación sugerida

- `src/app/page.tsx` → Home
- `src/presentation/components/Home/*`
- (Opcional) `src/presentation/components/AnimalCard.tsx`
- Mock data en:
  - `src/infrastructure/mocks/animals.mock.ts`

---

## Definición de Hecho

- Home renderiza correctamente y se parece claramente al diseño `home_screen.png`
- Uso consistente de MUI
- `npm run dev` OK
- `npm run build` OK
- Sin violaciones de capas
- Commit sugerido:
  `feat: add home mvp based on stitch design`",Backlog,Normal,HU
HU-007 — Integrar Tailwind CSS y refactorizar Home para usar MUI + Tailwind,"# HU-007 — Integrar Tailwind CSS y refactorizar Home para usar MUI + Tailwind

**Como** desarrollador  
**Quiero** integrar **Tailwind CSS** en el proyecto Next.js y actualizar el Home existente  
**Para** acelerar el layout/spacing con utilidades sin abandonar componentes MUI

---

## Contexto / Decisión

En este proyecto se permitirá **MUI + Tailwind** en conjunto:

- **MUI**: componentes (Button, Card, Typography, etc.) y ThemeProvider.
- **Tailwind**: layout, spacing, grid, responsive utilities y ajustes rápidos de estilos.

> Regla: No duplicar responsabilidades. No reemplazar MUI por Tailwind; se complementan.

---

## Dependencias

- Requiere HU-001 (Next.js App Router)
- Requiere HU-005 (MUI configurado)
- Requiere HU-006 (Home MVP basado en diseño)

---

## Alcance

Incluye:
- Instalación y configuración de Tailwind CSS para Next.js (App Router)
- Configuración de `tailwind.config.ts` con paths correctos para `src/app` y `src/presentation`
- Actualizar la Home (`/`) para usar clases Tailwind en:
  - layout (grid/flex)
  - spacing (padding/margin/gap)
  - responsividad (breakpoints)
- Mantener componentes MUI donde ya existan (no reescribir todo a HTML)

No incluye:
- Rediseño del Home
- Migración de todo el proyecto a Tailwind
- Cambios en Domain/Infrastructure

---

## Criterios de aceptación (Given / When / Then)

### 1) Dependencias instaladas

- **Dado** el proyecto Next.js
- **Cuando** se instale Tailwind
- **Entonces** deben existir en `package.json`:
  - `tailwindcss`
  - `postcss`
  - `autoprefixer`

---

### 2) Configuración Tailwind

- **Dado** Tailwind instalado
- **Cuando** se configure
- **Entonces** deben existir:
  - `tailwind.config.ts`
  - `postcss.config.js`

Y `tailwind.config.ts` debe incluir `content` con paths al menos:

- `./src/app/**/*.{js,ts,jsx,tsx,mdx}`
- `./src/presentation/**/*.{js,ts,jsx,tsx,mdx}`
- (Si existen otros paths reales en el repo, incluirlos sin inventar)

---

### 3) Estilos globales

- **Dado** App Router
- **Cuando** se habiliten estilos globales
- **Entonces** `src/app/globals.css` debe incluir:

- `@tailwind base;`
- `@tailwind components;`
- `@tailwind utilities;`

Y `globals.css` debe seguir importándose desde `src/app/layout.tsx`.

---

### 4) Home actualizado a MUI + Tailwind

- **Dado** el Home ya implementado (HU-006)
- **Cuando** se refactorice
- **Entonces**:
  - Se conserva el diseño base definido en `docs/design/home_screen.png`
  - Se usa Tailwind para layout/spacing (ej: `flex`, `grid`, `gap-*`, `p-*`, `mx-auto`, `max-w-*`)
  - Se mantienen componentes MUI para UI (ej: `Button`, `Card`, `Typography`)

Ejemplo permitido:

```tsx
<div className=""mx-auto max-w-6xl px-4 py-10"">
  <Typography variant=""h3"" className=""mb-4 font-bold"">
    Amigo Gigante
  </Typography>
  <Button variant=""contained"" className=""mt-6"">
    Explorar
  </Button>
</div>
```

---

### 5) No conflictos críticos

- **Dado** la mezcla MUI + Tailwind
- **Cuando** se ejecute el proyecto
- **Entonces**:
  - No hay errores de build
  - No hay warnings críticos de hidratación relacionados con estilos
  - El UI se ve consistente (sin “flash” notable por estilos)

---

### 6) Validación

- **Dado** el repo actualizado
- **Cuando** se ejecute:
  - `npm run dev`
  - `npm run build`
- **Entonces** ambos comandos finalizan sin errores.

---

## Reglas técnicas

- No agregar librerías de estilos adicionales (styled-components, etc.).
- Tailwind se usa solo en Presentation (UI).
- No tocar Domain/Infrastructure.
- No modificar la paleta/tema MUI existente salvo que sea estrictamente necesario para compatibilidad.

---

## Implementación sugerida

- Config:
  - `tailwind.config.ts`
  - `postcss.config.js`
  - `src/app/globals.css`
- Home:
  - `src/app/page.tsx`
  - `src/presentation/components/Home/*` (si aplica)

---

## Definición de Hecho

- Tailwind instalado y funcionando
- Home refactorizado a MUI + Tailwind manteniendo el diseño de `docs/design/home_screen.png`
- `npm run dev` OK
- `npm run build` OK
- Commit sugerido:
  `chore: add tailwind and refactor home`",Backlog,Normal,HU
HU-008 — Design System centralizado (Tailwind tokens + MUI Theme sincronizado),"# HU-008 — Design System centralizado (Tailwind tokens + MUI Theme sincronizado)

**Como** equipo de desarrollo  
**Quiero** un Design System centralizado  
**Para** mantener consistencia visual y evitar decisiones ad-hoc de estilos

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)

---

## Alcance

Incluye:
- Definición de tokens oficiales en Tailwind (`tailwind.config.ts`)
- Sincronización del theme de MUI con esos tokens
- Documentación del Design System
- Refactor mínimo si hay inconsistencias evidentes

No incluye:
- Rediseño de pantallas
- Nuevos componentes visuales
- Cambios de UX

---

## Criterios de aceptación

### 1) Tailwind como fuente de verdad

- `tailwind.config.ts` define explícitamente:
  - colores (`brand`, `accent`, `neutral`)
  - `fontFamily`
  - `borderRadius`
  - `boxShadow`
- No se permiten colores/tamaños inline fuera de estos tokens.

---

### 2) Theme MUI sincronizado

- Existe:
  ```
  src/presentation/theme/theme.ts
  ```
- El theme:
  - Usa los mismos valores definidos en Tailwind
  - No redefine colores arbitrarios
  - Alinea `palette.primary` con `brand`
  - Alinea `palette.secondary` con `accent`

---

### 3) Documentación del Design System

- Existe el archivo:
  ```
  docs/design/system.md
  ```
- Describe:
  - Paleta de colores
  - Tipografía
  - Espaciado
  - Botones y reglas de uso
  - Convenciones obligatorias

---

## Reglas técnicas

- Tailwind es la **fuente de verdad**
- MUI solo refleja los tokens
- No se agregan nuevas librerías de estilos
- No tocar Domain / Infrastructure

---

## Definición de Hecho

- Tokens centralizados y documentados
- MUI y Tailwind alineados visualmente
- Documentación clara y versionable
- Commit sugerido:
  `chore: add design system tokens and sync mui theme`",Backlog,Normal,HU
HU-009 — Logo centrado en círculo azul del navbar,"# HU-009 — Logo centrado en círculo azul del navbar

**Como** usuario de la aplicación  
**Quiero** ver el logo de Amigo Gigante centrado dentro del círculo azul del navbar  
**Para** tener una identidad visual clara y profesional

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)

---

## Contexto / Notas

- El logo actual (`LOGO2.png`) muestra ""Amigo Gigante"" con un círculo azul a la izquierda.
- Actualmente en `HomeNavBar.tsx` hay un círculo azul simple sin contenido.
- El logo debe centrarse estéticamente dentro del círculo azul del navbar.
- El círculo azul debe usar el color `brand` del Design System.
- El logo debe mantener sus proporciones y verse nítido.

---

## Diseño

Referencias:
- Logo: `src/presentation/assets/images/LOGO2.png`
- Design System: `docs/design/system.md`

Reglas:
- El círculo azul debe usar `bg-brand-500` (o `primary.main` en MUI).
- El logo debe estar centrado vertical y horizontalmente dentro del círculo.
- El tamaño del círculo debe ser proporcional al texto ""Amigo Gigante"" adyacente.
- El logo debe mantener su relación de aspecto original.
- Si el logo es demasiado grande para el círculo, se debe escalar manteniendo proporciones.

---

## Alcance

Incluye:
- Reemplazar el círculo azul vacío en `HomeNavBar.tsx` con el logo centrado
- Asegurar que el logo se vea estéticamente bien dentro del círculo
- Usar tokens del Design System para el color del círculo
- Mantener responsividad del navbar

No incluye:
- Cambios en otros componentes que usen el logo
- Modificaciones al diseño del logo original
- Cambios en la funcionalidad del navbar

---

## Criterios de aceptación (Given / When / Then)

### 1) Logo visible en el navbar

- **Dado** que estoy en la página principal
- **Cuando** visualizo el navbar
- **Entonces** veo el logo de Amigo Gigante centrado dentro de un círculo azul

---

### 2) Logo centrado estéticamente

- **Dado** que el logo está en el navbar
- **Cuando** observo su posición
- **Entonces** el logo está centrado vertical y horizontalmente dentro del círculo azul
- **Y** el logo mantiene sus proporciones originales
- **Y** hay un espaciado adecuado entre el logo y el borde del círculo

---

### 3) Uso de tokens del Design System

- **Dado** que el círculo azul está implementado
- **Cuando** reviso el código
- **Entonces** el color del círculo usa `bg-brand-500` (Tailwind) o `primary.main` (MUI)
- **Y** no hay colores hardcodeados fuera de los tokens definidos

---

### 4) Responsividad mantenida

- **Dado** que el navbar tiene el logo implementado
- **Cuando** cambio el tamaño de la pantalla (móvil, tablet, desktop)
- **Entonces** el logo se mantiene visible y bien posicionado
- **Y** el navbar sigue siendo funcional en todos los tamaños

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.

### UI
- UI con MUI.
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500` para el círculo azul).
- El logo debe cargarse desde `src/presentation/assets/images/LOGO2.png`.
- Usar `next/image` para optimización de imágenes si es posible.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

Archivos/carpetas sugeridas:
- `src/presentation/components/home/HomeNavBar.tsx` (modificar)
- `src/presentation/assets/images/LOGO2.png` (usar)

Estructura sugerida:
```tsx
<Box
  component=""span""
  sx={{
    width: 36,
    height: 36,
    borderRadius: ""50%"",
    backgroundColor: ""primary.main"",
    display: ""flex"",
    alignItems: ""center"",
    justifyContent: ""center"",
    overflow: ""hidden"",
  }}
>
  <Image
    src=""/assets/images/LOGO2.png""
    alt=""Amigo Gigante Logo""
    width={28}
    height={28}
    style={{ objectFit: ""contain"" }}
  />
</Box>
```

Notas:
- Ajustar el tamaño del logo (`width` y `height` del Image) según se vea mejor estéticamente.
- El `overflow: ""hidden""` asegura que el logo no se salga del círculo.
- `objectFit: ""contain""` mantiene las proporciones del logo.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el logo se muestra correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- El logo está centrado dentro del círculo azul
- El logo se ve nítido y con buen contraste
- El navbar mantiene su funcionalidad
- El diseño es responsive en diferentes tamaños de pantalla

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Logo visible y centrado en el círculo azul
- [ ] Uso correcto de tokens del Design System
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add logo centered in navbar blue circle`",Backlog,Normal,HU
HU-010 — Refactorización a Atomic Design y componentes reutilizables,"# HU-010 — Refactorización a Atomic Design y componentes reutilizables

**Como** equipo de desarrollo  
**Quiero** analizar y refactorizar los componentes existentes siguiendo Atomic Design  
**Para** evitar duplicación de código, mejorar reutilización y mantener consistencia en la UI

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-009 (Logo en navbar - si aplica)

---

## Contexto / Notas

- Actualmente los componentes están en `src/presentation/components/home/` sin estructura de Atomic Design.
- La arquitectura (`docs/01_arquitectura.md`) define que deberían existir `atoms/`, `molecules/`, `organisms/`, `layouts/` pero no están implementados.
- Se observa código duplicado en estilos (botones, cards, chips, etc.).
- Componentes como `AnimalCard`, `HomeNavBar` tienen estilos inline que podrían extraerse a componentes más pequeños y reutilizables.
- Es necesario analizar el código existente para identificar patrones comunes y oportunidades de reutilización.

---

## Diseño

Referencias:
- Arquitectura: `docs/01_arquitectura.md` (estructura de componentes)
- Design System: `docs/design/system.md`
- Atomic Design: https://atomicdesign.bradfrost.com/

Estructura esperada:
```
src/presentation/components/
├── atoms/              # Componentes básicos (Button, Chip, Icon, etc.)
├── molecules/          # Combinaciones simples (SearchBar, NavLink, etc.)
├── organisms/          # Componentes complejos (NavBar, AnimalCard, etc.)
├── layouts/           # Layouts reutilizables (PageLayout, Section, etc.)
└── home/              # Componentes específicos de home (temporal, migrar a organisms)
```

---

## Alcance

Incluye:
- Análisis del código existente para identificar componentes reutilizables
- Creación de estructura de carpetas según Atomic Design (`atoms/`, `molecules/`, `organisms/`, `layouts/`)
- Extracción de componentes atómicos (botones, chips, iconos, etc.)
- Refactorización de componentes existentes para usar los nuevos componentes atómicos
- Documentación de la estructura y convenciones de Atomic Design
- Migración gradual de componentes de `home/` a la nueva estructura

No incluye:
- Rediseño visual de componentes
- Cambios en la funcionalidad existente
- Creación de nuevos features
- Cambios en Domain o Infrastructure

---

## Criterios de aceptación (Given / When / Then)

### 1) Estructura de Atomic Design creada

- **Dado** que se analiza el código existente
- **Cuando** se crea la estructura de carpetas
- **Entonces** existen las carpetas:
  - `src/presentation/components/atoms/`
  - `src/presentation/components/molecules/`
  - `src/presentation/components/organisms/`
  - `src/presentation/components/layouts/`
- **Y** cada carpeta tiene un `README.md` explicando su propósito

---

### 2) Componentes atómicos extraídos

- **Dado** que se analizan los componentes existentes
- **Cuando** se identifican elementos reutilizables
- **Entonces** se crean componentes atómicos como:
  - `Button` (variantes: primary, secondary, etc.)
  - `Chip` (con variantes de color según status)
  - `IconButton` (reutilizable)
  - `Logo` (componente del logo)
  - Otros elementos básicos identificados
- **Y** estos componentes usan tokens del Design System
- **Y** están documentados con ejemplos de uso

---

### 3) Componentes moleculares creados

- **Dado** que existen componentes atómicos
- **Cuando** se combinan para crear elementos más complejos
- **Entonces** se crean componentes moleculares como:
  - `NavLink` (link de navegación con hover)
  - `SearchButton` (IconButton con icono de búsqueda)
  - `StatusChip` (Chip con lógica de colores según status)
  - Otros identificados en el análisis
- **Y** estos componentes están compuestos por atoms

---

### 4) Organismos refactorizados

- **Dado** que existen atoms y molecules
- **Cuando** se refactorizan los componentes existentes
- **Entonces** componentes como `HomeNavBar`, `AnimalCard` usan los nuevos atoms y molecules
- **Y** se elimina código duplicado
- **Y** los componentes mantienen su funcionalidad original
- **Y** se migran a `organisms/` cuando corresponda

---

### 5) Layouts reutilizables

- **Dado** que existen patrones de layout comunes
- **Cuando** se analiza el código
- **Entonces** se crean layouts reutilizables como:
  - `Section` (contenedor de sección con Container y spacing)
  - `PageLayout` (si aplica)
  - Otros identificados
- **Y** estos layouts usan tokens del Design System para spacing

---

### 6) Documentación creada

- **Dado** que se implementa Atomic Design
- **Cuando** se completa la refactorización
- **Entonces** existe documentación en:
  - `src/presentation/components/README.md` (guía de Atomic Design)
  - READMEs en cada carpeta (atoms, molecules, organisms, layouts)
- **Y** se documentan las convenciones:
  - Cuándo crear un atom vs molecule vs organism
  - Cómo nombrar componentes
  - Cómo usar los componentes existentes

---

### 7) Código sin duplicación

- **Dado** que se completa la refactorización
- **Cuando** se revisa el código
- **Entonces** no hay estilos duplicados (botones, chips, etc.)
- **Y** los componentes reutilizables están en su lugar correcto según Atomic Design
- **Y** los componentes específicos de home están claramente identificados

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.

### Atomic Design
- **Atoms**: Componentes básicos que no pueden dividirse más (Button, Chip, Icon, etc.).
- **Molecules**: Combinaciones simples de atoms (SearchBar, NavLink, etc.).
- **Organisms**: Componentes complejos que combinan molecules y atoms (NavBar, AnimalCard, etc.).
- **Layouts**: Estructuras de página/sección reutilizables.

### UI
- Usar tokens del Design System (`brand-500`, `accent-500`, etc.).
- MUI se usa para componentes base, pero se envuelven en atoms propios cuando se necesita reutilización.
- Tailwind se usa para layout/spacing/responsive utilities.
- No crear componentes que solo envuelvan MUI sin agregar valor.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Fase 1: Análisis
1. Revisar todos los componentes en `src/presentation/components/home/`
2. Identificar:
   - Estilos duplicados
   - Componentes que se repiten
   - Patrones comunes
3. Crear un documento de análisis (opcional, puede ser en comentarios)

### Fase 2: Crear estructura
1. Crear carpetas: `atoms/`, `molecules/`, `organisms/`, `layouts/`
2. Crear READMEs explicativos en cada carpeta

### Fase 3: Extraer atoms
1. Crear `atoms/Button/Button.tsx` (con variantes)
2. Crear `atoms/Chip/Chip.tsx` (con variantes)
3. Crear `atoms/IconButton/IconButton.tsx`
4. Crear `atoms/Logo/Logo.tsx`
5. Otros identificados en el análisis

### Fase 4: Crear molecules
1. Crear `molecules/NavLink/NavLink.tsx`
2. Crear `molecules/SearchButton/SearchButton.tsx`
3. Crear `molecules/StatusChip/StatusChip.tsx`
4. Otros identificados

### Fase 5: Refactorizar organisms
1. Refactorizar `HomeNavBar` para usar atoms y molecules
2. Refactorizar `AnimalCard` para usar atoms y molecules
3. Migrar a `organisms/` cuando corresponda
4. Mantener compatibilidad con código existente

### Fase 6: Crear layouts
1. Crear `layouts/Section/Section.tsx`
2. Otros identificados

### Fase 7: Documentación
1. Actualizar `src/presentation/components/README.md`
2. Documentar convenciones y ejemplos

Archivos/carpetas sugeridas:
```
src/presentation/components/
├── atoms/
│   ├── Button/
│   │   ├── Button.tsx
│   │   └── index.ts
│   ├── Chip/
│   ├── IconButton/
│   ├── Logo/
│   └── README.md
├── molecules/
│   ├── NavLink/
│   ├── SearchButton/
│   ├── StatusChip/
│   └── README.md
├── organisms/
│   ├── NavBar/
│   ├── AnimalCard/
│   └── README.md
├── layouts/
│   ├── Section/
│   └── README.md
├── home/ (temporal, migrar gradualmente)
└── README.md
```

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que todo funciona igual)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- Los componentes mantienen su funcionalidad original
- No hay regresiones visuales
- El código está mejor organizado
- Se eliminó duplicación de código
- Los componentes son reutilizables

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Estructura de Atomic Design creada
- [ ] Componentes atómicos extraídos y documentados
- [ ] Componentes existentes refactorizados
- [ ] Código sin duplicación
- [ ] Documentación completa
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `refactor: implement atomic design and reusable components`",Backlog,Normal,HU
HU-011 — Configuración de conexión a Supabase,"# HU-011 — Configuración de conexión a Supabase

**Como** desarrollador  
**Quiero** configurar la conexión a Supabase en el proyecto  
**Para** tener acceso a autenticación, base de datos y storage desde la aplicación

---

## Dependencias

- HU-002 (Estructura de carpetas por capas)
- HU-003 (IoC configurado con Inversify)

---

## Contexto / Notas

- Supabase debe estar encapsulado **solo en Infrastructure** según la arquitectura.
- Presentation y Domain **nunca** deben importar `@supabase/supabase-js`.
- Las credenciales de Supabase deben manejarse mediante variables de entorno.
- El cliente de Supabase debe inicializarse una sola vez y reutilizarse.
- Se debe crear un archivo `.env.example` para documentar las variables requeridas.

---

## Alcance

Incluye:
- Instalación del paquete `@supabase/supabase-js`
- Creación de archivo de configuración de Supabase en `infrastructure/config/supabase.ts`
- Creación de archivo de manejo de variables de entorno
- Configuración de variables de entorno (`NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`)
- Creación de archivo `.env.example` con las variables requeridas
- Documentación de cómo obtener las credenciales de Supabase

No incluye:
- Implementación de repositorios o servicios que usen Supabase
- Configuración de autenticación (solo la conexión base)
- Configuración de políticas RLS o seguridad
- Migraciones de base de datos

---

## Criterios de aceptación (Given / When / Then)

### 1) Paquete de Supabase instalado

- **Dado** que se necesita conectar a Supabase
- **Cuando** se revisa `package.json`
- **Entonces** existe la dependencia `@supabase/supabase-js`
- **Y** está instalada correctamente (`npm install` funciona)

---

### 2) Cliente de Supabase configurado

- **Dado** que se necesita usar Supabase
- **Cuando** se revisa la estructura de archivos
- **Entonces** existe el archivo:
  ```
  src/infrastructure/config/supabase.ts
  ```
- **Y** exporta una instancia del cliente de Supabase
- **Y** el cliente se inicializa con las variables de entorno
- **Y** el cliente es un singleton (se crea una sola vez)

---

### 3) Variables de entorno configuradas

- **Dado** que se necesita configurar las credenciales
- **Cuando** se revisa la configuración
- **Entonces** existe el archivo:
  ```
  src/infrastructure/config/environment.ts
  ```
- **Y** exporta funciones para obtener:
  - `getSupabaseUrl()`: retorna `NEXT_PUBLIC_SUPABASE_URL`
  - `getSupabaseAnonKey()`: retorna `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- **Y** valida que las variables existan (lanza error si faltan)

---

### 4) Archivo .env.example creado

- **Dado** que otros desarrolladores necesitan configurar el proyecto
- **Cuando** se revisa la raíz del proyecto
- **Entonces** existe el archivo `.env.example`
- **Y** contiene las variables:
  ```
  NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
  NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
  ```
- **Y** incluye comentarios explicativos sobre cómo obtener estas credenciales

---

### 5) Encapsulación respetada

- **Dado** que se implementa la conexión a Supabase
- **Cuando** se revisa el código
- **Entonces** `@supabase/supabase-js` solo se importa en `infrastructure/config/supabase.ts`
- **Y** Presentation y Domain no importan Supabase
- **Y** el cliente se exporta desde `infrastructure/config/supabase.ts` para uso en servicios/repositorios

---

### 6) Documentación creada

- **Dado** que se configura Supabase
- **Cuando** se completa la implementación
- **Entonces** existe documentación en:
  - `src/infrastructure/config/README.md` (actualizado con instrucciones de Supabase)
  - `.env.example` (con comentarios sobre cómo obtener credenciales)
- **Y** se explica cómo obtener las credenciales desde el dashboard de Supabase

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: `infrastructure/config/supabase.ts` y servicios/repositorios.

### Variables de entorno
- Usar prefijo `NEXT_PUBLIC_` para variables que deben estar disponibles en el cliente (Next.js).
- Validar que las variables existan al inicializar el cliente.
- No hardcodear credenciales en el código.

### Cliente de Supabase
- Crear una instancia singleton del cliente.
- Inicializar con `createClient()` de `@supabase/supabase-js`.
- Exportar el cliente para uso en servicios/repositorios de Infrastructure.

### Dependencias / Paquetes
- Instalar `@supabase/supabase-js` como dependencia (no devDependency).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Fase 1: Instalación
1. Instalar `@supabase/supabase-js`:
   ```bash
   npm install @supabase/supabase-js
   ```

### Fase 2: Crear configuración de entorno
1. Crear `src/infrastructure/config/environment.ts`:
   ```ts
   export function getSupabaseUrl(): string {
     const url = process.env.NEXT_PUBLIC_SUPABASE_URL;
     if (!url) {
       throw new Error('NEXT_PUBLIC_SUPABASE_URL is not defined');
     }
     return url;
   }

   export function getSupabaseAnonKey(): string {
     const key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
     if (!key) {
       throw new Error('NEXT_PUBLIC_SUPABASE_ANON_KEY is not defined');
     }
     return key;
   }
   ```

### Fase 3: Crear cliente de Supabase
1. Crear `src/infrastructure/config/supabase.ts`:
   ```ts
   import { createClient } from '@supabase/supabase-js';
   import { getSupabaseUrl, getSupabaseAnonKey } from './environment';

   const supabaseUrl = getSupabaseUrl();
   const supabaseAnonKey = getSupabaseAnonKey();

   export const supabaseClient = createClient(supabaseUrl, supabaseAnonKey);
   ```

### Fase 4: Crear .env.example
1. Crear `.env.example` en la raíz:
   ```
   # Supabase Configuration
   # Obtén estas credenciales desde: https://app.supabase.com/project/_/settings/api
   NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
   ```

### Fase 5: Documentación
1. Actualizar `src/infrastructure/config/README.md` con:
   - Instrucciones de configuración
   - Cómo obtener credenciales de Supabase
   - Uso del cliente en servicios/repositorios

Archivos/carpetas sugeridas:
```
src/infrastructure/config/
├── environment.ts      # Manejo de variables de entorno
├── supabase.ts        # Cliente de Supabase
└── README.md          # Documentación

.env.example           # Template de variables de entorno (raíz)
```

---

## Validación

Comandos mínimos:
- `npm install` (verificar que se instala @supabase/supabase-js)
- `npm run dev` (verificar que no hay errores de compilación)
- `npm run build` (verificar que el build funciona)

Verificaciones:
- El cliente de Supabase se puede importar desde `infrastructure/config/supabase.ts`
- Las variables de entorno se validan correctamente
- No hay imports de Supabase en Presentation o Domain
- El archivo `.env.example` está presente y documentado

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm install` OK
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Cliente de Supabase configurado y exportado
- [ ] Variables de entorno validadas
- [ ] `.env.example` creado y documentado
- [ ] Documentación actualizada
- [ ] Encapsulación respetada (Supabase solo en Infrastructure)
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: configure supabase connection and environment variables`",Backlog,Normal,HU
HU-012 — Formulario de registro de fundación (UI),"# HU-012 — Formulario de registro de fundación (UI)

**Como** usuario de una fundación  
**Quiero** ver y completar un formulario de registro visualmente atractivo y bien estructurado  
**Para** registrarme en la plataforma Amigo Gigante

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-009 (Logo en navbar)
- HU-010 (Atomic Design - componentes reutilizables, si aplica)

---

## Contexto / Notas

- Esta HU es **solo diseño/UI**: no incluye lógica de validación ni integración con backend.
- El formulario debe seguir el diseño proporcionado en `docs/design/code_registration_screen.html` y `docs/design/registration_screen.png`.
- El diseño de referencia usa colores diferentes al Design System actual (`primary: #2ce9ed` vs `brand: #1cb0f6`). Se debe adaptar al Design System existente usando tokens (`brand-500`, `accent-500`, `neutral-*`).
- El formulario debe ser responsive: layout de dos columnas en desktop, una columna en móvil.
- Los campos del formulario corresponden a:
  - Foundation Name → `foundations.name`
  - Official Email → `foundation_contacts.public_email`
  - Tax ID (opcional) → puede almacenarse en `foundations` o `foundation_contacts` según se defina
  - Password → para autenticación (Supabase Auth)
  - Confirm Password → validación de coincidencia
- El perfil de usuario se creará automáticamente cuando se implemente la funcionalidad (no en esta HU).

---

## Diseño

Referencias:
- Diseño: `docs/design/code_registration_screen.html`
- Imagen: `docs/design/registration_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del diseño:
- **Layout de dos columnas** (desktop):
  - Columna izquierda: formulario completo
  - Columna derecha: imagen con overlay y testimonio
- **Layout de una columna** (móvil): solo formulario
- **Header**: Logo + ""Amigo Gigante"" + botón ""Back to Home""
- **Formulario**:
  - Título: ""Join Amigo Gigante""
  - Subtítulo descriptivo
  - Campos: Foundation Name, Official Email, Tax ID (opcional), Password, Confirm Password
  - Checkbox de términos y condiciones
  - Botón de registro
  - Badge ""Secure Registration""
- **Footer**: Copyright
- **Link a login**: ""Already have an account? Log in""

Reglas:
- Usar tokens del Design System (`brand-500`, `neutral-*`, etc.).
- Adaptar colores del diseño de referencia al Design System existente.
- Mantener la estructura visual y jerarquía del diseño.
- Los inputs deben tener estados de focus visibles.
- Los botones de mostrar/ocultar contraseña deben funcionar visualmente (toggle de icono).

---

## Alcance

Incluye:
- Crear página/ruta de registro (`/register` o similar)
- Implementar layout de dos columnas (responsive)
- Crear formulario con todos los campos según diseño
- Implementar header con logo y botón de navegación
- Implementar columna derecha con imagen y overlay (solo desktop)
- Implementar footer
- Implementar estados visuales de inputs (focus, hover)
- Implementar toggle de mostrar/ocultar contraseña (solo UI, sin lógica)
- Adaptar colores al Design System existente
- Hacer el formulario responsive

No incluye:
- Validación de formulario
- Integración con Supabase Auth
- Creación real de perfiles o fundaciones
- Navegación funcional (los links pueden ser placeholders)
- Lógica de envío de formulario
- Manejo de errores
- Mensajes de éxito/error

---

## Criterios de aceptación (Given / When / Then)

### 1) Página de registro creada

- **Dado** que necesito acceder al formulario de registro
- **Cuando** navego a la ruta de registro
- **Entonces** veo la página de registro completa
- **Y** la página se carga sin errores

---

### 2) Layout responsive implementado

- **Dado** que estoy en la página de registro
- **Cuando** visualizo en desktop (≥1024px)
- **Entonces** veo el layout de dos columnas:
  - Formulario a la izquierda (50% del ancho)
  - Imagen con overlay a la derecha (50% del ancho)
- **Y** cuando visualizo en móvil (<1024px)
- **Entonces** veo solo el formulario (columna completa)
- **Y** la imagen derecha está oculta

---

### 3) Header implementado

- **Dado** que estoy en la página de registro
- **Cuando** observo el header
- **Entonces** veo:
  - Logo de Amigo Gigante (círculo azul con logo centrado)
  - Texto ""Amigo Gigante""
  - Botón/link ""Back to Home"" con icono de flecha
- **Y** el botón tiene efecto hover (cambio de color)

---

### 4) Formulario completo implementado

- **Dado** que estoy en la página de registro
- **Cuando** observo el formulario
- **Entonces** veo todos los campos:
  - Foundation Name (input de texto)
  - Official Email (input de email)
  - Tax ID (input de texto, marcado como opcional)
  - Password (input de password con botón de mostrar/ocultar)
  - Confirm Password (input de password con botón de mostrar/ocultar)
  - Checkbox de términos y condiciones
  - Botón ""Register Foundation"" con icono
  - Badge ""Secure Registration"" con icono de candado
- **Y** los campos tienen placeholders apropiados
- **Y** los labels están correctamente asociados

---

### 5) Estados visuales de inputs

- **Dado** que estoy en el formulario
- **Cuando** hago focus en un input
- **Entonces** el borde cambia de color (usando `brand-500` o `primary.main`)
- **Y** se muestra un ring de focus
- **Y** cuando hago hover sobre inputs
- **Entonces** hay un cambio visual sutil

---

### 6) Toggle de contraseña funcional (UI)

- **Dado** que estoy en los campos de contraseña
- **Cuando** hago clic en el botón de mostrar/ocultar
- **Entonces** el icono cambia (visibility ↔ visibility_off)
- **Y** el tipo de input cambia visualmente (password ↔ text)
- **Nota**: Esto es solo UI, no requiere lógica de estado compleja

---

### 7) Columna derecha con imagen (desktop)

- **Dado** que estoy en desktop
- **Cuando** observo la columna derecha
- **Entonces** veo:
  - Imagen de fondo (perros en campo)
  - Overlay con gradiente oscuro
  - Badge ""Join 500+ Foundations"" con icono
  - Testimonio en texto grande
  - Nombre de la fundación del testimonio
- **Y** el contenido está posicionado en la parte inferior

---

### 8) Footer implementado

- **Dado** que estoy en la página de registro
- **Cuando** scrolleo hacia abajo
- **Entonces** veo el footer con:
  - Texto de copyright ""© 2024 Amigo Gigante. All rights reserved.""
- **Y** está alineado según el diseño (centrado en móvil, izquierda en desktop)

---

### 9) Link a login implementado

- **Dado** que estoy en la página de registro
- **Cuando** observo la parte inferior del formulario
- **Entonces** veo el texto ""Already have an account? Log in""
- **Y** ""Log in"" es un link con estilo destacado
- **Y** tiene efecto hover

---

### 10) Uso del Design System

- **Dado** que se implementa el formulario
- **Cuando** se revisa el código
- **Entonces** se usan tokens del Design System:
  - `bg-brand-500` o `primary.main` para botones primarios
  - `neutral-*` para textos y bordes
  - `rounded-lg` para bordes redondeados
  - Tokens de spacing y tipografía
- **Y** no hay colores hardcodeados fuera de los tokens

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Esta HU es solo Presentation**: no toca Domain ni Infrastructure.

### UI
- Usar MUI para componentes base (TextField, Button, Checkbox, etc.).
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500`, `accent-500`, `neutral-*`).
- Adaptar colores del diseño de referencia al Design System existente.
- Los componentes deben ser reutilizables cuando sea posible (seguir Atomic Design si ya está implementado).

### Responsive
- Breakpoint principal: `lg` (1024px) para mostrar/ocultar columna derecha.
- Usar `hidden lg:flex` para columna derecha.
- Formulario debe ser responsive en todos los tamaños.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/register/
└── page.tsx                    # Página de registro

src/presentation/components/register/
├── RegisterForm.tsx            # Formulario principal
├── RegisterHeader.tsx           # Header con logo y botón
├── RegisterImageSection.tsx    # Columna derecha con imagen
└── RegisterFooter.tsx           # Footer

src/presentation/components/atoms/ (si Atomic Design está implementado)
├── PasswordInput/              # Input de contraseña con toggle
└── SecureBadge/                # Badge ""Secure Registration""
```

### Componentes principales:

1. **RegisterPage** (`src/app/register/page.tsx`):
   - Layout de dos columnas
   - Integra RegisterHeader, RegisterForm, RegisterImageSection, RegisterFooter

2. **RegisterForm**:
   - Todos los campos del formulario
   - Estados visuales
   - Toggle de contraseñas

3. **RegisterImageSection**:
   - Solo visible en desktop
   - Imagen de fondo
   - Overlay con contenido

### Notas de implementación:
- Usar `next/image` para la imagen de la columna derecha.
- Los botones de mostrar/ocultar contraseña pueden usar estado local simple (`useState`).
- Los links pueden ser placeholders (`href=""#""` o `href=""/login""`).
- Adaptar colores: el diseño usa `#2ce9ed` pero debemos usar `brand-500` del Design System.
- El checkbox de términos puede usar `Checkbox` de MUI.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que la página se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- El formulario se ve igual al diseño de referencia (adaptado al Design System)
- El layout es responsive (dos columnas en desktop, una en móvil)
- Los estados de focus funcionan correctamente
- El toggle de contraseña cambia el icono y tipo de input
- Todos los elementos están correctamente alineados
- Los colores usan tokens del Design System

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de registro creada y accesible
- [ ] Layout responsive implementado
- [ ] Formulario completo con todos los campos
- [ ] Estados visuales de inputs funcionando
- [ ] Toggle de contraseña funcional (UI)
- [ ] Columna derecha implementada (desktop)
- [ ] Header y footer implementados
- [ ] Link a login implementado
- [ ] Uso correcto de tokens del Design System
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add foundation registration form UI`",Backlog,Normal,HU
HU-013 — Estrategia de roles y protección de rutas,"# HU-013 — Estrategia de roles y protección de rutas

**Como** desarrollador  
**Quiero** definir la estrategia para validar roles y proteger rutas  
**Para** tener una arquitectura clara de autenticación y autorización

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)

---

## Contexto / Notas

- Esta HU define la **estrategia y arquitectura** para roles y protección de rutas.
- No implementa funcionalidad completa, solo la estructura y plan.
- Los roles se implementan a nivel **soft**: solo verificación básica, sin lógica compleja de permisos.
- Roles definidos: `'admin'`, `'foundation_user'`, `'external'` (según esquema BD).docs/scripts/db.sql
- Se debe definir cómo se verifica la sesión de Supabase y cómo se obtiene el rol del usuario.
- Se debe definir la estrategia para proteger rutas en Next.js App Router.

---

## Alcance

Incluye:
- Definir estructura para verificar autenticación (sesión de Supabase)
- Definir estructura para obtener y verificar roles del usuario
- Definir estrategia de middleware para Next.js App Router
- Crear tipos/interfaces para roles y autenticación
- Crear hooks/utilities básicos para verificar auth y roles
- Documentar la estrategia de protección de rutas
- Crear estructura base (sin implementación completa)

No incluye:
- Implementación completa del middleware
- Implementación de lógica de registro
- Validación de formularios
- Conexión real con Supabase para registro
- Sistema completo de permisos granular
- Lógica compleja de roles

---

## Criterios de aceptación (Given / When / Then)

### 1) Tipos e interfaces definidos

- **Dado** que se necesita trabajar con roles y autenticación
- **Cuando** se define la estructura
- **Entonces** existen tipos/interfaces para:
  - `UserRole` (tipo: `'admin' | 'foundation_user' | 'external'`)
  - `AuthUser` (interfaz con id, email, role)
  - `AuthSession` (interfaz para sesión)
- **Y** están en `domain/models/` o `domain/types/`

---

### 2) Hook de autenticación definido

- **Dado** que se necesita verificar autenticación
- **Cuando** se crea la estructura
- **Entonces** existe un hook `useAuth` (o similar) en `presentation/hooks/`
- **Y** el hook expone:
  - `user`: usuario actual o null
  - `isAuthenticated`: boolean
  - `role`: rol del usuario o null
  - `loading`: estado de carga
- **Y** está documentado cómo se obtiene la sesión de Supabase

---

### 3) Utilidades de verificación de roles

- **Dado** que se necesita verificar roles
- **Cuando** se crea la estructura
- **Entonces** existen funciones utilitarias para:
  - Verificar si un usuario tiene un rol específico
  - Verificar si un usuario tiene alguno de varios roles
  - Obtener el rol del usuario desde la sesión
- **Y** están en `presentation/utils/` o similar

---

### 4) Estrategia de middleware documentada

- **Dado** que se necesita proteger rutas
- **Cuando** se define la estrategia
- **Entonces** existe documentación que explica:
  - Cómo funciona el middleware de Next.js App Router
  - Dónde se ubicará el middleware (`middleware.ts` en raíz)
  - Cómo verificar la sesión en el middleware
  - Cómo redirigir según autenticación/rol
- **Y** la documentación está en `docs/` o como comentarios

---

### 5) Estructura base de middleware creada

- **Dado** que se necesita proteger rutas
- **Cuando** se crea la estructura
- **Entonces** existe un archivo `middleware.ts` (o estructura base)
- **Y** el middleware tiene:
  - Configuración de rutas protegidas
  - Lógica base para verificar sesión (comentada o con TODO)
  - Lógica base para redirigir (comentada o con TODO)
- **Nota**: No necesita estar completamente funcional, solo la estructura

---

### 6) Estrategia de protección por roles documentada

- **Dado** que existen diferentes roles
- **Cuando** se define la estrategia
- **Entonces** existe documentación que explica:
  - Cómo proteger rutas según rol específico
  - Cómo redirigir según el rol del usuario
  - Ejemplos de rutas protegidas por rol
- **Y** la estrategia es clara y simple (soft, sin lógica compleja)

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de registro
1. Validar datos del formulario (Presentation)
2. Llamar a `RegisterFoundationUseCase` (Presentation)
3. UseCase llama a `AuthRepository.signUp()` (Domain → Infrastructure)
4. UseCase llama a `FoundationRepository.createFoundation()` (Domain → Infrastructure)
5. UseCase crea perfil, contacto y miembro (Domain → Infrastructure)
6. Retornar éxito y redirigir (Presentation)

### Protección de rutas
- En Next.js App Router, usar middleware en `middleware.ts` (raíz del proyecto).
- El middleware verifica la sesión de Supabase.
- Redirige a `/login` si no hay sesión.
- Opcional: crear HOC `withAuth` para componentes si se prefiere.

### Roles
- Roles definidos: `'admin'`, `'foundation_user'`, `'external'`.
- Por defecto, usuarios registrados tienen `'foundation_user'`.
- Verificación básica: solo chequear el campo `role` en `profiles`.
- No implementar lógica compleja de permisos (se hará en otra HU).

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/domain/
├── types/
│   └── auth.types.ts          # UserRole, AuthUser, AuthSession
└── models/
    └── AuthUser.ts            # Modelo de usuario autenticado (opcional)

src/presentation/
├── hooks/
│   └── useAuth.ts             # Hook para obtener sesión y usuario
└── utils/
    └── roleUtils.ts           # Utilidades para verificar roles

middleware.ts                   # Middleware base (raíz del proyecto)

docs/
└── auth-strategy.md           # Documentación de la estrategia
```

### Flujo de implementación:

1. **Definir tipos**:
   - `UserRole`: tipo union de roles
   - `AuthUser`: interfaz con id, email, role
   - `AuthSession`: interfaz para sesión

2. **Crear hook useAuth**:
   - Obtener sesión de Supabase
   - Obtener usuario y rol
   - Estados: loading, isAuthenticated, user, role

3. **Crear utilidades de roles**:
   - `hasRole(user, role): boolean`
   - `hasAnyRole(user, roles): boolean`
   - `getUserRole(session): UserRole | null`

4. **Documentar estrategia de middleware**:
   - Cómo verificar sesión en middleware
   - Cómo proteger rutas
   - Cómo redirigir según auth/rol

5. **Crear estructura base de middleware**:
   - Archivo `middleware.ts` con estructura base
   - Configuración de rutas protegidas
   - Lógica comentada o con TODOs

### Notas importantes:
- Esta HU es solo estrategia/estructura, no implementación completa.
- El middleware puede tener TODOs o lógica comentada.
- La documentación debe ser clara para las siguientes HUs.
- Los tipos deben estar bien definidos para usar en HU-014 y HU-015.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que no hay errores de compilación)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- Los tipos están definidos y son correctos
- El hook useAuth tiene la estructura correcta (puede tener TODOs)
- Las utilidades de roles están definidas
- La documentación de estrategia está clara
- El middleware tiene estructura base (puede tener TODOs)

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Tipos e interfaces definidos
- [ ] Hook useAuth con estructura definida
- [ ] Utilidades de roles creadas
- [ ] Estrategia de middleware documentada
- [ ] Estructura base de middleware creada
- [ ] Estrategia de protección por roles documentada
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: define auth and role protection strategy`",Backlog,Normal,HU
HU-014 — Implementación de formulario de registro con Formik y Yup,"# HU-014 — Implementación de formulario de registro con Formik y Yup

**Como** usuario de una fundación  
**Quiero** completar el formulario de registro con validaciones robustas  
**Para** asegurarme de que los datos ingresados sean correctos antes de enviar

---

## Dependencias

- HU-012 (Formulario de registro UI implementado)
- HU-013 (Estrategia de roles y protección de rutas definida)

---

## Contexto / Notas

- Esta HU implementa la **funcionalidad del formulario** con validaciones usando Formik y Yup.
- No incluye la conexión con Supabase (eso va en HU-015).
- El formulario debe validar todos los campos según las reglas de negocio.
- Se debe mostrar feedback visual claro al usuario sobre errores y estado del formulario.
- Formik maneja el estado del formulario y Yup valida los datos.

---

## Alcance

Incluye:
- Instalación de Formik y Yup
- Integración de Formik con el formulario existente
- Definición de esquema de validación con Yup
- Validación de todos los campos (Foundation Name, Email, Tax ID, Password, Confirm Password)
- Manejo de estados del formulario (loading, errors, touched)
- Mostrar mensajes de error debajo de cada campo
- Deshabilitar botón de envío mientras se valida/envía
- Validación en tiempo real (onBlur) y al enviar

No incluye:
- Conexión con Supabase para registrar
- Lógica de negocio de registro
- Redirección después del registro
- Manejo de errores del servidor (solo validación cliente)

---

## Criterios de aceptación (Given / When / Then)

### 1) Formik y Yup instalados

- **Dado** que se necesita validación de formularios
- **Cuando** se instalan las dependencias
- **Entonces** existen en `package.json`:
  - `formik`
  - `yup`
- **Y** están instaladas correctamente

---

### 2) Formik integrado con el formulario

- **Dado** que existe el formulario de registro (HU-012)
- **Cuando** se integra Formik
- **Entonces** el formulario usa `useFormik` o `<Formik>`
- **Y** los campos están conectados con `getFieldProps` o `Field`
- **Y** el formulario mantiene su diseño visual

---

### 3) Esquema de validación con Yup

- **Dado** que se necesita validar los campos
- **Cuando** se crea el esquema de validación
- **Entonces** existe un esquema Yup que valida:
  - Foundation Name: requerido, mínimo 3 caracteres
  - Official Email: requerido, formato de email válido
  - Tax ID: opcional, si se ingresa debe tener formato válido
  - Password: requerido, mínimo 6 caracteres
  - Confirm Password: requerido, debe coincidir con Password
- **Y** los mensajes de error son claros y en español

---

### 4) Validación de Foundation Name

- **Dado** que el usuario completa el campo Foundation Name
- **Cuando** el campo está vacío o tiene menos de 3 caracteres
- **Entonces** se muestra un mensaje de error
- **Y** el mensaje aparece cuando el campo pierde el foco o al enviar

---

### 5) Validación de Email

- **Dado** que el usuario completa el campo Official Email
- **Cuando** el email está vacío o tiene formato inválido
- **Entonces** se muestra un mensaje de error apropiado
- **Y** la validación verifica formato de email correcto

---

### 6) Validación de Tax ID

- **Dado** que el campo Tax ID es opcional
- **Cuando** el usuario deja el campo vacío
- **Entonces** no se muestra error (es opcional)
- **Y** cuando el usuario ingresa un valor, se valida el formato si aplica

---

### 7) Validación de Password

- **Dado** que el usuario completa el campo Password
- **Cuando** el password está vacío o tiene menos de 6 caracteres
- **Entonces** se muestra un mensaje de error
- **Y** el mensaje indica el mínimo de caracteres requeridos

---

### 8) Validación de Confirm Password

- **Dado** que el usuario completa el campo Confirm Password
- **Cuando** el valor no coincide con Password
- **Entonces** se muestra un mensaje de error indicando que no coinciden
- **Y** la validación se ejecuta cuando ambos campos tienen valor

---

### 9) Estados visuales del formulario

- **Dado** que el formulario tiene validaciones
- **Cuando** hay errores de validación
- **Entonces** los campos con error muestran:
  - Borde de color de error (rojo o según Design System)
  - Mensaje de error debajo del campo
- **Y** el botón de envío está deshabilitado si hay errores

---

### 10) Estado de loading

- **Dado** que el formulario se está enviando
- **Cuando** se hace clic en ""Register Foundation""
- **Entonces** el botón muestra estado de loading
- **Y** el botón está deshabilitado durante el envío
- **Y** los campos están deshabilitados durante el envío

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Formik/Yup.
- Infrastructure contiene implementaciones y wiring IoC.
- **Formik y Yup solo en Presentation**: en los componentes del formulario.

### Validación
- Usar Yup para definir el esquema de validación.
- Los mensajes de error deben ser claros y en español.
- Validar en `onBlur` (cuando el campo pierde el foco) y al enviar.
- No validar mientras el usuario está escribiendo (solo onBlur y onSubmit).

### Integración con MUI
- Usar `TextField` de MUI con `error` y `helperText` para mostrar errores.
- Conectar los campos con `getFieldProps` de Formik.
- Mantener el diseño visual del formulario existente.

### Dependencias / Paquetes
- Instalar `formik` y `yup` como dependencias.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/presentation/
├── components/
│   └── register/
│       ├── RegisterForm.tsx          # Formulario con Formik
│       └── registerValidation.ts     # Esquema Yup
└── hooks/
    └── useRegisterForm.ts            # Hook opcional para lógica del formulario
```

### Flujo de implementación:

1. **Instalar dependencias**:
   ```bash
   npm install formik yup
   ```

2. **Crear esquema de validación**:
   - `registerValidation.ts` con esquema Yup
   - Validar todos los campos según criterios

3. **Integrar Formik en RegisterForm**:
   - Usar `useFormik` o `<Formik>`
   - Conectar campos con `getFieldProps`
   - Manejar `onSubmit` (por ahora solo console.log o TODO)

4. **Conectar campos MUI con Formik**:
   - Usar `error={touched.field && !!errors.field}`
   - Usar `helperText={touched.field && errors.field}`

5. **Manejar estados**:
   - `isSubmitting` para deshabilitar botón
   - `touched` para mostrar errores solo cuando corresponda
   - `errors` para mensajes de error

### Ejemplo de esquema Yup:

```typescript
import * as Yup from 'yup';

export const registerSchema = Yup.object().shape({
  foundationName: Yup.string()
    .required('El nombre de la fundación es requerido')
    .min(3, 'El nombre debe tener al menos 3 caracteres'),
  officialEmail: Yup.string()
    .required('El email oficial es requerido')
    .email('El email debe tener un formato válido'),
  taxId: Yup.string().optional(),
  password: Yup.string()
    .required('La contraseña es requerida')
    .min(6, 'La contraseña debe tener al menos 6 caracteres'),
  confirmPassword: Yup.string()
    .required('Debes confirmar la contraseña')
    .oneOf([Yup.ref('password')], 'Las contraseñas no coinciden'),
  acceptTerms: Yup.boolean()
    .required('Debes aceptar los términos y condiciones')
    .oneOf([true], 'Debes aceptar los términos y condiciones'),
});
```

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el formulario funciona)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- El formulario valida todos los campos correctamente
- Los mensajes de error se muestran cuando corresponda
- El botón se deshabilita cuando hay errores
- El estado de loading funciona
- El diseño visual se mantiene igual

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Formik y Yup instalados
- [ ] Formik integrado con el formulario
- [ ] Esquema de validación Yup creado
- [ ] Todas las validaciones funcionan correctamente
- [ ] Estados visuales funcionan (errores, loading)
- [ ] Mensajes de error en español y claros
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add formik and yup validation to registration form`",Backlog,Normal,HU
HU-015 — Lógica de negocio de registro con Supabase,"# HU-015 — Lógica de negocio de registro con Supabase

**Como** usuario de una fundación  
**Quiero** completar el registro y que se cree mi cuenta y fundación  
**Para** acceder a la plataforma Amigo Gigante

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-012 (Formulario de registro UI implementado)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-014 (Formulario con Formik y Yup implementado)

---

## Contexto / Notas

- Esta HU implementa la **lógica de negocio** del registro conectando con Supabase.
- El formulario ya está validado (HU-014), ahora se conecta con el backend.
- El flujo de registro debe crear:
  1. Usuario en Supabase Auth (con email y password)
  2. Perfil en `profiles` (con `role: 'foundation_user'`)
  3. Fundación en `foundations` (con nombre)
  4. Contacto en `foundation_contacts` (con email oficial)
  5. Miembro en `foundation_members` (usuario como `owner` de la fundación)
- Se debe manejar errores del servidor y mostrarlos al usuario.
- Después del registro exitoso, el usuario debe quedar autenticado y ser redirigido.

---

## Alcance

Incluye:
- Crear UseCase de registro de fundación
- Crear repositorios necesarios (Auth, Foundation, Profile)
- Implementar servicios de Supabase para registro
- Conectar el formulario con el UseCase
- Manejo de errores del servidor (mostrar mensajes al usuario)
- Redirección después del registro exitoso
- Crear perfil automáticamente con rol `foundation_user`

No incluye:
- Validación de formulario (ya está en HU-014)
- Protección de rutas completa (solo estrategia en HU-013)
- Logout funcional
- Validación de email por correo
- Recuperación de contraseña
- Edición de perfil o fundación

---

## Criterios de aceptación (Given / When / Then)

### 1) UseCase de registro implementado

- **Dado** que se necesita registrar una fundación
- **Cuando** se implementa la lógica de negocio
- **Entonces** existe un UseCase `RegisterFoundationUseCase` en `domain/usecases/auth/`
- **Y** el UseCase recibe los datos del formulario
- **Y** ejecuta el flujo completo de registro

---

### 2) Repositorios creados

- **Dado** que se necesita interactuar con Supabase
- **Cuando** se implementan los repositorios
- **Entonces** existen:
  - `IAuthRepository` (interfaz en Domain)
  - `AuthRepository` (implementación en Infrastructure)
  - `IFoundationRepository` (interfaz en Domain)
  - `FoundationRepository` (implementación en Infrastructure)
- **Y** los repositorios están registrados en el contenedor IoC

---

### 3) Registro completo funcional

- **Dado** que un usuario completa el formulario de registro
- **Cuando** envía el formulario con datos válidos
- **Entonces** se crea:
  - Usuario en Supabase Auth
  - Perfil con `role: 'foundation_user'`
  - Fundación con el nombre proporcionado
  - Contacto de fundación con el email oficial
  - Miembro de fundación con el usuario como `owner`
- **Y** el usuario queda autenticado en la sesión

---

### 4) Manejo de errores del servidor

- **Dado** que ocurre un error durante el registro
- **Cuando** se intenta registrar
- **Entonces** se muestra un mensaje de error al usuario
- **Y** los errores comunes se manejan:
  - Email ya registrado
  - Error de conexión
  - Error de validación de Supabase
- **Y** los mensajes de error son claros y en español

---

### 5) Redirección después del registro

- **Dado** que el registro es exitoso
- **Cuando** se completa el registro
- **Entonces** el usuario es redirigido a una ruta protegida (ej: `/dashboard`)
- **Y** la sesión queda activa
- **Y** el usuario puede acceder a áreas protegidas

---

### 6) Integración con formulario

- **Dado** que el formulario tiene validación (HU-014)
- **Cuando** se conecta con la lógica de negocio
- **Entonces** el `onSubmit` de Formik llama al UseCase
- **Y** se muestra estado de loading durante el registro
- **Y** se manejan errores y éxito correctamente

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de registro
1. Usuario completa formulario (validado con Yup)
2. `onSubmit` de Formik llama a `RegisterFoundationUseCase` (Presentation)
3. UseCase llama a `AuthRepository.signUp()` (Domain → Infrastructure)
4. UseCase crea perfil con `role: 'foundation_user'` (Domain → Infrastructure)
5. UseCase llama a `FoundationRepository.createFoundation()` (Domain → Infrastructure)
6. UseCase crea contacto de fundación (Domain → Infrastructure)
7. UseCase crea miembro de fundación como `owner` (Domain → Infrastructure)
8. Retornar éxito y redirigir (Presentation)

### Transacciones
- Si es posible, usar transacciones de Supabase para asegurar atomicidad.
- Si falla algún paso, revertir los cambios anteriores.
- Si no es posible transacciones, manejar errores y limpiar datos creados.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/domain/
├── models/
│   ├── AuthUser.ts
│   └── Foundation.ts
├── repositories/
│   ├── IAuthRepository.ts
│   └── IFoundationRepository.ts
└── usecases/
    └── auth/
        └── RegisterFoundationUseCase.ts

src/infrastructure/
├── repositories/
│   ├── AuthRepository.ts
│   └── FoundationRepository.ts
└── services/
    └── SupabaseAuthService.ts (opcional, si se abstrae)

src/presentation/
└── components/
    └── register/
        └── RegisterForm.tsx (conectar onSubmit con UseCase)
```

### Flujo de implementación:

1. **Crear modelos Domain**:
   - `AuthUser` (id, email, role)
   - `Foundation` (id, name, etc.)

2. **Crear interfaces de repositorios**:
   - `IAuthRepository.signUp(email, password): Promise<AuthUser>`
   - `IAuthRepository.createProfile(userId, role): Promise<void>`
   - `IFoundationRepository.createFoundation(data): Promise<Foundation>`
   - `IFoundationRepository.createFoundationContact(foundationId, email): Promise<void>`
   - `IFoundationRepository.createFoundationMember(foundationId, userId, role): Promise<void>`

3. **Implementar repositorios en Infrastructure**:
   - `AuthRepository` usa Supabase Auth y DB
   - `FoundationRepository` usa Supabase DB

4. **Crear UseCase**:
   - `RegisterFoundationUseCase.execute(data)`:
     - Sign up en Auth
     - Crear perfil con `role: 'foundation_user'`
     - Crear fundación
     - Crear contacto
     - Crear miembro como `owner`

5. **Conectar formulario**:
   - En `RegisterForm.tsx`, en `onSubmit` de Formik:
     - Obtener UseCase del contenedor IoC
     - Llamar a `execute()` con los datos del formulario
     - Manejar éxito (redirigir) y errores (mostrar mensaje)

6. **Manejar errores**:
   - Traducir errores de Supabase a mensajes amigables
   - Mostrar mensajes de error en el formulario
   - Manejar casos: email duplicado, error de conexión, etc.

### Notas importantes:
- Usar transacciones si es posible (Supabase permite múltiples inserts).
- El Tax ID puede omitirse o guardarse en `foundation_contacts` como campo adicional.
- Los errores de Supabase deben traducirse a mensajes amigables en español.
- Después del registro, el usuario debe quedar autenticado automáticamente.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el registro funciona)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- El registro crea todos los registros necesarios en Supabase
- Los errores se muestran correctamente al usuario
- La redirección después del registro funciona
- El usuario queda autenticado después del registro
- La sesión persiste correctamente

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] UseCase de registro implementado
- [ ] Repositorios creados y registrados en IoC
- [ ] Registro completo funcional (crea usuario, perfil, fundación, contacto, miembro)
- [ ] Manejo de errores del servidor implementado
- [ ] Redirección después del registro funciona
- [ ] Integración con formulario funciona correctamente
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: implement foundation registration business logic with supabase`",Backlog,Normal,HU
HU-016 — Sistema de traducciones (i18n) español/inglés,"# HU-016 — Sistema de traducciones (i18n) español/inglés

**Como** usuario  
**Quiero** ver la aplicación en español o inglés según mi preferencia  
**Para** usar la plataforma en mi idioma preferido

---

## Dependencias

- HU-001 (Next.js App Router funcionando)

---

## Contexto / Notas

- Esta HU implementa un sistema de internacionalización (i18n) completo.
- Se soportan dos idiomas: Español (es) e Inglés (en).
- Se usa `next-intl` que es la solución recomendada para Next.js App Router.
- El idioma se detecta automáticamente desde el navegador o se puede cambiar manualmente.
- Las traducciones se almacenan en archivos JSON organizados por namespace.
- Se debe seguir buenas prácticas: type-safety, namespaces, lazy loading.

---

## Alcance

Incluye:
- Instalación y configuración de `next-intl`
- Estructura de carpetas para traducciones (es, en)
- Configuración de middleware para detectar/cambiar idioma
- Creación de archivos de traducción organizados por namespace
- Hook/provider para usar traducciones en componentes
- Selector de idioma en la UI
- Traducción de textos existentes en componentes clave
- Configuración de routing por locale (opcional, si se requiere)

No incluye:
- Traducción completa de toda la aplicación (solo estructura y ejemplos)
- Traducción de contenido dinámico de BD (solo UI)
- RTL (Right-to-Left) para otros idiomas
- Más de 2 idiomas (solo es y en)

---

## Criterios de aceptación (Given / When / Then)

### 1) next-intl instalado y configurado

- **Dado** que se necesita i18n
- **Cuando** se instala la librería
- **Entonces** existe `next-intl` en `package.json`
- **Y** está configurado correctamente para Next.js App Router

---

### 2) Estructura de traducciones creada

- **Dado** que se necesitan archivos de traducción
- **Cuando** se crea la estructura
- **Entonces** existen carpetas:
  - `src/messages/es/` (traducciones en español)
  - `src/messages/en/` (traducciones en inglés)
- **Y** cada carpeta contiene archivos JSON organizados por namespace (ej: `common.json`, `home.json`, `register.json`)

---

### 3) Configuración de next-intl

- **Dado** que se configura next-intl
- **Cuando** se revisa la configuración
- **Entonces** existe:
  - `src/i18n/request.ts` (configuración del request)
  - `src/i18n/config.ts` (configuración de locales)
  - Middleware configurado para detectar idioma
- **Y** los locales soportados son `es` y `en`

---

### 4) Hook de traducciones funcional

- **Dado** que se necesita usar traducciones en componentes
- **Cuando** se implementa el hook
- **Entonces** existe un hook `useTranslations` (de next-intl)
- **Y** se puede usar en componentes de React
- **Y** es type-safe (TypeScript)

---

### 5) Archivos de traducción con contenido

- **Dado** que se crean archivos de traducción
- **Cuando** se revisan los archivos
- **Entonces** existen traducciones para:
  - Textos comunes (`common.json`)
  - Home page (`home.json`)
  - Registro (`register.json`)
- **Y** cada archivo tiene las mismas keys en ambos idiomas
- **Y** las traducciones están completas y correctas

---

### 6) Selector de idioma en UI

- **Dado** que el usuario quiere cambiar el idioma
- **Cuando** se implementa el selector
- **Entonces** existe un componente selector de idioma
- **Y** permite cambiar entre español e inglés
- **Y** el cambio se persiste (localStorage o cookie)
- **Y** la página se actualiza con el nuevo idioma

---

### 7) Componentes traducidos

- **Dado** que existen componentes con texto hardcodeado
- **Cuando** se implementan traducciones
- **Entonces** al menos estos componentes usan traducciones:
  - HomeNavBar
  - HeroSection
  - RegisterForm
  - Copyright
- **Y** los textos se muestran en el idioma seleccionado

---

### 8) Detección automática de idioma

- **Dado** que el usuario visita la aplicación por primera vez
- **Cuando** se carga la página
- **Entonces** el idioma se detecta automáticamente desde:
  - Preferencia del navegador
  - O configuración guardada (localStorage/cookie)
- **Y** si no hay preferencia, usa español como default

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/next-intl.
- Infrastructure contiene implementaciones y wiring IoC.
- **next-intl solo en Presentation**: componentes y configuración.

### i18n
- Usar `next-intl` como librería principal.
- Organizar traducciones por namespace (common, home, register, etc.).
- Usar keys descriptivas y anidadas: `home.hero.title`, `register.form.email.label`.
- Mantener consistencia en las keys entre idiomas.

### Estructura de traducciones
```
src/messages/
├── es/
│   ├── common.json
│   ├── home.json
│   └── register.json
└── en/
    ├── common.json
    ├── home.json
    └── register.json
```

### Type Safety
- Usar TypeScript para type-safety en traducciones.
- Definir tipos/interfaces para los namespaces si es posible.
- Validar que todas las keys existan en ambos idiomas.

### Dependencias / Paquetes
- Instalar `next-intl` como dependencia.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Fase 1: Instalación
1. Instalar `next-intl`:
   ```bash
   npm install next-intl
   ```

### Fase 2: Configuración
1. Crear `src/i18n/config.ts`:
   - Definir locales: `['es', 'en']`
   - Default locale: `'es'`

2. Crear `src/i18n/request.ts`:
   - Configurar `getRequestConfig` de next-intl
   - Cargar traducciones según locale

3. Crear `middleware.ts` (raíz):
   - Detectar locale desde header o cookie
   - Redirigir a ruta con locale si es necesario

### Fase 3: Estructura de traducciones
1. Crear carpetas `src/messages/es/` y `src/messages/en/`
2. Crear archivos JSON por namespace:
   - `common.json`: textos comunes (botones, labels, etc.)
   - `home.json`: textos de la página home
   - `register.json`: textos del formulario de registro

### Fase 4: Integración en componentes
1. Envolver la app con `NextIntlClientProvider` (si es necesario)
2. Usar `useTranslations` hook en componentes
3. Reemplazar textos hardcodeados por llamadas a traducciones

### Fase 5: Selector de idioma
1. Crear componente `LanguageSelector`
2. Permitir cambiar entre es/en
3. Guardar preferencia en localStorage o cookie
4. Actualizar la página con el nuevo idioma

### Ejemplo de estructura de traducciones:

**src/messages/es/common.json:**
```json
{
  ""buttons"": {
    ""search"": ""Buscar"",
    ""login"": ""Iniciar Sesión"",
    ""register"": ""Registrarse""
  },
  ""navigation"": {
    ""adopt"": ""Adopta"",
    ""sponsor"": ""Apadrina"",
    ""foundations"": ""Fundaciones"",
    ""store"": ""Tienda Solidaria""
  }
}
```

**src/messages/en/common.json:**
```json
{
  ""buttons"": {
    ""search"": ""Search"",
    ""login"": ""Log In"",
    ""register"": ""Sign Up""
  },
  ""navigation"": {
    ""adopt"": ""Adopt"",
    ""sponsor"": ""Sponsor"",
    ""foundations"": ""Foundations"",
    ""store"": ""Charity Store""
  }
}
```

### Ejemplo de uso en componente:

```tsx
import { useTranslations } from 'next-intl';

export function HomeNavBar() {
  const t = useTranslations('common');
  
  return (
    <Button>{t('buttons.login')}</Button>
  );
}
```

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que las traducciones funcionan)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- El selector de idioma funciona correctamente
- Los textos cambian al cambiar el idioma
- La detección automática de idioma funciona
- Los componentes muestran textos traducidos
- No hay textos hardcodeados en los componentes traducidos

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] next-intl instalado y configurado
- [ ] Estructura de traducciones creada (es, en)
- [ ] Configuración de next-intl implementada
- [ ] Hook de traducciones funcional
- [ ] Archivos de traducción con contenido
- [ ] Selector de idioma implementado
- [ ] Componentes clave traducidos
- [ ] Detección automática de idioma funciona
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: implement i18n system with spanish and english support`",Backlog,Normal,HU
HU-017 — Interfaz de login de fundación (UI),"# HU-017 — Interfaz de login de fundación (UI)

**Como** usuario de una fundación  
**Quiero** ver y usar una página de login visualmente atractiva y bien estructurada  
**Para** acceder a mi cuenta en la plataforma Amigo Gigante

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-009 (Logo en navbar)
- HU-010 (Atomic Design - componentes reutilizables, si aplica)
- HU-016 (Sistema de traducciones configurado)

---

## Contexto / Notas

- Esta HU es **solo diseño/UI**: no incluye lógica de autenticación ni integración con backend.
- El formulario debe seguir el diseño proporcionado en `docs/design/code_login_screen.html` y `docs/design/login_screen.png`.
- El diseño de referencia usa colores diferentes al Design System actual (`primary: #2ce9ed` vs `brand: #1cb0f6`). Se debe adaptar al Design System existente usando tokens (`brand-500`, `accent-500`, `neutral-*`).
- El formulario debe ser responsive: layout de dos columnas en desktop (lg+), una columna en móvil/tablet.
- La ruta `/login` ya está definida como pública en el middleware (HU-013).
- **IMPORTANTE**: Al crear la rama para el PR, usar el nombre: `HU-017 - Implementación del login`

---

## Diseño

Referencias:
- Diseño: `docs/design/code_login_screen.html`
- Imagen: `docs/design/login_screen.png`
- Design System: `docs/design/system.md`

Estructura del diseño:
- **Layout de dos columnas** (desktop lg+):
  - Columna izquierda: imagen con overlay y contenido motivacional
  - Columna derecha: formulario de login
- **Layout de una columna** (móvil/tablet): solo formulario
- **Header**: Logo + ""Amigo Gigante"" + navegación (Home, About, Contact) + botón ""Register Foundation"" + menú hamburguesa (móvil)
- **Formulario**:
  - Título: ""Welcome back, Partner""
  - Subtítulo: ""Log in to manage your adoptions and sponsorships""
  - Campo Email con icono de mail
  - Campo Password con icono de lock y toggle de visibilidad
  - Link ""Forgot Password?""
  - Badge ""Secure SSL encrypted login"" con icono
  - Botón ""Log In""
  - Link ""New to Amigo Gigante? Register your foundation""
- **Columna izquierda (desktop)**:
  - Imagen de fondo (golden retriever)
  - Overlay con gradiente oscuro
  - Badge ""Adopt & Care"" con icono
  - Título ""Every paw matters.""
  - Texto descriptivo sobre fundaciones

Reglas:
- Usar tokens del Design System (`brand-500`, `neutral-*`, etc.).
- Adaptar colores del diseño de referencia al Design System existente.
- Mantener la estructura visual y jerarquía del diseño.
- Los inputs deben tener estados de focus visibles.
- El toggle de mostrar/ocultar contraseña debe funcionar visualmente.
- **TODOS los textos deben usar traducciones** (español e inglés).

---

## Alcance

Incluye:
- Crear página/ruta de login (`/login`)
- Implementar layout de dos columnas (responsive)
- Crear formulario con campos Email y Password
- Implementar header con logo, navegación y botón de registro
- Implementar columna izquierda con imagen y overlay (solo desktop)
- Implementar estados visuales de inputs (focus, hover)
- Implementar toggle de mostrar/ocultar contraseña (solo UI, sin lógica)
- Adaptar colores al Design System existente
- Hacer el formulario responsive (móvil, tablet, desktop, ultra-wide)
- **Agregar traducciones** en `src/messages/es/login.json` y `src/messages/en/login.json`
- Usar `useTranslations` de `next-intl` en todos los componentes

No incluye:
- Validación de formulario
- Integración con Supabase Auth
- Lógica de autenticación real
- Navegación funcional (los links pueden ser placeholders)
- Lógica de envío de formulario
- Manejo de errores
- Mensajes de éxito/error
- Funcionalidad de ""Forgot Password"" (solo UI)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página de login creada

- **Dado** que necesito acceder al formulario de login
- **Cuando** navego a la ruta `/login`
- **Entonces** veo la página de login completa
- **Y** la página se carga sin errores

---

### 2) Layout responsive implementado

- **Dado** que estoy en la página de login
- **Cuando** visualizo en desktop (≥1024px)
- **Entonces** veo el layout de dos columnas:
  - Imagen con overlay a la izquierda (50% del ancho)
  - Formulario a la derecha (50% del ancho)
- **Y** cuando visualizo en móvil/tablet (<1024px)
- **Entonces** veo solo el formulario (columna completa)
- **Y** la imagen izquierda está oculta
- **Y** el layout es responsive hasta ultra-wide (2560px+)

---

### 3) Header implementado

- **Dado** que estoy en la página de login
- **Cuando** observo el header
- **Entonces** veo:
  - Logo de Amigo Gigante (círculo azul con logo centrado)
  - Texto ""Amigo Gigante""
  - Enlaces de navegación (Home, About, Contact) - solo desktop
  - Botón ""Register Foundation"" - solo desktop
  - Menú hamburguesa - solo móvil/tablet
- **Y** el header tiene backdrop blur y borde inferior
- **Y** los enlaces tienen efecto hover

---

### 4) Formulario completo implementado

- **Dado** que estoy en la página de login
- **Cuando** observo el formulario
- **Entonces** veo todos los elementos:
  - Título ""Welcome back, Partner""
  - Subtítulo descriptivo
  - Campo Email con icono de mail y placeholder
  - Campo Password con icono de lock, placeholder y botón de mostrar/ocultar
  - Link ""Forgot Password?"" alineado a la derecha
  - Badge ""Secure SSL encrypted login"" con icono
  - Botón ""Log In"" con estilo primario
  - Link ""New to Amigo Gigante? Register your foundation""
- **Y** los campos tienen placeholders apropiados
- **Y** los labels están correctamente asociados

---

### 5) Estados visuales de inputs

- **Dado** que estoy en el formulario
- **Cuando** hago focus en un input
- **Entonces** el borde cambia de color (usando `brand-500` o `primary.main`)
- **Y** se muestra un ring de focus
- **Y** cuando hago hover sobre inputs
- **Entonces** hay un cambio visual sutil

---

### 6) Toggle de contraseña funcional (UI)

- **Dado** que estoy en el campo de contraseña
- **Cuando** hago clic en el botón de mostrar/ocultar
- **Entonces** el icono cambia (visibility ↔ visibility_off)
- **Y** el tipo de input cambia visualmente (password ↔ text)
- **Nota**: Esto es solo UI, no requiere lógica de estado compleja

---

### 7) Columna izquierda con imagen (desktop)

- **Dado** que estoy en desktop
- **Cuando** observo la columna izquierda
- **Entonces** veo:
  - Imagen de fondo (golden retriever en parque)
  - Overlay con gradiente oscuro (from-black/40 to-transparent)
  - Badge ""Adopt & Care"" con icono de pets
  - Título ""Every paw matters.""
  - Texto descriptivo sobre fundaciones
- **Y** el contenido está posicionado en la parte inferior izquierda
- **Y** la imagen tiene efecto hover (zoom sutil)

---

### 8) Traducciones implementadas

- **Dado** que se implementa la página de login
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen archivos:
  - `src/messages/es/login.json` con todas las traducciones en español
  - `src/messages/en/login.json` con todas las traducciones en inglés
- **Y** las keys son consistentes entre ambos idiomas
- **Y** no hay textos hardcodeados en español o inglés

---

### 9) Uso del Design System

- **Dado** que se implementa el formulario
- **Cuando** se revisa el código
- **Entonces** se usan tokens del Design System:
  - `bg-brand-500` o `primary.main` para botones primarios
  - `neutral-*` para textos y bordes
  - `rounded-lg` para bordes redondeados
  - Tokens de spacing y tipografía
- **Y** no hay colores hardcodeados fuera de los tokens

---

### 10) Responsividad completa

- **Dado** que estoy en la página de login
- **Cuando** cambio el tamaño de la ventana
- **Entonces** el layout se adapta correctamente en:
  - Móvil (320px - 767px)
  - Tablet (768px - 1023px)
  - Desktop (1024px - 1919px)
  - Large Desktop (1920px - 2559px)
  - Ultra-wide (2560px+)
- **Y** todos los elementos son legibles y accesibles
- **Y** no hay overflow horizontal

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Esta HU es solo Presentation**: no toca Domain ni Infrastructure.

### UI
- Usar MUI para componentes base (TextField, Button, IconButton, etc.).
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500`, `accent-500`, `neutral-*`).
- Adaptar colores del diseño de referencia al Design System existente.
- Los componentes deben ser reutilizables cuando sea posible (seguir Atomic Design si ya está implementado).

### Responsive
- Breakpoint principal: `lg` (1024px) para mostrar/ocultar columna izquierda.
- Usar `hidden lg:flex` para columna izquierda.
- Formulario debe ser responsive en todos los tamaños (móvil a ultra-wide).
- Usar `Container` de MUI con `maxWidth` apropiado.
- Padding y spacing adaptativos según breakpoint.

### Traducciones (OBLIGATORIO)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/login.json` (español)
  - `src/messages/en/login.json` (inglés)
- Organizar traducciones por secciones: `header`, `form`, `leftColumn`, etc.
- **NO hardcodear textos en español o inglés** en componentes.
- Usar `useTranslations('login')` hook de `next-intl` para acceder a traducciones.
- Keys descriptivas y anidadas: `login.form.title`, `login.form.email.label`, etc.
- Mantener consistencia: mismas keys en ambos idiomas.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

### Git / Branching
- **Al crear la rama para el PR, usar el nombre**: `HU-017 - Implementación del login`
- Ejemplo: `git checkout -b ""HU-017 - Implementación del login""`

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/login/
└── page.tsx                    # Página de login

src/presentation/components/login/
├── LoginHeader.tsx             # Header con logo y navegación
├── LoginForm.tsx               # Formulario principal
├── LoginImageSection.tsx       # Columna izquierda con imagen
└── PasswordInput.tsx           # Input de contraseña con toggle (si es reutilizable)

src/messages/
├── es/
│   └── login.json              # Traducciones en español
└── en/
    └── login.json              # Traducciones en inglés
```

### Componentes principales:

1. **LoginPage** (`src/app/login/page.tsx`):
   - Layout de dos columnas
   - Integra LoginHeader, LoginForm, LoginImageSection
   - Responsive: oculta columna izquierda en móvil

2. **LoginHeader**:
   - Logo + ""Amigo Gigante""
   - Navegación (Home, About, Contact) - solo desktop
   - Botón ""Register Foundation"" - solo desktop
   - Menú hamburguesa - solo móvil

3. **LoginForm**:
   - Título y subtítulo
   - Campo Email con icono
   - Campo Password con icono y toggle
   - Link ""Forgot Password?""
   - Badge de seguridad
   - Botón de login
   - Link a registro

4. **LoginImageSection**:
   - Solo visible en desktop (lg+)
   - Imagen de fondo con `next/image`
   - Overlay con gradiente
   - Contenido motivacional (badge, título, texto)

### Estructura de traducciones sugerida:

**src/messages/es/login.json:**
```json
{
  ""header"": {
    ""home"": ""Inicio"",
    ""about"": ""Acerca de"",
    ""contact"": ""Contacto"",
    ""registerFoundation"": ""Registrar Fundación""
  },
  ""form"": {
    ""title"": ""Bienvenido de nuevo, Socio"",
    ""subtitle"": ""Inicia sesión para gestionar tus adopciones y apadrinamientos"",
    ""email"": {
      ""label"": ""Dirección de Email"",
      ""placeholder"": ""name@foundation.org""
    },
    ""password"": {
      ""label"": ""Contraseña"",
      ""placeholder"": ""••••••••""
    },
    ""forgotPassword"": ""¿Olvidaste tu contraseña?"",
    ""secureLogin"": ""Inicio de sesión seguro SSL encriptado"",
    ""submit"": ""Iniciar Sesión"",
    ""newUser"": ""¿Nuevo en Amigo Gigante?"",
    ""registerLink"": ""Registra tu fundación""
  },
  ""leftColumn"": {
    ""badge"": ""Adopta y Cuida"",
    ""title"": ""Cada pata importa."",
    ""description"": ""Únete a más de 500 fundaciones haciendo la diferencia en la vida de los animales cada día.""
  }
}
```

**src/messages/en/login.json:**
```json
{
  ""header"": {
    ""home"": ""Home"",
    ""about"": ""About"",
    ""contact"": ""Contact"",
    ""registerFoundation"": ""Register Foundation""
  },
  ""form"": {
    ""title"": ""Welcome back, Partner"",
    ""subtitle"": ""Log in to manage your adoptions and sponsorships"",
    ""email"": {
      ""label"": ""Email Address"",
      ""placeholder"": ""name@foundation.org""
    },
    ""password"": {
      ""label"": ""Password"",
      ""placeholder"": ""••••••••""
    },
    ""forgotPassword"": ""Forgot Password?"",
    ""secureLogin"": ""Secure SSL encrypted login"",
    ""submit"": ""Log In"",
    ""newUser"": ""New to Amigo Gigante?"",
    ""registerLink"": ""Register your foundation""
  },
  ""leftColumn"": {
    ""badge"": ""Adopt & Care"",
    ""title"": ""Every paw matters."",
    ""description"": ""Join over 500 foundations making a difference in the lives of animals every day.""
  }
}
```

### Notas de implementación:
- Usar `next/image` para la imagen de la columna izquierda.
- El botón de mostrar/ocultar contraseña puede usar estado local simple (`useState`).
- Los links pueden ser placeholders (`href=""#""` o `href=""/register""`).
- Adaptar colores: el diseño usa `#2ce9ed` pero debemos usar `brand-500` del Design System.
- El header debe tener backdrop blur similar al HomeNavBar.
- La imagen debe tener efecto hover de zoom sutil (usar `group` y `group-hover:scale-105`).

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que la página se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- El formulario se ve igual al diseño de referencia (adaptado al Design System)
- El layout es responsive (dos columnas en desktop, una en móvil)
- Los estados de focus funcionan correctamente
- El toggle de contraseña cambia el icono y tipo de input
- Todos los elementos están correctamente alineados
- Los colores usan tokens del Design System
- Las traducciones funcionan correctamente (cambiar idioma y verificar)
- No hay textos hardcodeados

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de login creada y accesible en `/login`
- [ ] Layout responsive implementado (móvil a ultra-wide)
- [ ] Formulario completo con todos los campos
- [ ] Estados visuales de inputs funcionando
- [ ] Toggle de contraseña funcional (UI)
- [ ] Columna izquierda implementada (desktop)
- [ ] Header implementado con navegación
- [ ] Link a registro implementado
- [ ] Uso correcto de tokens del Design System
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/login.json`
  - [ ] Textos agregados en `src/messages/en/login.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- [ ] Rama creada con nombre: `HU-017 - Implementación del login`
- Commit sugerido:
  `feat: add foundation login page UI`",Backlog,Normal,HU
HU-018 — Layout del dashboard con sidebar (reutilizable),"# HU-018 — Layout del dashboard con sidebar (reutilizable)

**Como** desarrollador  
**Quiero** un layout reutilizable con sidebar para el dashboard de fundaciones  
**Para** no duplicar código en múltiples páginas del área de administración

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-009 (Logo en navbar)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-016 (Sistema de traducciones configurado)

---

## Contexto / Notas

- Esta HU crea un **layout reutilizable específico para el área de fundaciones** (`/foundations/*`).
- El layout incluye: sidebar de navegación, header superior, y área de contenido principal.
- El sidebar debe ser responsive: oculto en móvil (con menú hamburguesa), visible en desktop.
- Este layout será usado por: perfil de fundación, dashboard principal, gestión de animales, adopciones, etc.
- **IMPORTANTE**: Este layout es específico para usuarios con rol `foundation_user`.
- **NOTA**: La aplicación tendrá múltiples áreas con layouts diferentes:
  - **Fundaciones** (`/foundations/*`) → Este layout (HU-018)
  - **Admin** (`/admin/*`) → Requerirá un layout separado con sidebar diferente (HU futura)
  - **Storefront/External** (`/external/*` o público) → Requerirá un layout diferente, probablemente sin sidebar (HU futura)
- **IMPORTANTE**: Al crear la rama para el PR, usar el nombre: `HU-018 - Layout del dashboard con sidebar`

---

## Diseño

Referencias:
- Diseño: `docs/design/code_profile_foundation_screen.html` (sección sidebar y header)
- Design System: `docs/design/system.md`

Estructura del layout:
- **Sidebar (desktop)**:
  - Logo + ""Amigo Gigante"" en la parte superior
  - Menú de navegación:
    - Dashboard
    - My Foundation (activo)
    - Animals
    - Adoptions
  - Copyright en la parte inferior
  - Ancho fijo: 256px (w-64)
  - Visible solo en desktop (md+)
- **Header superior**:
  - Menú hamburguesa (solo móvil)
  - Logo + ""Amigo Gigante"" (solo móvil)
  - Notificaciones (icono)
  - Perfil de usuario (avatar + nombre + email)
  - Borde inferior
- **Área de contenido**:
  - Scrollable
  - Padding responsive
  - Contenedor con max-width

Reglas:
- Usar tokens del Design System.
- Sidebar debe tener estados activos/inactivos para items del menú.
- El layout debe aceptar `children` para renderizar contenido específico de cada página.

---

## Alcance

Incluye:
- Crear layout reutilizable (`DashboardLayout` o similar)
- Implementar sidebar con navegación
- Implementar header superior
- Implementar área de contenido scrollable
- Hacer el layout responsive (sidebar oculto en móvil, visible en desktop)
- Implementar menú hamburguesa para móvil
- Agregar traducciones para navegación del sidebar
- Crear estructura de rutas que use este layout (ej: `app/dashboard/layout.tsx`)

No incluye:
- Contenido específico de páginas (eso va en HUs posteriores)
- Lógica de autenticación (solo UI)
- Navegación funcional real (los links pueden ser placeholders)
- Gestión de estado de usuario (solo UI estática)

---

## Criterios de aceptación (Given / When / Then)

### 1) Layout reutilizable creado

- **Dado** que necesito un layout para el dashboard
- **Cuando** se crea el componente
- **Entonces** existe un layout reutilizable que acepta `children`
- **Y** puede envolver cualquier contenido de página

---

### 2) Sidebar implementado

- **Dado** que estoy en el dashboard
- **Cuando** visualizo en desktop (≥768px)
- **Entonces** veo el sidebar con:
  - Logo + ""Amigo Gigante"" en la parte superior
  - Menú de navegación (Dashboard, My Foundation, Animals, Adoptions)
  - Copyright en la parte inferior
- **Y** el item activo tiene estilo destacado
- **Y** los items tienen efecto hover

---

### 3) Sidebar responsive

- **Dado** que estoy en el dashboard
- **Cuando** visualizo en móvil (<768px)
- **Entonces** el sidebar está oculto
- **Y** hay un menú hamburguesa en el header
- **Y** al hacer clic en el menú hamburguesa, se muestra un drawer con el sidebar

---

### 4) Header superior implementado

- **Dado** que estoy en el dashboard
- **Cuando** observo el header
- **Entonces** veo:
  - Menú hamburguesa + Logo (solo móvil)
  - Icono de notificaciones
  - Avatar de usuario + nombre + email
- **Y** el header tiene borde inferior
- **Y** está fijo en la parte superior

---

### 5) Área de contenido implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo el área principal
- **Entonces** veo un área scrollable
- **Y** tiene padding responsive
- **Y** acepta contenido dinámico vía `children`

---

### 6) Traducciones implementadas

- **Dado** que se implementa el layout
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/dashboard.json` y `src/messages/en/dashboard.json`
- **Y** no hay textos hardcodeados

---

### 7) Layout usado en estructura de rutas

- **Dado** que se crea el layout
- **Cuando** se revisa la estructura de rutas
- **Entonces** existe `app/dashboard/layout.tsx` (o similar)
- **Y** el layout envuelve todas las páginas del dashboard
- **Y** las páginas hijas renderizan su contenido en el área principal

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Esta HU es solo Presentation**: no toca Domain ni Infrastructure.

### UI
- Usar MUI para componentes base (Drawer, AppBar, List, etc.).
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500`, `accent-500`, `neutral-*`).
- El layout debe ser un componente reutilizable que acepta `children`.

### Responsive
- Breakpoint principal: `md` (768px) para mostrar/ocultar sidebar.
- Usar `hidden md:flex` para sidebar en desktop.
- Usar `Drawer` de MUI para sidebar en móvil.
- Header debe ser responsive (ocultar logo en desktop, mostrar en móvil).

### Traducciones (OBLIGATORIO)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/dashboard.json` (español)
  - `src/messages/en/dashboard.json` (inglés)
- Organizar traducciones por secciones: `sidebar`, `header`, etc.
- **NO hardcodear textos en español o inglés** en componentes.
- Usar `useTranslations('dashboard')` hook de `next-intl`.

### Next.js App Router
- Usar `layout.tsx` en `app/foundations/` (o ruta similar) para aplicar el layout a todas las rutas hijas del área de fundaciones.
- El layout debe aceptar `children: React.ReactNode`.
- **NOTA**: La estructura de rutas debe reflejar los roles:
  - `/foundations/*` → Layout de fundaciones (esta HU)
  - `/admin/*` → Layout de admin (HU futura)
  - `/external/*` o público → Layout de storefront (HU futura)

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

### Git / Branching
- **Al crear la rama para el PR, usar el nombre**: `HU-018 - Layout del dashboard con sidebar`

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/foundations/
└── layout.tsx                    # Layout que envuelve todas las páginas del área de fundaciones

src/presentation/components/layouts/
└── FoundationLayout/
    ├── FoundationLayout.tsx      # Componente principal del layout
    ├── FoundationSidebar.tsx     # Sidebar de navegación (específico para fundaciones)
    ├── FoundationHeader.tsx       # Header superior
    └── index.ts                  # Exportaciones

src/messages/
├── es/
│   └── foundation.json           # Traducciones en español (específicas para área de fundaciones)
└── en/
    └── foundation.json           # Traducciones en inglés
```

**Nota sobre estructura de rutas:**
- Este layout es para el área de fundaciones: `/foundations/*`
- Layouts futuros:
  - Admin: `/admin/*` → `AdminLayout`
  - Storefront/External: `/external/*` o público → `StorefrontLayout` o similar

### Componentes principales:

1. **DashboardLayout** (`src/presentation/components/layouts/DashboardLayout/DashboardLayout.tsx`):
   - Componente principal que estructura el layout
   - Incluye Sidebar, Header y área de contenido
   - Acepta `children` y `activeRoute` (opcional, para marcar item activo)

2. **DashboardSidebar**:
   - Logo + ""Amigo Gigante""
   - Menú de navegación con items
   - Copyright
   - Estados activos/inactivos

3. **DashboardHeader**:
   - Menú hamburguesa (móvil)
   - Logo (móvil)
   - Notificaciones
   - Perfil de usuario

4. **app/foundations/layout.tsx**:
   - Usa `FoundationLayout` para envolver todas las páginas del área de fundaciones
   - Puede pasar props como `activeRoute` basado en la ruta actual
   - Solo accesible para usuarios con rol `foundation_user` (protección vía middleware)

### Estructura de traducciones sugerida:

**src/messages/es/foundation.json:**
```json
{
  ""sidebar"": {
    ""dashboard"": ""Dashboard"",
    ""myFoundation"": ""Mi Fundación"",
    ""animals"": ""Animales"",
    ""adoptions"": ""Adopciones""
  },
  ""header"": {
    ""notifications"": ""Notificaciones"",
    ""menu"": ""Menú""
  },
  ""copyright"": ""© {year} Amigo Gigante""
}
```

**src/messages/en/foundation.json:**
```json
{
  ""sidebar"": {
    ""dashboard"": ""Dashboard"",
    ""myFoundation"": ""My Foundation"",
    ""animals"": ""Animals"",
    ""adoptions"": ""Adoptions""
  },
  ""header"": {
    ""notifications"": ""Notifications"",
    ""menu"": ""Menu""
  },
  ""copyright"": ""© {year} Amigo Gigante""
}
```

**Nota**: Se usarán namespaces diferentes para otras áreas:
- `admin.json` → Para área de administración
- `storefront.json` o `external.json` → Para área de usuarios externos

### Notas de implementación:
- Usar `Drawer` de MUI para el sidebar en móvil.
- El sidebar puede usar `List` y `ListItemButton` de MUI.
- El header puede usar `AppBar` de MUI o un `Box` simple.
- Usar `usePathname` de `next/navigation` para detectar la ruta activa automáticamente.
- El layout debe ser flexible para aceptar diferentes contenidos.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el layout se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- El layout se ve igual al diseño de referencia
- El sidebar es responsive (oculto en móvil, visible en desktop)
- El menú hamburguesa funciona en móvil
- Los items del menú tienen estados activos
- Las traducciones funcionan correctamente
- No hay textos hardcodeados

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Layout reutilizable creado
- [ ] Sidebar implementado con navegación
- [ ] Sidebar responsive (oculto en móvil, visible en desktop)
- [ ] Header superior implementado
- [ ] Área de contenido implementada
- [ ] Layout usado en estructura de rutas (`app/foundations/layout.tsx`)
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/foundation.json`
  - [ ] Textos agregados en `src/messages/en/foundation.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Uso correcto de tokens del Design System
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- [ ] Rama creada con nombre: `HU-018 - Layout del dashboard con sidebar`
- Commit sugerido:
  `feat: add reusable dashboard layout with sidebar`",Backlog,Normal,HU
HU-019 — Perfil de fundación (edición con Formik),"# HU-019 — Perfil de fundación (edición con Formik)

**Como** usuario de una fundación  
**Quiero** editar el perfil de mi fundación con un formulario completo y validado  
**Para** mantener actualizada la información pública de mi organización

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-014 (Formik y Yup configurados)
- HU-016 (Sistema de traducciones configurado)
- HU-018 (Layout del dashboard de fundaciones con sidebar) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU implementa la **página de edición del perfil de fundación**.
- El formulario usa **Formik y Yup** para validación robusta.
- Los campos se mapean a las tablas de BD:
  - `foundations`: name, description, logo_url, city, country
  - `foundation_contacts`: public_email, public_phone, instagram_url, whatsapp_url, address
- Esta HU es **solo UI y validación**: no incluye integración con Supabase (eso va en otra HU).
- El layout del dashboard de fundaciones (HU-018) debe estar implementado antes de esta HU.
- Esta página será accesible en `/foundations/profile` (o ruta similar dentro del área de fundaciones).
- **IMPORTANTE**: Al crear la rama para el PR, usar el nombre: `HU-019 - Perfil de fundación`

---

## Diseño

Referencias:
- Diseño: `docs/design/code_profile_foundation_screen.html`
- Imagen: `docs/design/profile_foundation_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del formulario:
- **Sección Logo**:
  - Imagen del logo actual
  - Botón ""Upload New""
  - Botón ""Remove""
  - Texto de ayuda (tamaño recomendado, formatos)
- **Campos del formulario** (grid de 2 columnas en desktop):
  - Foundation Name (full width)
  - Description (full width, textarea con contador de caracteres)
  - **Divider: Location**
  - Street Address (full width, con icono)
  - City
  - Country (select)
  - **Divider: Public Contact**
  - Public Email (con icono)
  - Public Phone (con icono)
  - **Divider: Social Media**
  - Instagram URL (con icono)
  - WhatsApp URL (con icono)
- **Barra de acciones**:
  - Botón ""Cancel""
  - Botón ""Save Changes"" (con icono)

Reglas:
- Usar tokens del Design System.
- Los campos deben tener validación con Yup.
- El formulario debe mostrar errores de validación.
- El contador de caracteres para description debe actualizarse en tiempo real.
- Los botones de upload/remove del logo son solo UI (sin funcionalidad real).

---

## Alcance

Incluye:
- Crear página `/dashboard/profile` (o similar)
- Implementar formulario completo con todos los campos
- Implementar validación con Formik y Yup
- Implementar sección de logo (solo UI, sin upload real)
- Implementar estados de error y validación
- Implementar contador de caracteres para description
- Hacer el formulario responsive
- Agregar traducciones para todos los textos
- Usar el layout del dashboard (HU-018)

No incluye:
- Integración con Supabase para guardar datos
- Upload real de imágenes (solo UI del botón)
- Lógica de negocio para actualizar fundación
- Navegación funcional (los links pueden ser placeholders)
- Autenticación real (solo UI)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página de perfil creada

- **Dado** que necesito editar el perfil de mi fundación
- **Cuando** navego a la ruta del perfil (`/foundations/profile`)
- **Entonces** veo la página de edición completa
- **Y** la página usa el layout del dashboard de fundaciones (HU-018)
- **Y** la página se carga sin errores

---

### 2) Formulario completo implementado

- **Dado** que estoy en la página de perfil
- **Cuando** observo el formulario
- **Entonces** veo todos los campos:
  - Sección de logo con botones de upload/remove
  - Foundation Name
  - Description (textarea con contador)
  - Street Address (con icono)
  - City
  - Country (select)
  - Public Email (con icono)
  - Public Phone (con icono)
  - Instagram URL (con icono)
  - WhatsApp URL (con icono)
- **Y** los campos tienen labels correctos
- **Y** los campos tienen placeholders apropiados

---

### 3) Validación con Formik y Yup

- **Dado** que estoy en el formulario
- **Cuando** intento enviar sin completar campos requeridos
- **Entonces** se muestran mensajes de error
- **Y** los campos inválidos se marcan visualmente
- **Y** cuando completo los campos correctamente
- **Entonces** el formulario es válido y puede enviarse

---

### 4) Validaciones específicas

- **Dado** que estoy en el formulario
- **Cuando** ingreso datos inválidos:
  - Email inválido
  - URL inválida (Instagram/WhatsApp)
  - Description con más de 500 caracteres
- **Entonces** se muestran mensajes de error específicos
- **Y** el formulario no se puede enviar

---

### 5) Contador de caracteres

- **Dado** que estoy en el campo Description
- **Cuando** escribo texto
- **Entonces** el contador se actualiza en tiempo real
- **Y** muestra ""X/500 characters""
- **Y** cuando supero 500 caracteres, se muestra error

---

### 6) Sección de logo implementada

- **Dado** que estoy en la página de perfil
- **Cuando** observo la sección de logo
- **Entonces** veo:
  - Imagen del logo actual (o placeholder)
  - Botón ""Upload New""
  - Botón ""Remove""
  - Texto de ayuda sobre tamaño y formatos
- **Y** los botones tienen estados hover
- **Nota**: Los botones son solo UI, no tienen funcionalidad real

---

### 7) Layout responsive

- **Dado** que estoy en la página de perfil
- **Cuando** cambio el tamaño de la ventana
- **Entonces** el formulario se adapta:
  - Grid de 2 columnas en desktop
  - 1 columna en móvil/tablet
- **Y** todos los elementos son legibles y accesibles

---

### 8) Traducciones implementadas

- **Dado** que se implementa la página de perfil
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/profile.json` y `src/messages/en/profile.json`
- **Y** los mensajes de validación también están traducidos
- **Y** no hay textos hardcodeados

---

### 9) Estados visuales

- **Dado** que estoy en el formulario
- **Cuando** hago focus en un campo
- **Entonces** el campo muestra estado de focus (borde, ring)
- **Y** cuando hay error, el campo muestra estado de error
- **Y** los botones tienen estados hover y active

---

### 10) Uso del Design System

- **Dado** que se implementa el formulario
- **Cuando** se revisa el código
- **Entonces** se usan tokens del Design System:
  - `brand-500` o `primary.main` para botones primarios
  - `neutral-*` para textos y bordes
  - Tokens de spacing y tipografía
- **Y** no hay colores hardcodeados fuera de los tokens

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Esta HU es solo Presentation**: no toca Domain ni Infrastructure.
- **NO incluye integración con Supabase** (solo UI y validación).

### UI
- Usar MUI para componentes base (TextField, Button, Select, etc.).
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500`, `accent-500`, `neutral-*`).
- Los componentes deben ser reutilizables cuando sea posible.

### Formik y Yup
- Usar `useFormik` hook de Formik.
- Crear schema de validación con Yup.
- Validar campos requeridos: name, description, city, country, public_email.
- Validar formatos: email, URLs (Instagram/WhatsApp).
- Validar longitud: description máximo 500 caracteres.
- Mostrar errores de validación debajo de cada campo.

### Responsive
- Grid de 2 columnas en desktop (md+).
- 1 columna en móvil/tablet.
- Campos full-width cuando corresponde (name, description, address).
- Botones responsive (full-width en móvil, auto en desktop).

### Traducciones (OBLIGATORIO)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/profile.json` (español)
  - `src/messages/en/profile.json` (inglés)
- Incluir traducciones para:
  - Labels de campos
  - Placeholders
  - Mensajes de validación
  - Botones
  - Textos de ayuda
- **NO hardcodear textos en español o inglés** en componentes.
- Usar `useTranslations('profile')` hook de `next-intl`.

### Layout
- **Usar el layout del dashboard de fundaciones creado en HU-018**.
- La página debe estar en `app/foundations/profile/page.tsx` (dentro del área de fundaciones).
- El layout ya proporciona sidebar y header específicos para fundaciones.
- Solo accesible para usuarios con rol `foundation_user` (protección vía middleware).

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Formik y Yup ya están instalados (HU-014).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

### Git / Branching
- **Al crear la rama para el PR, usar el nombre**: `HU-019 - Perfil de fundación`

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/foundations/profile/
└── page.tsx                     # Página de perfil (dentro del área de fundaciones)

src/presentation/components/profile/
├── ProfileForm.tsx              # Formulario principal con Formik
├── LogoSection.tsx              # Sección de logo (upload/remove)
└── ProfileValidation.ts         # Schema de validación con Yup

src/messages/
├── es/
│   └── profile.json             # Traducciones en español
└── en/
    └── profile.json             # Traducciones en inglés
```

### Componentes principales:

1. **ProfilePage** (`src/app/foundations/profile/page.tsx`):
   - Usa el layout del dashboard de fundaciones (HU-018)
   - Renderiza ProfileForm
   - Puede pasar datos iniciales (mock data para UI)

2. **ProfileForm**:
   - Usa `useFormik` para manejo de formulario
   - Usa schema de validación de Yup
   - Renderiza todos los campos
   - Maneja estados de error y validación
   - Muestra mensajes de error

3. **LogoSection**:
   - Muestra imagen del logo (o placeholder)
   - Botones de upload/remove (solo UI)
   - Texto de ayuda

4. **ProfileValidation** (`ProfileValidation.ts`):
   - Schema de Yup con todas las validaciones
   - Mensajes de error traducidos (usar función que obtiene traducciones)

### Schema de validación sugerido:

```typescript
import * as Yup from 'yup';
import { useTranslations } from 'next-intl';

export const getProfileValidationSchema = () => {
  const t = useTranslations('profile.validation');
  
  return Yup.object({
    name: Yup.string()
      .required(t('name.required'))
      .min(3, t('name.minLength')),
    description: Yup.string()
      .required(t('description.required'))
      .max(500, t('description.maxLength')),
    address: Yup.string()
      .required(t('address.required')),
    city: Yup.string()
      .required(t('city.required')),
    country: Yup.string()
      .required(t('country.required')),
    publicEmail: Yup.string()
      .required(t('publicEmail.required'))
      .email(t('publicEmail.invalid')),
    publicPhone: Yup.string()
      .optional(),
    instagramUrl: Yup.string()
      .url(t('instagramUrl.invalid'))
      .optional(),
    whatsappUrl: Yup.string()
      .url(t('whatsappUrl.invalid'))
      .optional(),
  });
};
```

### Estructura de traducciones sugerida:

**src/messages/es/profile.json:**
```json
{
  ""title"": ""Editar Perfil de Fundación"",
  ""subtitle"": ""Actualiza los detalles de tu organización para que los adoptantes puedan contactarte fácilmente."",
  ""logo"": {
    ""title"": ""Logo de la Fundación"",
    ""help"": ""Tamaño recomendado 400x400px. Formatos soportados: JPG, PNG."",
    ""upload"": ""Subir Nuevo"",
    ""remove"": ""Eliminar""
  },
  ""fields"": {
    ""name"": {
      ""label"": ""Nombre de la Fundación"",
      ""placeholder"": ""Ingresa el nombre de tu fundación""
    },
    ""description"": {
      ""label"": ""Descripción"",
      ""placeholder"": ""Describe tu fundación..."",
      ""charCount"": ""{current}/500 caracteres""
    },
    ""address"": {
      ""label"": ""Dirección"",
      ""placeholder"": ""Ingresa la dirección""
    },
    ""city"": {
      ""label"": ""Ciudad"",
      ""placeholder"": ""Ingresa la ciudad""
    },
    ""country"": {
      ""label"": ""País"",
      ""placeholder"": ""Selecciona el país""
    },
    ""publicEmail"": {
      ""label"": ""Email Público"",
      ""placeholder"": ""contacto@fundacion.org""
    },
    ""publicPhone"": {
      ""label"": ""Teléfono Público"",
      ""placeholder"": ""+34 93 123 4567""
    },
    ""instagramUrl"": {
      ""label"": ""URL de Instagram"",
      ""placeholder"": ""https://instagram.com/...""
    },
    ""whatsappUrl"": {
      ""label"": ""URL de WhatsApp"",
      ""placeholder"": ""https://wa.me/...""
    }
  },
  ""sections"": {
    ""location"": ""Ubicación"",
    ""contact"": ""Contacto Público"",
    ""social"": ""Redes Sociales""
  },
  ""buttons"": {
    ""cancel"": ""Cancelar"",
    ""save"": ""Guardar Cambios""
  },
  ""validation"": {
    ""name"": {
      ""required"": ""El nombre de la fundación es requerido"",
      ""minLength"": ""El nombre debe tener al menos 3 caracteres""
    },
    ""description"": {
      ""required"": ""La descripción es requerida"",
      ""maxLength"": ""La descripción no puede exceder 500 caracteres""
    },
    ""address"": {
      ""required"": ""La dirección es requerida""
    },
    ""city"": {
      ""required"": ""La ciudad es requerida""
    },
    ""country"": {
      ""required"": ""El país es requerido""
    },
    ""publicEmail"": {
      ""required"": ""El email público es requerido"",
      ""invalid"": ""Ingresa un email válido""
    },
    ""instagramUrl"": {
      ""invalid"": ""Ingresa una URL válida de Instagram""
    },
    ""whatsappUrl"": {
      ""invalid"": ""Ingresa una URL válida de WhatsApp""
    }
  }
}
```

**src/messages/en/profile.json:**
```json
{
  ""title"": ""Edit Foundation Profile"",
  ""subtitle"": ""Update your organization's details so adopters can reach you easily."",
  ""logo"": {
    ""title"": ""Foundation Logo"",
    ""help"": ""Recommended size 400x400px. Supported formats: JPG, PNG."",
    ""upload"": ""Upload New"",
    ""remove"": ""Remove""
  },
  ""fields"": {
    ""name"": {
      ""label"": ""Foundation Name"",
      ""placeholder"": ""Enter your foundation's name""
    },
    ""description"": {
      ""label"": ""Description"",
      ""placeholder"": ""Describe your foundation..."",
      ""charCount"": ""{current}/500 characters""
    },
    ""address"": {
      ""label"": ""Street Address"",
      ""placeholder"": ""Enter the address""
    },
    ""city"": {
      ""label"": ""City"",
      ""placeholder"": ""Enter the city""
    },
    ""country"": {
      ""label"": ""Country"",
      ""placeholder"": ""Select the country""
    },
    ""publicEmail"": {
      ""label"": ""Public Email"",
      ""placeholder"": ""contact@foundation.org""
    },
    ""publicPhone"": {
      ""label"": ""Public Phone"",
      ""placeholder"": ""+34 93 123 4567""
    },
    ""instagramUrl"": {
      ""label"": ""Instagram URL"",
      ""placeholder"": ""https://instagram.com/...""
    },
    ""whatsappUrl"": {
      ""label"": ""WhatsApp URL"",
      ""placeholder"": ""https://wa.me/...""
    }
  },
  ""sections"": {
    ""location"": ""Location"",
    ""contact"": ""Public Contact"",
    ""social"": ""Social Media""
  },
  ""buttons"": {
    ""cancel"": ""Cancel"",
    ""save"": ""Save Changes""
  },
  ""validation"": {
    ""name"": {
      ""required"": ""Foundation name is required"",
      ""minLength"": ""Name must be at least 3 characters""
    },
    ""description"": {
      ""required"": ""Description is required"",
      ""maxLength"": ""Description cannot exceed 500 characters""
    },
    ""address"": {
      ""required"": ""Address is required""
    },
    ""city"": {
      ""required"": ""City is required""
    },
    ""country"": {
      ""required"": ""Country is required""
    },
    ""publicEmail"": {
      ""required"": ""Public email is required"",
      ""invalid"": ""Please enter a valid email""
    },
    ""instagramUrl"": {
      ""invalid"": ""Please enter a valid Instagram URL""
    },
    ""whatsappUrl"": {
      ""invalid"": ""Please enter a valid WhatsApp URL""
    }
  }
}
```

### Notas de implementación:
- Usar `TextField` de MUI con `error` y `helperText` para mostrar errores.
- El contador de caracteres puede calcularse desde `formik.values.description.length`.
- Los dividers pueden ser `Divider` de MUI o `Typography` con estilo.
- El select de país puede usar `Select` de MUI o un componente personalizado.
- Los iconos pueden ser de `@mui/icons-material`.
- Los botones de upload/remove pueden ser `Button` de MUI (solo UI, sin funcionalidad).

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que la página se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- El formulario se ve igual al diseño de referencia
- La validación funciona correctamente
- Los mensajes de error se muestran apropiadamente
- El contador de caracteres funciona
- El formulario es responsive
- Las traducciones funcionan correctamente
- No hay textos hardcodeados

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de perfil creada y accesible
- [ ] Formulario completo con todos los campos
- [ ] Validación con Formik y Yup implementada
- [ ] Sección de logo implementada (solo UI)
- [ ] Contador de caracteres funcionando
- [ ] Estados visuales de error y validación
- [ ] Layout responsive
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/profile.json`
  - [ ] Textos agregados en `src/messages/en/profile.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Mensajes de validación traducidos
  - [ ] Keys consistentes entre idiomas
- [ ] Uso correcto de tokens del Design System
- [ ] Layout del dashboard de fundaciones (HU-018) usado correctamente
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- [ ] Rama creada con nombre: `HU-019 - Perfil de fundación`
- Commit sugerido:
  `feat: add foundation profile edit form with Formik validation`",Backlog,Normal,HU
HU-020 — Lógica de inicio de sesión con Supabase,"# HU-020 — Lógica de inicio de sesión con Supabase

**Como** usuario de una fundación  
**Quiero** iniciar sesión con mi email y contraseña  
**Para** acceder a mi cuenta y gestionar mi fundación en la plataforma Amigo Gigante

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-017 (Interfaz de login UI implementada)

---

## Contexto / Notas

- Esta HU implementa la **lógica de negocio** del inicio de sesión conectando con Supabase.
- El formulario de login ya está implementado (HU-017), ahora se conecta con el backend.
- El flujo de inicio de sesión debe:
  1. Autenticar al usuario con Supabase Auth (email y password)
  2. Obtener el rol del usuario desde la tabla `profiles`
  3. Crear la sesión con el usuario y su rol
  4. Redirigir al usuario según su rol o a la ruta indicada en `redirectTo`
- Se debe manejar errores comunes (credenciales inválidas, usuario no encontrado, etc.).
- Después del login exitoso, el usuario debe quedar autenticado y ser redirigido.

---

## Alcance

Incluye:
- Crear método `signIn` en `IAuthRepository` y `AuthRepository`
- Crear UseCase `LoginUseCase` en Domain
- Obtener el rol del usuario desde la tabla `profiles` después de autenticar
- Conectar el formulario de login (HU-017) con el UseCase
- Manejo de errores del servidor (mostrar mensajes traducidos al usuario)
- Redirección después del login exitoso (según rol o `redirectTo`)
- Persistencia de sesión en el cliente
- **Agregar traducciones** para mensajes de error y éxito en `src/messages/es/login.json` y `src/messages/en/login.json`

No incluye:
- Validación de formulario (se asume que el formulario ya valida email y password)
- Protección de rutas completa (solo estrategia en HU-013)
- Logout funcional (se hará en otra HU)
- Recuperación de contraseña (se hará en otra HU)
- Refresh automático de tokens (se hará en otra HU)
- Verificación de email (se asume que el usuario ya está verificado)

---

## Criterios de aceptación (Given / When / Then)

### 1) Método signIn en repositorio de autenticación

- **Dado** que se necesita autenticar usuarios
- **Cuando** se implementa el repositorio de autenticación
- **Entonces** existe el método `signIn` en `IAuthRepository` (interfaz en Domain)
- **Y** existe la implementación de `signIn` en `AuthRepository` (Infrastructure)
- **Y** el método recibe `email` y `password`
- **Y** retorna `SignInResult` con `user` y `session`
- **Y** maneja errores de Supabase y los traduce a mensajes legibles

---

### 2) Obtener rol del usuario desde profiles

- **Dado** que el usuario se autentica exitosamente
- **Cuando** se obtiene la sesión
- **Entonces** se consulta la tabla `profiles` para obtener el `role` del usuario
- **Y** el rol se incluye en el `AuthUser` retornado
- **Y** si el usuario no tiene perfil, se maneja el error apropiadamente

---

### 3) UseCase de login implementado

- **Dado** que se necesita la lógica de negocio para login
- **Cuando** se implementa el UseCase
- **Entonces** existe `LoginUseCase` en `domain/usecases/auth/`
- **Y** el UseCase recibe `email` y `password`
- **Y** ejecuta el flujo completo:
  1. Llama a `AuthRepository.signIn()`
  2. Obtiene el rol del usuario desde `profiles`
  3. Retorna `LoginResult` con `user`, `session` y `role`
- **Y** maneja errores y los propaga con mensajes claros

---

### 4) Login funcional desde el formulario

- **Dado** que un usuario completa el formulario de login
- **Cuando** envía el formulario con credenciales válidas
- **Entonces** se autentica el usuario con Supabase
- **Y** se obtiene el rol del usuario desde `profiles`
- **Y** se crea la sesión con el usuario y su rol
- **Y** el usuario queda autenticado en la sesión
- **Y** se muestra un estado de loading durante el proceso

---

### 5) Manejo de errores del servidor

- **Dado** que ocurre un error durante el login
- **Cuando** se intenta iniciar sesión
- **Entonces** se muestra un mensaje de error traducido al usuario
- **Y** los errores comunes se manejan y traducen:
  - Credenciales inválidas → ""Email o contraseña incorrectos""
  - Usuario no encontrado → ""No existe una cuenta con este email""
  - Error de conexión → ""No pudimos conectarnos al servidor. Revisa tu conexión""
  - Email no verificado → ""Por favor verifica tu email antes de iniciar sesión""
  - Rate limiting → ""Demasiados intentos. Espera unos minutos""
- **Y** los mensajes de error están en `src/messages/es/login.json` y `src/messages/en/login.json`
- **Y** se muestran en el formulario sin romper la UI

---

### 6) Redirección después del login exitoso

- **Dado** que el login es exitoso
- **Cuando** se completa la autenticación
- **Entonces** el usuario es redirigido según prioridad:
  1. Si existe `redirectTo` en query params → redirigir a esa ruta
  2. Si el usuario es `foundation_user` → redirigir a `/foundations` (o dashboard de fundaciones)
  3. Si el usuario es `admin` → redirigir a `/admin` (o dashboard de admin)
  4. Si el usuario es `external` → redirigir a `/external` (o dashboard externo)
  5. Por defecto → redirigir a `/` (home)
- **Y** la redirección preserva el locale (ej: `/es/foundations`)

---

### 7) Integración con formulario de login

- **Dado** que el formulario de login ya existe (HU-017)
- **Cuando** se conecta con la lógica de negocio
- **Entonces** el `onSubmit` del formulario llama a `LoginUseCase`
- **Y** se muestra estado de loading durante el login (botón deshabilitado, spinner, etc.)
- **Y** se manejan errores mostrándolos en el formulario
- **Y** se limpia el formulario después de un login exitoso
- **Y** los mensajes de error se muestran de forma clara y accesible

---

### 8) Persistencia de sesión

- **Dado** que el usuario inicia sesión exitosamente
- **Cuando** se crea la sesión
- **Entonces** la sesión se persiste en el cliente (cookies o localStorage según estrategia de Supabase)
- **Y** el usuario permanece autenticado al recargar la página
- **Y** el hook `useAuth` puede obtener la sesión activa

---

## Reglas técnicas

### Arquitectura

- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de inicio de sesión

1. Usuario completa formulario de login (email y password)
2. `onSubmit` de Formik llama a `LoginUseCase` (Presentation)
3. UseCase llama a `AuthRepository.signIn()` (Domain → Infrastructure)
4. `AuthRepository.signIn()` autentica con Supabase Auth
5. `AuthRepository` consulta la tabla `profiles` para obtener el `role` del usuario
6. `AuthRepository` retorna `SignInResult` con `user` (incluyendo `role`) y `session`
7. UseCase retorna `LoginResult` con `user`, `session` y `role`
8. Presentation persiste la sesión (Supabase maneja esto automáticamente)
9. Presentation redirige según rol o `redirectTo`

### Obtener rol del usuario

- Después de autenticar con `supabaseClient.auth.signIn()`, usar el `user.id` para consultar `profiles`.
- Query: `SELECT role FROM profiles WHERE id = user.id`
- Si no existe el perfil, manejar como error (usuario sin perfil configurado).
- El rol debe incluirse en el `AuthUser` retornado.

### Manejo de errores

- Los errores de Supabase deben traducirse a mensajes legibles en español e inglés.
- Usar `AuthApiError` de Supabase para identificar tipos de error.
- Los mensajes de error deben estar en los archivos de traducción.
- Mostrar errores en el formulario sin romper la UI.

### Redirección

- Preservar el locale en la redirección (ej: `/es/foundations`).
- Si `redirectTo` viene con locale, usarlo tal cual.
- Si `redirectTo` no tiene locale, agregar el locale actual.
- Validar que `redirectTo` sea una ruta válida (no permitir redirecciones externas).

### Traducciones

- **TODOS los mensajes visibles en la UI deben estar traducidos** (español e inglés).
- Agregar traducciones en:
  - `src/messages/es/login.json` (español)
  - `src/messages/en/login.json` (inglés)
- Keys sugeridas:
  - `login.form.errors.invalidCredentials`
  - `login.form.errors.userNotFound`
  - `login.form.errors.connectionError`
  - `login.form.errors.emailNotVerified`
  - `login.form.errors.rateLimit`
  - `login.form.errors.generic`
  - `login.success.message`
- Usar `useTranslations` hook de `next-intl` para acceder a traducciones.

### Dependencias / Paquetes

- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/domain/
├── repositories/
│   └── IAuthRepository.ts          # Agregar signIn method
└── usecases/
    └── auth/
        └── LoginUseCase.ts          # Nuevo UseCase

src/infrastructure/
└── repositories/
    └── AuthRepository.ts            # Implementar signIn

src/presentation/
└── components/
    └── login/
        └── LoginForm.tsx            # Conectar con LoginUseCase

src/messages/
├── es/
│   └── login.json                  # Agregar mensajes de error y éxito
└── en/
    └── login.json                  # Agregar mensajes de error y éxito
```

### Flujo de implementación:

1. **Agregar método signIn a IAuthRepository**:
   ```typescript
   export interface SignInParams {
     email: string;
     password: string;
   }
   
   export interface SignInResult {
     user: AuthUser;
     session: AuthSession | null;
   }
   
   export interface IAuthRepository {
     signUp(params: SignUpParams): Promise<SignUpResult>;
     signIn(params: SignInParams): Promise<SignInResult>; // Nuevo
     createProfile(params: CreateProfileParams): Promise<void>;
   }
   ```

2. **Implementar signIn en AuthRepository**:
   - Llamar a `supabaseClient.auth.signInWithPassword({ email, password })`
   - Si hay error, traducirlo y lanzar excepción
   - Consultar `profiles` para obtener el `role` del usuario
   - Mapear `User` y `Session` de Supabase a `AuthUser` y `AuthSession`
   - Incluir el `role` en el `AuthUser` retornado

3. **Crear LoginUseCase**:
   ```typescript
   export interface LoginInput {
     email: string;
     password: string;
   }
   
   export interface LoginResult {
     user: AuthUser;
     session: AuthSession | null;
     role: UserRole;
   }
   
   export class LoginUseCase {
     constructor(private readonly authRepository: IAuthRepository) {}
     
     async execute(input: LoginInput): Promise<LoginResult> {
       // 1. Autenticar con AuthRepository.signIn()
       // 2. Retornar LoginResult con user, session y role
       // 3. Manejar errores y propagarlos
     }
   }
   ```

4. **Conectar formulario con UseCase**:
   - En `LoginForm.tsx`, inyectar `LoginUseCase` vía IoC
   - En `onSubmit` de Formik, llamar a `LoginUseCase.execute()`
   - Mostrar loading durante la ejecución
   - Manejar errores y mostrarlos en el formulario
   - Redirigir después de éxito

5. **Agregar traducciones**:
   - Agregar keys de error en `src/messages/es/login.json` y `src/messages/en/login.json`
   - Usar `useTranslations('login')` en el componente
   - Mostrar mensajes traducidos según el error

6. **Implementar redirección**:
   - Leer `redirectTo` de query params
   - Determinar ruta según rol del usuario
   - Preservar locale en la redirección
   - Usar `useRouter` de Next.js para redirigir

### Notas importantes:

- El método `signIn` debe obtener el rol desde `profiles` después de autenticar.
- Los errores deben traducirse a mensajes legibles en ambos idiomas.
- La sesión se persiste automáticamente por Supabase (cookies).
- El hook `useAuth` debe poder leer la sesión después del login.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que no hay errores de compilación)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones manuales:
- [ ] Login funciona con credenciales válidas
- [ ] Se obtiene el rol correcto del usuario
- [ ] Se muestran errores apropiados para credenciales inválidas
- [ ] Se redirige correctamente después del login
- [ ] La sesión persiste al recargar la página
- [ ] Los mensajes de error están traducidos (español e inglés)
- [ ] El formulario muestra loading durante el proceso
- [ ] Se manejan todos los casos de error comunes

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Método `signIn` implementado en `IAuthRepository` y `AuthRepository`
- [ ] `LoginUseCase` creado y funcional
- [ ] El rol del usuario se obtiene correctamente desde `profiles`
- [ ] Formulario de login conectado con `LoginUseCase`
- [ ] Manejo de errores implementado y traducido
- [ ] Redirección después del login funcional
- [ ] Sesión persiste correctamente
- [ ] **Traducciones incluidas**:
  - [ ] Mensajes de error agregados en `src/messages/es/login.json`
  - [ ] Mensajes de error agregados en `src/messages/en/login.json`
  - [ ] Componente usa `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: implement login logic with Supabase authentication`",Backlog,Normal,HU
HU-021 — Gestión de Perfil (lógica de negocio + persistencia en Supabase),"# HU-021 — Gestión de Perfil (lógica de negocio + persistencia en Supabase)

**Como** usuario de una fundación  
**Quiero** poder editar, guardar y reconsultar la información de mi perfil de fundación  
**Para** mantenerla siempre actualizada y consistente en la plataforma

---

## Dependencias

- Requiere: HU-019 (UI del perfil), HU-014 (Formik/Yup), HU-011 (Supabase), HU-013 (roles/rutas), HU-016 (i18n)
- Requiere análisis de BD: `docs/scripts/db.sql`


---

## Contexto / Notas

- Esta HU implementa la **lógica de negocio** para **consultar y actualizar** el perfil de fundación en Supabase.
- El formulario de edición y perfil de fundación **HU-019** ahora debe conectarse con el backend.
- El formulario debe autocompletarse con lo que ya anteriormente el usuario ha diligenciado.
- El flujo de edición y visualización del perfil de la fundación debe:
  1. Consultar la información actual de la fundación.
  2. Completar los campos que cuenten con información en la UI.
  3. Si un campo no tiene información, debe aparecer vacío (con placeholder).
  4. Al guardar, persistir los cambios en la base de datos.
  5. Al cancelar, confirmar con un modal; si se confirma, descartar cambios y **reconsultar** desde BD.
  6. Confirmar al usuario cuando la información fue almacenada correctamente.
- Se deben manejar errores comunes (no encontrado, sin permisos, conectividad, etc.).
- Después de guardar, debe quedarse en la misma página (no redirigir).

Modelo de datos (según `docs/scripts/db.sql`):
- Tabla `foundations`:
  - Campos relevantes: `name`, `description`, `logo_url`, `city`, `country`
- Tabla `foundation_contacts` (1:1):
  - Campos relevantes: `public_email`, `public_phone`, `instagram_url`, `whatsapp_url`, `address`
- Relación con usuario:
  - `profiles.id` referencia `auth.users(id)`
  - La pertenencia a una fundación se modela con `foundation_members (foundation_id, user_id)`

Reglas de autorización (alto nivel):
- El usuario debe estar autenticado.
- Para editar, el usuario debe ser miembro de la fundación (idealmente `member_role = 'owner'` o `'editor'`).
- La seguridad final debe depender de RLS en Supabase (el middleware solo es “soft”).

---

## Diseño (OBLIGATORIO si hay UI)

Referencias:
- Diseño: `docs/design/profile_foundation_screen.png` y/o `docs/design/code_profile_foundation_screen.html` (referenciados por HU-019)
- Design System: `docs/design/system.md`

Reglas:
- Respetar jerarquía visual del diseño.
- Usar tokens definidos en el Design System (no inventar tamaños/colores).
- Si algo no es claro en el diseño, preguntar antes de asumir.

---
---

## Reglas técnicas

- Arquitectura: ver `docs/01_arquitectura.md`
- Reglas Codex: ver `docs/02_reglas_de_codex.md`

## Alcance

Incluye:
- Crear lógica de **lectura** del perfil de fundación para autocompletar HU-019:
  - Obtener `foundation_id` del usuario autenticado (vía `foundation_members`)
  - Leer `foundations` y `foundation_contacts` y mapear a un modelo de dominio/DTO de “perfil”
- Crear lógica de **actualización** del perfil de fundación:
  - Update parcial de `foundations`
  - Upsert de `foundation_contacts` (si no existe aún, crearla)
- Conectar HU-019 para:
  - cargar datos iniciales (loading + manejo de error)
  - guardar (loading + éxito/error)
  - cancelar (modal de confirmación + reconsultar)
- Modal de confirmación reutilizable (Atomic Design) para “descartar cambios”
- Mensajes traducidos (i18n):
  - éxito al guardar
  - error genérico
  - no autorizado / sin permisos
  - confirmación de descarte
- Mantenerse en la misma pantalla tras guardar (sin redirect)

No incluye:
- Upload real del logo (`logo_url` solo se actualiza como string; el storage/upload va en otra HU)
- Gestión de múltiples fundaciones por usuario (se asume 1 fundación “activa” por perfil para este flujo)
- Permisos granulares avanzados (más allá de membership básico)
- Crear/editar `profiles` o roles (solo se usa identidad del usuario)
- Tests automatizados (si luego se define estrategia de tests, se hará en HU futura)

---

## Criterios de aceptación (Given / When / Then)

### 1) Consulta de perfil (autocompletar)

- **Dado** un usuario autenticado con rol `foundation_user`
- **Cuando** navega a la pantalla de perfil de fundación (HU-019)
- **Entonces** el sistema consulta la fundación del usuario (usando `foundation_members`)
- **Y** obtiene la información de `foundations` y `foundation_contacts`
- **Y** precarga el formulario con los valores existentes
- **Y** si un dato no existe, el campo queda vacío con placeholder (sin romper la UI)

### 2) Guardado de perfil (persistencia en Supabase)

- **Dado** que el usuario modifica campos del formulario
- **Cuando** presiona “Guardar”
- **Entonces** se envían los cambios al UseCase correspondiente
- **Y** se actualiza `foundations` (campos del perfil base)
- **Y** se crea o actualiza `foundation_contacts` (campos de contacto público) mediante upsert
- **Y** se muestra estado de loading durante el guardado
- **Y** al finalizar correctamente se muestra un mensaje de éxito traducido
- **Y** la pantalla no redirige (permanece en el perfil)

### 3) Cancelar con confirmación y reconsulta

- **Dado** que el usuario tiene cambios sin guardar
- **Cuando** presiona “Cancelar”
- **Entonces** se muestra un modal de confirmación (reutilizable)
- **Y** si confirma, se descartan los cambios y se reconsulta la información desde BD
- **Y** si cancela el modal, se mantienen los cambios actuales en el formulario

### 4) Manejo de errores y permisos

- **Dado** que ocurre un error al consultar o guardar
- **Cuando** Supabase retorna error (por ejemplo: sin permisos, not found, conectividad)
- **Entonces** se muestra un mensaje traducido apropiado
- **Y** la UI no se rompe ni queda en un estado inconsistente
- **Y** si el usuario no tiene permisos (no es miembro), se bloquea la operación y se informa

### 5) Reglas de arquitectura cumplidas

- **Dado** que se implementa la lógica
- **Cuando** se revisan imports y capas
- **Entonces** Domain no importa Supabase/React/Next/MUI
- **Y** Presentation consume UseCases vía IoC
- **Y** Infrastructure contiene las implementaciones de repositorios y el wiring
---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.

### UI (si aplica)
- UI con MUI.
- Tailwind se usa para layout/spacing/responsive utilities (si está habilitado).
- No agregar librerías de estilos adicionales sin HU específica.

### Traducciones (OBLIGATORIO si hay UI con texto)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en los archivos correspondientes:
  - `src/messages/es/<namespace>.json` (español)
  - `src/messages/en/<namespace>.json` (inglés)
- Organizar traducciones por namespace:
  - `common.json`: textos comunes (botones, labels, mensajes genéricos)
  - `home.json`: textos de la página home
  - `register.json`: textos de registro
  - `[feature].json`: textos específicos de cada feature
- **NO hardcodear textos en español o inglés** en componentes.
- Usar `useTranslations` hook de `next-intl` para acceder a traducciones.
- Keys descriptivas y anidadas: `home.hero.title`, `register.form.email.label`.
- Mantener consistencia: mismas keys en ambos idiomas.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida (opcional)

- Archivos/carpetas sugeridas:
  - Domain:
    - `src/domain/models/FoundationProfile.ts` (modelo agregado o DTO de perfil)
    - `src/domain/repositories/IFoundationProfileRepository.ts`
    - `src/domain/usecases/foundation/GetFoundationProfileUseCase.ts`
    - `src/domain/usecases/foundation/UpdateFoundationProfileUseCase.ts`
  - Infrastructure:
    - `src/infrastructure/repositories/FoundationProfileRepository.ts` (Supabase)
    - IoC bindings en `src/infrastructure/ioc/...`
  - Presentation:
    - En HU-019, adaptar la página para cargar/guardar con los use cases
    - `src/presentation/components/atoms/ConfirmDialog.tsx` (modal genérico, si no existe)
  - i18n:
    - `src/messages/es/foundations.json`
    - `src/messages/en/foundations.json`

Estrategia técnica (resumen):
- Identidad: usar `supabase.auth.getUser()` para obtener `user.id`.
- Resolver `foundation_id`:
  - `select foundation_id from foundation_members where user_id = :userId limit 1`
- Leer:
  - `foundations` por `foundation_id`
  - `foundation_contacts` por `foundation_id` (puede no existir)
- Guardar:
  - `update foundations set ... where id = :foundationId`
  - `upsert foundation_contacts (foundation_id, ...) on conflict (foundation_id)`

---

## Validación

Comandos mínimos:
- `npm run dev`
- `npm run build`

(Agregar tests si aplica)

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- [ ] **Traducciones incluidas** (si aplica UI con texto):
  - [ ] Textos agregados en `src/messages/es/<namespace>.json`
  - [ ] Textos agregados en `src/messages/en/<namespace>.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- Commit sugerido:
  `<tipo>: <mensaje>`",Backlog,Normal,HU
HU-022 — Gestión de Animales (UI/Diseño),"# HU-022 — Gestión de Animales (UI/Diseño)

**Como** usuario de una fundación  
**Quiero** ver y gestionar la lista de animales de mi fundación en una tabla con filtros y búsqueda  
**Para** tener una vista clara y organizada de todos los animales disponibles para adopción

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-014 (Formik y Yup configurados)
- HU-016 (Sistema de traducciones configurado)
- HU-018 (Layout del dashboard de fundaciones con sidebar) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU implementa la **página de gestión de animales** con **solo UI y diseño**.
- La página muestra una tabla con animales, filtros, búsqueda y paginación.
- **Esta HU es solo UI**: no incluye integración con Supabase (eso va en HU-023).
- Los datos se mostrarán usando **mocks** para simular la funcionalidad.
- El layout del dashboard de fundaciones (HU-018) debe estar implementado antes de esta HU.
- Esta página será accesible en `/foundations/animals` (dentro del área de fundaciones).
- Los campos de la tabla se mapean a la estructura de BD:
  - `animals.id` → ID del animal (formato: #AG-XXXX)
  - `animals.name` → Nombre del animal
  - `animals.species` → Especie (dog/cat/etc)
  - `animals.breed` → Raza
  - `animals.status` → Estado (available/adopted/in_treatment/inactive)
  - `animals.created_at` → Fecha de admisión
  - `animals.cover_image_url` → Imagen de perfil
- **IMPORTANTE**: Al crear la rama para el PR, usar el nombre: `HU-022 - Gestión de Animales (UI)`

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/code_animals_screen.html`
- Imagen: `docs/design/animals_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura de la página:
- **Header de la página**:
  - Título: ""Animal Management""
  - Subtítulo: ""Manage adoption profiles, edit details, and update statuses.""
  - Botón primario: ""+ Add New Animal"" (solo UI, sin funcionalidad)
- **Barra de búsqueda y filtros**:
  - Campo de búsqueda con icono de lupa (placeholder: ""Search by name, ID, or breed..."")
  - Filtro de Status: dropdown con opciones (All, Available, Adopted, Pending, In Treatment, Inactive)
  - Filtro de Species: dropdown con opciones (All, Dog, Cat, Bird, Other)
  - Filtro de Orden: dropdown con opciones (Newest First, Oldest First, Name A-Z, Name Z-A)
- **Tabla de animales**:
  - Columnas: Profile, Name & ID, Species, Admission Date, Status, Actions
  - Filas con datos mockeados (mínimo 5 animales)
  - Cada fila muestra:
    - Imagen circular del animal (cover_image_url)
    - Nombre y ID (formato: #AG-XXXX)
    - Especie y raza (ej: ""Dog (Golden Ret.)"")
    - Fecha de admisión (formato: ""Oct 12, 2023"")
    - Badge de estado con colores según status
    - Botones de acción (Edit, Delete) que aparecen en hover (solo UI)
- **Paginación**:
  - Texto: ""Showing 1 to 5 of 42 results""
  - Controles de paginación: flechas anterior/siguiente, números de página, ellipsis
  - Página actual destacada

Reglas:
- Usar tokens del Design System.
- La tabla debe ser responsive (scroll horizontal en móvil).
- Los filtros deben ser funcionales a nivel de UI (actualizar la tabla con datos mock).
- La búsqueda debe filtrar en tiempo real (client-side con mocks).
- Los badges de estado deben tener colores según el status:
  - Available: verde
  - Adopted: gris/azul claro
  - Pending: amarillo
  - In Treatment: naranja
  - Inactive: rojo/gris oscuro

---

## Alcance

Incluye:
- Crear página `/foundations/animals` (dentro del área de fundaciones)
- Implementar tabla completa con todas las columnas
- Implementar barra de búsqueda funcional (filtrado client-side con mocks)
- Implementar filtros de Status, Species y Sort (funcionales con mocks)
- Implementar paginación (UI funcional con datos mock)
- Crear componente de badge de estado reutilizable
- Crear mock de datos de animales (mínimo 5, idealmente 10-15 para probar paginación)
- Hacer la tabla responsive
- Agregar traducciones para todos los textos
- Usar el layout del dashboard (HU-018)
- Implementar estados hover en las filas de la tabla
- Botones de acción (Edit/Delete) visibles en hover

No incluye:
- Integración con Supabase para cargar datos reales
- Funcionalidad real de crear/editar/eliminar animales
- Upload de imágenes
- Navegación funcional a páginas de detalle/edición
- Lógica de negocio para gestionar animales
- Autenticación real (solo UI)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página de gestión de animales creada

- **Dado** que necesito gestionar animales de mi fundación
- **Cuando** navego a la ruta `/foundations/animals`
- **Entonces** veo la página de gestión completa
- **Y** la página usa el layout del dashboard de fundaciones (HU-018)
- **Y** la página se carga sin errores
- **Y** el sidebar muestra ""Animals"" como activo

---

### 2) Header de la página implementado

- **Dado** que estoy en la página de gestión de animales
- **Cuando** observo el header
- **Entonces** veo:
  - Título ""Animal Management""
  - Subtítulo descriptivo
  - Botón ""+ Add New Animal"" (solo UI, sin funcionalidad)
- **Y** el botón tiene el estilo primario del Design System

---

### 3) Barra de búsqueda y filtros implementada

- **Dado** que estoy en la página de gestión de animales
- **Cuando** observo la barra de búsqueda y filtros
- **Entonces** veo:
  - Campo de búsqueda con icono de lupa
  - Filtro de Status con dropdown
  - Filtro de Species con dropdown
  - Filtro de Sort con dropdown
- **Y** todos los elementos están alineados correctamente
- **Y** los filtros muestran el valor seleccionado

---

### 4) Búsqueda funcional (client-side con mocks)

- **Dado** que estoy en la página de gestión de animales
- **Cuando** escribo en el campo de búsqueda (nombre, ID o raza)
- **Entonces** la tabla se filtra en tiempo real
- **Y** solo se muestran los animales que coinciden con la búsqueda
- **Y** si no hay resultados, se muestra un mensaje apropiado

---

### 5) Filtros funcionales (client-side con mocks)

- **Dado** que estoy en la página de gestión de animales
- **Cuando** selecciono un filtro (Status, Species o Sort)
- **Entonces** la tabla se actualiza según el filtro seleccionado
- **Y** los filtros pueden combinarse (Status + Species + Sort)
- **Y** el filtro ""All"" muestra todos los animales

---

### 6) Tabla de animales implementada

- **Dado** que estoy en la página de gestión de animales
- **Cuando** observo la tabla
- **Entonces** veo todas las columnas:
  - Profile (imagen circular)
  - Name & ID (nombre y ID formateado)
  - Species (especie y raza)
  - Admission Date (fecha formateada)
  - Status (badge con color según estado)
  - Actions (botones Edit/Delete visibles en hover)
- **Y** la tabla muestra datos mockeados (mínimo 5 animales)
- **Y** las filas tienen hover effect

---

### 7) Badges de estado con colores correctos

- **Dado** que estoy en la tabla de animales
- **Cuando** observo los badges de estado
- **Entonces** cada status tiene el color correcto:
  - Available: verde
  - Adopted: gris/azul claro
  - Pending: amarillo
  - In Treatment: naranja
  - Inactive: rojo/gris oscuro
- **Y** los badges son legibles y accesibles

---

### 8) Paginación implementada

- **Dado** que estoy en la página de gestión de animales
- **Cuando** observo la paginación
- **Entonces** veo:
  - Texto con rango de resultados (""Showing 1 to 5 of 42 results"")
  - Botones de navegación (anterior/siguiente)
  - Números de página
  - Página actual destacada
- **Y** la paginación funciona (cambia de página con datos mock)
- **Y** cuando hay muchas páginas, se muestra ellipsis

---

### 9) Layout responsive

- **Dado** que estoy en la página de gestión de animales
- **Cuando** cambio el tamaño de la ventana
- **Entonces** la tabla se adapta:
  - Scroll horizontal en móvil/tablet
  - Tabla completa visible en desktop
- **Y** los filtros se apilan verticalmente en móvil
- **Y** todos los elementos son legibles y accesibles

---

### 10) Traducciones implementadas

- **Dado** que se implementa la página de gestión de animales
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/animals.json` y `src/messages/en/animals.json`
- **Y** los mensajes de estado y filtros también están traducidos
- **Y** no hay textos hardcodeados

---

### 11) Estados visuales y hover

- **Dado** que estoy en la tabla de animales
- **Cuando** paso el mouse sobre una fila
- **Entonces** la fila muestra efecto hover
- **Y** los botones de acción (Edit/Delete) aparecen
- **Y** los botones tienen estados hover y active

---

### 12) Mock de datos completo

- **Dado** que se implementa la página
- **Cuando** se revisa el mock de datos
- **Entonces** existe un archivo de mock con al menos 10-15 animales
- **Y** los animales tienen todos los campos necesarios:
  - id, name, species, breed, sex, age_months, size, status, cover_image_url, created_at
- **Y** los datos cubren diferentes estados y especies
- **Y** los IDs siguen el formato #AG-XXXX

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Esta HU es solo Presentation**: no toca Domain ni Infrastructure.
- **NO incluye integración con Supabase** (solo UI y mocks).

### UI
- Usar MUI para componentes base (Table, TextField, Select, Button, etc.).
- Tailwind se usa para layout/spacing/responsive utilities.
- Usar tokens del Design System (`brand-500`, `accent-500`, `neutral-*`).
- Los componentes deben ser reutilizables cuando sea posible.

### Tabla
- Usar `Table` de MUI para la estructura base.
- Implementar scroll horizontal en móvil.
- Usar `TableHead` y `TableBody` de MUI.
- Las filas deben tener hover effect.

### Filtros y búsqueda
- Implementar filtrado client-side con datos mock.
- La búsqueda debe filtrar por nombre, ID o raza.
- Los filtros deben poder combinarse.
- Usar `TextField` de MUI para búsqueda.
- Usar `Select` de MUI para filtros.

### Paginación
- Usar `Pagination` de MUI o componente personalizado.
- Implementar lógica de paginación client-side con datos mock.
- Mostrar rango de resultados.
- Manejar ellipsis cuando hay muchas páginas.

### Mock de datos
- Crear archivo `src/infrastructure/mocks/animals-management.mock.ts`.
- Incluir al menos 10-15 animales con datos variados.
- Los datos deben cubrir diferentes estados, especies y razas.
- Los IDs deben seguir el formato #AG-XXXX (ej: #AG-2309).

### Responsive
- Tabla con scroll horizontal en móvil/tablet.
- Filtros apilados verticalmente en móvil.
- Header responsive (botón full-width en móvil si es necesario).

### Traducciones (OBLIGATORIO)
- **TODOS los textos visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/animals.json` (español)
  - `src/messages/en/animals.json` (inglés)
- Incluir traducciones para:
  - Títulos y subtítulos
  - Labels de filtros
  - Opciones de filtros
  - Headers de tabla
  - Estados de animales
  - Mensajes de búsqueda sin resultados
  - Textos de paginación
- **NO hardcodear textos en español o inglés** en componentes.
- Usar `useTranslations('animals')` hook de `next-intl`.

### Layout
- **Usar el layout del dashboard de fundaciones creado en HU-018**.
- La página debe estar en `app/[locale]/foundations/animals/page.tsx`.
- El layout ya proporciona sidebar y header específicos para fundaciones.
- Solo accesible para usuarios con rol `foundation_user` (protección vía middleware).

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- MUI y Tailwind ya están instalados.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

### Git / Branching
- **Al crear la rama para el PR, usar el nombre**: `HU-022 - Gestión de Animales (UI)`

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/[locale]/foundations/animals/
└── page.tsx                        # Página de gestión de animales

src/presentation/components/animals/
├── AnimalsManagementPage.tsx      # Componente principal de la página
├── AnimalsTable.tsx                # Tabla de animales
├── AnimalsSearchBar.tsx            # Barra de búsqueda y filtros
├── AnimalStatusBadge.tsx           # Badge de estado reutilizable
└── AnimalsPagination.tsx           # Componente de paginación

src/infrastructure/mocks/
└── animals-management.mock.ts      # Mock de datos de animales

src/messages/
├── es/
│   └── animals.json                # Traducciones en español
└── en/
    └── animals.json                 # Traducciones en inglés
```

### Componentes principales:

1. **AnimalsManagementPage** (`src/presentation/components/animals/AnimalsManagementPage.tsx`):
   - Componente principal que estructura la página
   - Maneja el estado de búsqueda, filtros y paginación
   - Filtra y pagina los datos mock en el cliente
   - Renderiza header, barra de búsqueda, tabla y paginación

2. **AnimalsTable**:
   - Tabla con todas las columnas
   - Renderiza filas con datos de animales
   - Maneja hover effects
   - Muestra botones de acción en hover

3. **AnimalsSearchBar**:
   - Campo de búsqueda
   - Filtros de Status, Species y Sort
   - Maneja cambios y actualiza el estado del filtrado

4. **AnimalStatusBadge**:
   - Badge reutilizable para estados
   - Colores según el status
   - Traducido

5. **AnimalsPagination**:
   - Componente de paginación
   - Muestra rango de resultados
   - Maneja navegación de páginas

### Estructura de datos mock sugerida:

```typescript
export interface AnimalManagement {
  id: number;
  name: string;
  species: string; // 'dog', 'cat', 'bird', etc.
  breed: string;
  sex: 'male' | 'female' | 'unknown';
  age_months: number | null;
  size: 'small' | 'medium' | 'large' | 'unknown';
  status: 'available' | 'adopted' | 'in_treatment' | 'inactive';
  cover_image_url: string | null;
  created_at: string; // ISO date string
}

export const mockAnimals: AnimalManagement[] = [
  {
    id: 2309,
    name: ""Buddy"",
    species: ""dog"",
    breed: ""Golden Retriever"",
    sex: ""male"",
    age_months: 24,
    size: ""large"",
    status: ""available"",
    cover_image_url: ""https://..."",
    created_at: ""2023-10-12T00:00:00Z""
  },
  // ... más animales
];
```

### Estructura de traducciones sugerida:

**src/messages/es/animals.json:**
```json
{
  ""title"": ""Gestión de Animales"",
  ""subtitle"": ""Gestiona perfiles de adopción, edita detalles y actualiza estados."",
  ""addButton"": ""Agregar Nuevo Animal"",
  ""search"": {
    ""placeholder"": ""Buscar por nombre, ID o raza..."",
    ""noResults"": ""No se encontraron animales""
  },
  ""filters"": {
    ""status"": {
      ""label"": ""Estado"",
      ""all"": ""Todos"",
      ""available"": ""Disponible"",
      ""adopted"": ""Adoptado"",
      ""pending"": ""Pendiente"",
      ""in_treatment"": ""En Tratamiento"",
      ""inactive"": ""Inactivo""
    },
    ""species"": {
      ""label"": ""Especie"",
      ""all"": ""Todas"",
      ""dog"": ""Perro"",
      ""cat"": ""Gato"",
      ""bird"": ""Ave"",
      ""other"": ""Otro""
    },
    ""sort"": {
      ""label"": ""Ordenar"",
      ""newest"": ""Más Recientes"",
      ""oldest"": ""Más Antiguos"",
      ""nameAsc"": ""Nombre A-Z"",
      ""nameDesc"": ""Nombre Z-A""
    }
  },
  ""table"": {
    ""columns"": {
      ""profile"": ""Perfil"",
      ""nameId"": ""Nombre e ID"",
      ""species"": ""Especie"",
      ""admissionDate"": ""Fecha de Admisión"",
      ""status"": ""Estado"",
      ""actions"": ""Acciones""
    },
    ""actions"": {
      ""edit"": ""Editar"",
      ""delete"": ""Eliminar""
    }
  },
  ""pagination"": {
    ""showing"": ""Mostrando {from} a {to} de {total} resultados""
  }
}
```

**src/messages/en/animals.json:**
```json
{
  ""title"": ""Animal Management"",
  ""subtitle"": ""Manage adoption profiles, edit details, and update statuses."",
  ""addButton"": ""Add New Animal"",
  ""search"": {
    ""placeholder"": ""Search by name, ID, or breed..."",
    ""noResults"": ""No animals found""
  },
  ""filters"": {
    ""status"": {
      ""label"": ""Status"",
      ""all"": ""All"",
      ""available"": ""Available"",
      ""adopted"": ""Adopted"",
      ""pending"": ""Pending"",
      ""in_treatment"": ""In Treatment"",
      ""inactive"": ""Inactive""
    },
    ""species"": {
      ""label"": ""Species"",
      ""all"": ""All"",
      ""dog"": ""Dog"",
      ""cat"": ""Cat"",
      ""bird"": ""Bird"",
      ""other"": ""Other""
    },
    ""sort"": {
      ""label"": ""Sort"",
      ""newest"": ""Newest First"",
      ""oldest"": ""Oldest First"",
      ""nameAsc"": ""Name A-Z"",
      ""nameDesc"": ""Name Z-A""
    }
  },
  ""table"": {
    ""columns"": {
      ""profile"": ""Profile"",
      ""nameId"": ""Name & ID"",
      ""species"": ""Species"",
      ""admissionDate"": ""Admission Date"",
      ""status"": ""Status"",
      ""actions"": ""Actions""
    },
    ""actions"": {
      ""edit"": ""Edit"",
      ""delete"": ""Delete""
    }
  },
  ""pagination"": {
    ""showing"": ""Showing {from} to {to} of {total} results""
  }
}
```

### Notas de implementación:
- Usar `Table`, `TableHead`, `TableBody`, `TableRow`, `TableCell` de MUI.
- Implementar filtrado client-side con `useMemo` o `useState`.
- La paginación puede usar `Pagination` de MUI o componente personalizado.
- Los badges pueden usar `Chip` de MUI con colores personalizados.
- Los iconos pueden ser de `@mui/icons-material` o Material Symbols.
- El formato de fecha puede usar `Intl.DateTimeFormat` o librería de fechas.

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que la página se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones visuales:
- La página se ve igual al diseño de referencia
- La búsqueda filtra correctamente
- Los filtros funcionan y se pueden combinar
- La paginación funciona
- La tabla es responsive
- Los badges tienen los colores correctos
- Las traducciones funcionan correctamente
- No hay textos hardcodeados
- Los hover effects funcionan

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de gestión de animales creada y accesible
- [ ] Tabla completa con todas las columnas
- [ ] Búsqueda funcional (client-side con mocks)
- [ ] Filtros funcionales (client-side con mocks)
- [ ] Paginación implementada y funcional
- [ ] Badges de estado con colores correctos
- [ ] Mock de datos completo (mínimo 10-15 animales)
- [ ] Layout responsive
- [ ] Estados visuales y hover implementados
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/animals.json`
  - [ ] Textos agregados en `src/messages/en/animals.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Uso correcto de tokens del Design System
- [ ] Layout del dashboard de fundaciones (HU-018) usado correctamente
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- [ ] Rama creada con nombre: `HU-022 - Gestión de Animales (UI)`
- Commit sugerido:
  `feat: add animals management page UI with table, filters and pagination`",Backlog,Normal,HU
HU-023 — Gestión de Animales (Funcionalidad con Supabase),"# HU-023 — Gestión de Animales (Funcionalidad con Supabase)

**Como** usuario de una fundación  
**Quiero** cargar, filtrar y gestionar animales desde la base de datos  
**Para** tener datos reales y persistentes de los animales de mi fundación

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-018 (Layout del dashboard de fundaciones con sidebar)
- HU-022 (UI de gestión de animales implementada) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU implementa la **lógica de negocio** para gestionar animales conectando con Supabase.
- La UI ya está implementada (HU-022), ahora se conecta con el backend.
- El flujo debe:
  1. Cargar animales de la fundación del usuario autenticado desde Supabase
  2. Filtrar y buscar animales en el servidor (o cliente según estrategia)
  3. Paginar resultados desde la base de datos
  4. Permitir editar y eliminar animales (opcional, puede ser HU futura)
- Se deben manejar errores comunes (no encontrado, sin permisos, conectividad, etc.).
- Los datos deben mapearse correctamente desde la estructura de BD a los modelos de dominio.

Modelo de datos (según `docs/scripts/db.sql`):
- Tabla `animals`:
  - Campos: `id`, `foundation_id`, `name`, `species`, `breed`, `sex`, `age_months`, `size`, `status`, `description`, `cover_image_url`, `is_published`, `created_at`
- Tabla `animal_photos` (relación 1:N):
  - Campos: `id`, `animal_id`, `url`, `sort_order`
- Relación con fundación:
  - `animals.foundation_id` referencia `foundations(id)`
  - El usuario debe ser miembro de la fundación (vía `foundation_members`)

Reglas de autorización (alto nivel):
- El usuario debe estar autenticado.
- Para ver animales, el usuario debe ser miembro de la fundación.
- Solo puede ver/editar animales de su propia fundación.
- La seguridad final debe depender de RLS en Supabase (el middleware solo es ""soft"").

Mapeo de datos:
- `animals.id` → ID numérico (formatear como #AG-XXXX para UI)
- `animals.species` → Especie (dog/cat/bird/etc)
- `animals.status` → Estado (available/adopted/in_treatment/inactive)
- `animals.created_at` → Fecha de admisión (formatear para UI)
- `animals.cover_image_url` → Imagen de perfil (usar primera foto de `animal_photos` si no hay cover_image_url)

---

## Alcance

Incluye:
- Crear lógica de **lectura** de animales de la fundación:
  - Obtener `foundation_id` del usuario autenticado (vía `foundation_members`)
  - Leer `animals` filtrados por `foundation_id`
  - Incluir `cover_image_url` o primera foto de `animal_photos`
  - Mapear a modelo de dominio/DTO
- Crear lógica de **filtrado y búsqueda**:
  - Filtrar por status, species en la query de Supabase
  - Buscar por nombre, ID o raza (usar `ilike` o `textSearch` de Supabase)
  - Ordenar por fecha, nombre, etc.
- Crear lógica de **paginación**:
  - Implementar paginación server-side con Supabase (usar `range()`)
  - Calcular total de resultados para mostrar en paginación
- Conectar HU-022 para:
  - Cargar datos iniciales (loading + manejo de error)
  - Aplicar filtros y búsqueda (loading + actualización de tabla)
  - Paginar resultados (loading + actualización de tabla)
- Mensajes traducidos (i18n):
  - Error al cargar animales
  - Error genérico
  - No autorizado / sin permisos
  - Sin animales encontrados
- Reemplazar mocks con datos reales de Supabase

No incluye:
- Crear/editar/eliminar animales (eso va en HUs futuras)
- Upload real de imágenes (solo lectura de URLs existentes)
- Gestión de múltiples fundaciones por usuario (se asume 1 fundación ""activa"" por perfil)
- Permisos granulares avanzados (más allá de membership básico)
- Tests automatizados (si luego se define estrategia de tests, se hará en HU futura)
- Optimización avanzada de queries (indexes, etc. se asume que ya están en BD)

---

## Criterios de aceptación (Given / When / Then)

### 1) Consulta de animales de la fundación

- **Dado** un usuario autenticado con rol `foundation_user`
- **Cuando** navega a la pantalla de gestión de animales (HU-022)
- **Entonces** el sistema consulta la fundación del usuario (usando `foundation_members`)
- **Y** obtiene los animales de esa fundación desde `animals`
- **Y** muestra los animales en la tabla
- **Y** si no hay animales, muestra mensaje apropiado

---

### 2) Filtrado por status y species

- **Dado** que el usuario selecciona un filtro (Status o Species)
- **Cuando** aplica el filtro
- **Entonces** se envía la query a Supabase con el filtro correspondiente
- **Y** la tabla se actualiza con los resultados filtrados
- **Y** se muestra estado de loading durante la consulta
- **Y** los filtros pueden combinarse (Status + Species)

---

### 3) Búsqueda por nombre, ID o raza

- **Dado** que el usuario escribe en el campo de búsqueda
- **Cuando** busca por nombre, ID o raza
- **Entonces** se envía la query a Supabase con el término de búsqueda
- **Y** la tabla se actualiza con los resultados
- **Y** la búsqueda es case-insensitive
- **Y** si no hay resultados, se muestra mensaje apropiado

---

### 4) Ordenamiento de resultados

- **Dado** que el usuario selecciona un orden (Newest First, Oldest First, Name A-Z, etc.)
- **Cuando** aplica el ordenamiento
- **Entonces** se envía la query a Supabase con el `order` correspondiente
- **Y** la tabla se actualiza con los resultados ordenados

---

### 5) Paginación server-side

- **Dado** que hay más animales de los que caben en una página
- **Cuando** el usuario cambia de página
- **Entonces** se envía una nueva query a Supabase con el rango correspondiente
- **Y** se muestra el total de resultados correctamente
- **Y** la tabla se actualiza con los animales de la página seleccionada
- **Y** se muestra estado de loading durante la consulta

---

### 6) Mapeo correcto de datos

- **Dado** que se cargan animales desde Supabase
- **Cuando** se mapean a la UI
- **Entonces** los campos se mapean correctamente:
  - `id` → formateado como #AG-XXXX
  - `species` → traducido y mostrado correctamente
  - `breed` → mostrado junto con species (ej: ""Dog (Golden Ret.)"")
  - `status` → traducido y mostrado con badge correcto
  - `created_at` → formateado como fecha legible (ej: ""Oct 12, 2023"")
  - `cover_image_url` → usado para imagen de perfil (o primera foto de `animal_photos`)
- **Y** los datos se muestran correctamente en la tabla

---

### 7) Manejo de errores y permisos

- **Dado** que ocurre un error al consultar o filtrar
- **Cuando** Supabase retorna error (por ejemplo: sin permisos, not found, conectividad)
- **Entonces** se muestra un mensaje traducido apropiado
- **Y** la UI no se rompe ni queda en un estado inconsistente
- **Y** si el usuario no tiene permisos (no es miembro), se bloquea la operación y se informa

---

### 8) Estados de loading

- **Dado** que se realiza una operación (cargar, filtrar, buscar, paginar)
- **Cuando** se está ejecutando la query
- **Entonces** se muestra un estado de loading (spinner, skeleton, etc.)
- **Y** la UI indica que se está cargando
- **Y** al finalizar, el estado de loading desaparece

---

### 9) Reglas de arquitectura cumplidas

- **Dado** que se implementa la lógica
- **Cuando** se revisan imports y capas
- **Entonces** Domain no importa Supabase/React/Next/MUI
- **Y** Presentation consume UseCases vía IoC
- **Y** Infrastructure contiene las implementaciones de repositorios y el wiring

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de consulta de animales

1. Usuario navega a `/foundations/animals` (Presentation)
2. `AnimalsManagementPage` llama a `GetAnimalsUseCase` (Presentation → Domain)
3. UseCase obtiene `foundation_id` del usuario (vía `GetSessionUseCase` o similar)
4. UseCase llama a `AnimalRepository.getAnimals()` (Domain → Infrastructure)
5. `AnimalRepository.getAnimals()` consulta Supabase con filtros
6. `AnimalRepository` retorna lista de animales mapeados
7. UseCase retorna lista de animales
8. Presentation muestra animales en la tabla

### Obtener foundation_id del usuario

- Usar `supabaseClient.auth.getUser()` para obtener `user.id`.
- Query: `SELECT foundation_id FROM foundation_members WHERE user_id = :userId LIMIT 1`
- Si no existe membership, manejar como error (usuario sin fundación).

### Consulta de animales

- Query base: `SELECT * FROM animals WHERE foundation_id = :foundationId`
- Aplicar filtros:
  - Status: `AND status = :status` (si no es ""all"")
  - Species: `AND species = :species` (si no es ""all"")
- Aplicar búsqueda:
  - `AND (name ILIKE :search OR breed ILIKE :search OR id::text ILIKE :search)`
- Aplicar ordenamiento:
  - `ORDER BY created_at DESC` (newest first)
  - `ORDER BY created_at ASC` (oldest first)
  - `ORDER BY name ASC` (name A-Z)
  - `ORDER BY name DESC` (name Z-A)
- Aplicar paginación:
  - `LIMIT :pageSize OFFSET :offset`
- Obtener total:
  - Query separada con `COUNT(*)` o usar `count` de Supabase

### Mapeo de datos

- Crear modelo de dominio `AnimalManagement` o extender `Animal` existente.
- Mapear campos de BD a modelo:
  - `id` → `id` (formatear para UI)
  - `name` → `name`
  - `species` → `species`
  - `breed` → `breed`
  - `status` → `status`
  - `created_at` → `admissionDate` (formatear)
  - `cover_image_url` → `imageUrl` (o primera foto de `animal_photos`)

### Imagen de perfil

- Si `cover_image_url` existe, usarla.
- Si no, consultar `animal_photos` para obtener la primera foto (`sort_order = 0` o `MIN(sort_order)`).
- Si no hay fotos, usar placeholder o imagen por defecto.

### Manejo de errores

- Los errores de Supabase deben traducirse a mensajes legibles en español e inglés.
- Usar `PostgrestError` de Supabase para identificar tipos de error.
- Los mensajes de error deben estar en los archivos de traducción.
- Mostrar errores en la UI sin romper el layout.

### Traducciones
- **TODOS los mensajes visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/animals.json` (español)
  - `src/messages/en/animals.json` (inglés)
- Incluir traducciones para:
  - Mensajes de error
  - Estados de loading
  - Mensajes de ""sin resultados""
  - Nombres de especies y estados
- Usar `useTranslations` hook de `next-intl` para acceder a traducciones.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Supabase ya está configurado (HU-011).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/domain/
├── models/
│   └── AnimalManagement.ts          # Modelo de dominio para gestión (o extender Animal)
├── repositories/
│   └── IAnimalRepository.ts         # Agregar métodos: getAnimals, getAnimalsCount
└── usecases/
    └── animals/
        ├── GetAnimalsUseCase.ts     # UseCase para obtener animales con filtros
        └── GetAnimalsCountUseCase.ts # UseCase para obtener total (opcional)

src/infrastructure/
├── repositories/
│   └── AnimalRepository.ts           # Implementar getAnimals, getAnimalsCount
└── ioc/
    └── ...                          # Agregar bindings de nuevos use cases

src/presentation/
└── components/
    └── animals/
        └── AnimalsManagementPage.tsx # Conectar con GetAnimalsUseCase (reemplazar mocks)
```

### Flujo de implementación:

1. **Extender IAnimalRepository**:
   ```typescript
   export interface GetAnimalsParams {
     foundationId: string;
     filters?: {
       status?: string;
       species?: string;
       search?: string;
       sort?: 'newest' | 'oldest' | 'nameAsc' | 'nameDesc';
     };
     pagination?: {
       page: number;
       pageSize: number;
     };
   }
   
   export interface GetAnimalsResult {
     animals: AnimalManagement[];
     total: number;
   }
   
   export interface IAnimalRepository {
     getHomeAnimals(): Promise<HomeAnimals>;
     getAnimals(params: GetAnimalsParams): Promise<GetAnimalsResult>; // Nuevo
     getAnimalsCount(params: GetAnimalsParams): Promise<number>; // Nuevo (opcional)
   }
   ```

2. **Implementar getAnimals en AnimalRepository**:
   - Obtener `foundation_id` del usuario (o recibirlo como parámetro)
   - Construir query de Supabase con filtros
   - Aplicar búsqueda, ordenamiento y paginación
   - Obtener total de resultados
   - Mapear resultados a modelo de dominio
   - Manejar errores y traducirlos

3. **Crear GetAnimalsUseCase**:
   ```typescript
   export interface GetAnimalsInput {
     filters?: {
       status?: string;
       species?: string;
       search?: string;
       sort?: 'newest' | 'oldest' | 'nameAsc' | 'nameDesc';
     };
     pagination?: {
       page: number;
       pageSize: number;
     };
   }
   
   export class GetAnimalsUseCase {
     constructor(
       private readonly animalRepository: IAnimalRepository,
       private readonly authRepository: IAuthRepository // Para obtener foundation_id
     ) {}
     
     async execute(input: GetAnimalsInput): Promise<GetAnimalsResult> {
       // 1. Obtener usuario autenticado
       // 2. Obtener foundation_id del usuario
       // 3. Llamar a animalRepository.getAnimals() con foundation_id y filtros
       // 4. Retornar resultados
     }
   }
   ```

4. **Conectar AnimalsManagementPage con UseCase**:
   - Inyectar `GetAnimalsUseCase` vía IoC
   - Reemplazar mocks con llamadas al UseCase
   - Manejar estados de loading
   - Manejar errores y mostrarlos en la UI
   - Actualizar tabla cuando cambian filtros/búsqueda/paginación

5. **Agregar traducciones**:
   - Agregar mensajes de error en `src/messages/es/animals.json` y `src/messages/en/animals.json`
   - Agregar traducciones de especies y estados
   - Usar `useTranslations('animals')` en componentes

### Estrategia técnica (resumen):
- Identidad: usar `supabase.auth.getUser()` para obtener `user.id`.
- Resolver `foundation_id`:
  - `SELECT foundation_id FROM foundation_members WHERE user_id = :userId LIMIT 1`
- Leer animales:
  - `SELECT * FROM animals WHERE foundation_id = :foundationId [filtros] [orden] [paginación]`
- Obtener total:
  - `SELECT COUNT(*) FROM animals WHERE foundation_id = :foundationId [filtros]`
- Imagen de perfil:
  - Si `cover_image_url` existe, usarla
  - Si no, `SELECT url FROM animal_photos WHERE animal_id = :animalId ORDER BY sort_order LIMIT 1`

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que no hay errores de compilación)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones manuales:
- [ ] Los animales se cargan correctamente desde Supabase
- [ ] Los filtros funcionan correctamente
- [ ] La búsqueda funciona correctamente
- [ ] El ordenamiento funciona correctamente
- [ ] La paginación funciona correctamente
- [ ] Se muestran estados de loading apropiados
- [ ] Se manejan errores correctamente
- [ ] Los mensajes de error están traducidos
- [ ] Los datos se mapean correctamente a la UI
- [ ] Las imágenes se muestran correctamente

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Método `getAnimals` implementado en `IAnimalRepository` y `AnimalRepository`
- [ ] `GetAnimalsUseCase` creado y funcional
- [ ] `AnimalsManagementPage` conectado con `GetAnimalsUseCase` (mocks reemplazados)
- [ ] Filtrado, búsqueda y ordenamiento funcionan con Supabase
- [ ] Paginación server-side implementada
- [ ] Manejo de errores implementado y traducido
- [ ] Estados de loading implementados
- [ ] Mapeo de datos correcto (formato de ID, fechas, imágenes)
- [ ] **Traducciones incluidas**:
  - [ ] Mensajes de error agregados en `src/messages/es/animals.json`
  - [ ] Mensajes de error agregados en `src/messages/en/animals.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: connect animals management page with Supabase backend`",Backlog,Normal,HU
HU-024 — Agregar Animal a la Fundación,"# HU-024 — Agregar Animal a la Fundación

**Como** usuario de una fundación  
**Quiero** agregar un nuevo animal a mi fundación con todos sus detalles e imágenes  
**Para** publicarlo en el catálogo de adopción y gestionarlo desde el dashboard

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-014 (Formik y Yup configurados)
- HU-016 (Sistema de traducciones configurado)
- HU-018 (Layout del dashboard de fundaciones con sidebar) - **REQUERIDO**
- HU-022 (UI de gestión de animales implementada) - **REQUERIDO**
- HU-023 (Funcionalidad de gestión de animales con Supabase) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU implementa la funcionalidad completa para **agregar un nuevo animal** a la fundación del usuario autenticado.
- Incluye UI del formulario, validaciones, creación en Supabase y subida de imágenes.
- El formulario debe seguir el diseño exacto de `docs/design/add_animals_screen.png` y `docs/design/add_animals_code.html`.
- Después de crear el animal, el usuario debe poder verlo en la lista de animales (HU-022/HU-023).
- El flujo completo:
  1. Usuario navega a `/foundations/animals/add` (o desde botón ""+ Add New Animal"")
  2. Completa el formulario con datos del animal
  3. Sube imágenes (mínimo 1, recomendado 3+)
  4. Guarda como borrador o publica directamente
  5. Se crea el animal en Supabase con `foundation_id` del usuario
  6. Se suben las imágenes a `animal_photos` con `sort_order`
  7. Se redirige a la lista de animales donde aparece el nuevo animal

Modelo de datos (según `docs/scripts/db.sql`):
- Tabla `animals`:
  - Campos requeridos: `foundation_id`, `name`, `species`, `sex`
  - Campos opcionales: `breed`, `age_months`, `size`, `description`, `cover_image_url`, `status`, `is_published`
  - `status` por defecto: `'available'`
  - `is_published` por defecto: `false`
- Tabla `animal_photos` (relación 1:N):
  - Campos: `animal_id`, `url`, `sort_order`
  - La primera imagen (sort_order = 0) puede usarse como `cover_image_url`

Reglas de negocio:
- El usuario debe estar autenticado y ser miembro de una fundación.
- `foundation_id` se obtiene automáticamente del usuario autenticado (vía `foundation_members`).
- Campos requeridos: `name`, `age`, `gender`, `description`, `status`.
- `age` se almacena como `age_months` en la BD (convertir de años/meses según unidad seleccionada).
- `species` debe ser una de: `dog`, `cat`, `bird`, `other`.
- `status` debe ser una de: `available`, `adopted`, `in_treatment`, `inactive`.
- `sex` debe ser: `male`, `female`, `unknown`.
- `size` debe ser: `small`, `medium`, `large`, `unknown`.
- Mínimo 1 imagen, máximo 10 imágenes por animal.
- Tamaño máximo de imagen: 5MB.
- Formatos permitidos: SVG, PNG, JPG, GIF.
- Si se publica (`is_published = true`), el animal aparece en el catálogo público.
- Si se guarda como borrador (`is_published = false`), solo es visible en el dashboard.

Mapeo de datos del formulario a BD:
- `name` → `animals.name`
- `breed` → `animals.breed` (opcional)
- `age` + `ageUnit` → `animals.age_months` (convertir: años * 12 o meses)
- `gender` → `animals.sex` (mapear: Male → male, Female → female)
- `size` → `animals.size` (mapear según opciones del select)
- `species` → `animals.species` (mapear según opciones del select)
- `description` → `animals.description`
- `status` → `animals.status` (mapear según opciones del select)
- `currentLocation` → No se almacena en BD (solo para referencia, puede ser campo futuro)
- `healthStatus` (checkboxes) → No se almacena en BD (puede ser campo futuro)
- `photos` → `animal_photos` (múltiples registros)
- Primera foto → `animals.cover_image_url` (opcional, puede ser la primera de `animal_photos`)

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/add_animals_code.html`
- Imagen: `docs/design/add_animals_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del formulario:
- **Breadcrumbs**: ""Dashboard / My Animals / Add New""
- **Header de la página**:
  - Título: ""Add a New Amigo""
  - Subtítulo: ""Fill in the details below to add a new animal to the adoption catalog.""
- **Sección 1: The Basics**
  - Animal Name* (text input)
  - Breed (text input, opcional, con hint ""Mixed if unknown"")
  - Age* (number input) + Unit (dropdown: Years/Months)
  - Gender* (dropdown: Select gender / Male / Female)
  - Size (dropdown: Select size / Small (0-10kg) / Medium (11-25kg) / Large (26-40kg) / Giant (41kg+))
  - Current Location (text input con icono de ubicación, opcional)
- **Sección 2: Media Gallery**
  - Título: ""Media Gallery""
  - Subtítulo: ""Good photos increase adoption chances! Try to upload at least 3.""
  - Área de upload (drag & drop o click)
  - Grid de previews de imágenes (2 columnas en móvil, 4 en desktop)
  - Botón de eliminar en cada preview (hover)
  - Límite: MAX. 5MB por imagen
  - Formatos: SVG, PNG, JPG, GIF
- **Sección 3: Their Story**
  - Description* (textarea, mínimo 1000 caracteres, contador ""0/1000 characters"")
  - Status* (dropdown: Available for Adoption / Sponsorship Only / Foster Care Needed / Adoption Pending)
  - Health Status (checkboxes: Vaccinated, Spayed/Neutered, Wormed) - opcional, no se guarda en BD
- **Footer / Actions**:
  - Botón ""Save Draft"" (secundario)
  - Botón ""Publish Profile"" (primario, con icono)

Reglas:
- Usar tokens del Design System.
- El formulario debe ser responsive.
- Validaciones en tiempo real (onBlur) y al enviar.
- Mostrar mensajes de error claros.
- Estados de loading durante el envío.
- Feedback visual al subir imágenes.

---

## Alcance

Incluye:
- Crear página `/foundations/animals/add` (dentro del área de fundaciones)
- Implementar formulario completo con todas las secciones del diseño
- Validaciones con Formik y Yup para todos los campos
- Manejo de subida de imágenes (múltiples archivos)
- Preview de imágenes antes de subir
- Eliminar imágenes del preview
- Crear animal en Supabase (`animals` table)
- Subir imágenes a Supabase Storage (o URLs si ya están en storage)
- Crear registros en `animal_photos` con `sort_order`
- Establecer `cover_image_url` (primera imagen)
- Obtener `foundation_id` del usuario autenticado
- Opciones de guardar como borrador o publicar
- Redirección a `/foundations/animals` después de crear
- Mostrar mensaje de éxito
- Manejo de errores y mensajes traducidos
- Estados de loading durante operaciones
- Validación de tamaño y formato de imágenes
- Contador de caracteres para descripción
- Traducciones completas (español e inglés)
- Navegación desde botón ""+ Add New Animal"" en la lista

No incluye:
- Editar animales existentes (HU futura)
- Eliminar animales (HU futura)
- Upload real a Supabase Storage (por ahora solo URLs, puede ser HU futura)
- Gestión avanzada de imágenes (redimensionar, optimizar, etc.)
- Validación de permisos granulares (solo membership básico)
- Tests automatizados (si luego se define estrategia de tests, se hará en HU futura)
- Funcionalidad de ""Current Location"" (solo UI, no se guarda)
- Funcionalidad de ""Health Status"" (solo UI, no se guarda en BD)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página de agregar animal creada

- **Dado** que necesito agregar un animal a mi fundación
- **Cuando** navego a la ruta `/foundations/animals/add`
- **Entonces** veo el formulario completo
- **Y** la página usa el layout del dashboard de fundaciones (HU-018)
- **Y** la página se carga sin errores
- **Y** el sidebar muestra ""Animals"" como activo

---

### 2) Navegación desde lista de animales

- **Dado** que estoy en la página de gestión de animales (HU-022)
- **Cuando** hago clic en el botón ""+ Add New Animal""
- **Entonces** navego a `/foundations/animals/add`
- **Y** el formulario se muestra correctamente

---

### 3) Sección ""The Basics"" implementada

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** observo la sección ""The Basics""
- **Entonces** veo todos los campos:
  - Animal Name* (requerido)
  - Breed (opcional)
  - Age* + Unit (requerido)
  - Gender* (requerido)
  - Size (opcional)
  - Current Location (opcional)
- **Y** los campos tienen los placeholders y labels correctos
- **Y** los campos requeridos están marcados con asterisco rojo

---

### 4) Validaciones de ""The Basics""

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** intento enviar sin completar campos requeridos
- **Entonces** se muestran mensajes de error:
  - ""Animal Name is required""
  - ""Age is required""
  - ""Gender is required""
- **Y** los campos con error muestran borde rojo
- **Y** los mensajes de error están traducidos

---

### 5) Sección ""Media Gallery"" implementada

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** observo la sección ""Media Gallery""
- **Entonces** veo:
  - Área de upload con drag & drop
  - Texto: ""Click to upload or drag and drop""
  - Texto: ""SVG, PNG, JPG or GIF (MAX. 5MB)""
  - Grid de previews (vacío inicialmente)
- **Y** puedo hacer clic o arrastrar archivos para subir

---

### 6) Subida de imágenes funcional

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** subo una o más imágenes
- **Entonces** las imágenes aparecen en el grid de previews
- **Y** puedo eliminar imágenes del preview
- **Y** se valida el tamaño máximo (5MB)
- **Y** se valida el formato (SVG, PNG, JPG, GIF)
- **Y** si una imagen excede el tamaño, se muestra error
- **Y** si el formato no es válido, se muestra error
- **Y** mínimo 1 imagen es requerida para publicar

---

### 7) Sección ""Their Story"" implementada

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** observo la sección ""Their Story""
- **Entonces** veo:
  - Description* (textarea con contador de caracteres)
  - Status* (dropdown)
  - Health Status (checkboxes opcionales)
- **Y** el contador muestra ""0/1000 characters""
- **Y** el contador se actualiza al escribir

---

### 8) Validaciones de ""Their Story""

- **Dado** que estoy en el formulario de agregar animal
- **Cuando** intento enviar sin completar campos requeridos
- **Entonces** se muestran mensajes de error:
  - ""Description is required"" (si está vacío)
  - ""Description must be at least 100 characters"" (si es muy corto)
  - ""Status is required""
- **Y** los campos con error muestran borde rojo

---

### 9) Crear animal en Supabase

- **Dado** que completo el formulario correctamente
- **Cuando** hago clic en ""Publish Profile"" o ""Save Draft""
- **Entonces** se crea el animal en la tabla `animals` de Supabase
- **Y** el `foundation_id` se obtiene automáticamente del usuario autenticado
- **Y** los campos se mapean correctamente a la BD
- **Y** `is_published` es `true` si se publica, `false` si se guarda como borrador
- **Y** `status` se guarda correctamente según la selección

---

### 10) Subir imágenes a animal_photos

- **Dado** que completo el formulario con imágenes
- **Cuando** se crea el animal
- **Entonces** se crean registros en `animal_photos` para cada imagen
- **Y** cada registro tiene `animal_id`, `url` y `sort_order` correctos
- **Y** la primera imagen (sort_order = 0) se establece como `cover_image_url`
- **Y** las imágenes se ordenan según el orden de subida

---

### 11) Conversión de edad a meses

- **Dado** que ingreso la edad del animal
- **Cuando** selecciono la unidad (Years o Months)
- **Entonces** la edad se convierte correctamente a meses:
  - Si es ""Years"": `age_months = age * 12`
  - Si es ""Months"": `age_months = age`
- **Y** se guarda correctamente en `animals.age_months`

---

### 12) Mapeo de valores del formulario a BD

- **Dado** que completo el formulario
- **Cuando** se crea el animal
- **Entonces** los valores se mapean correctamente:
  - `gender: ""Male""` → `sex: ""male""`
  - `gender: ""Female""` → `sex: ""female""`
  - `size: ""Small (0-10kg)""` → `size: ""small""`
  - `size: ""Medium (11-25kg)""` → `size: ""medium""`
  - `size: ""Large (26-40kg)""` → `size: ""large""`
  - `size: ""Giant (41kg+)""` → `size: ""large""` (o crear nuevo valor si es necesario)
  - `species` según opciones del select
  - `status` según opciones del select

---

### 13) Estados de loading

- **Dado** que envío el formulario
- **Cuando** se está creando el animal
- **Entonces** se muestra un estado de loading
- **Y** los botones están deshabilitados
- **Y** los campos están deshabilitados
- **Y** se muestra un spinner o indicador de carga

---

### 14) Manejo de errores

- **Dado** que ocurre un error al crear el animal
- **Cuando** Supabase retorna error (sin permisos, conectividad, etc.)
- **Entonces** se muestra un mensaje de error traducido
- **Y** la UI no se rompe
- **Y** el usuario puede intentar nuevamente
- **Y** los datos del formulario se mantienen (no se pierden)

---

### 15) Redirección después de crear

- **Dado** que se crea el animal exitosamente
- **Cuando** se completa la operación
- **Entonces** se redirige a `/foundations/animals`
- **Y** se muestra un mensaje de éxito (toast, snackbar, etc.)
- **Y** el nuevo animal aparece en la lista
- **Y** la lista se actualiza automáticamente

---

### 16) Ver animal creado en la lista

- **Dado** que creé un animal exitosamente
- **Cuando** navego a la lista de animales
- **Entonces** el nuevo animal aparece en la tabla
- **Y** los datos se muestran correctamente (nombre, especie, estado, etc.)
- **Y** la imagen de perfil se muestra correctamente
- **Y** el ID se formatea como #AG-XXXX

---

### 17) Guardar como borrador vs publicar

- **Dado** que completo el formulario
- **Cuando** hago clic en ""Save Draft""
- **Entonces** el animal se crea con `is_published = false`
- **Y** cuando hago clic en ""Publish Profile""
- **Entonces** el animal se crea con `is_published = true`
- **Y** ambos casos funcionan correctamente

---

### 18) Traducciones implementadas

- **Dado** que se implementa el formulario
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/animals.json` y `src/messages/en/animals.json`
- **Y** los mensajes de error y validación están traducidos
- **Y** no hay textos hardcodeados

---

### 19) Reglas de arquitectura cumplidas

- **Dado** que se implementa la funcionalidad
- **Cuando** se revisan imports y capas
- **Entonces** Domain no importa Supabase/React/Next/MUI/Tailwind/Inversify/Formik/Yup
- **Y** Presentation consume UseCases vía IoC
- **Y** Infrastructure contiene las implementaciones de repositorios y el wiring
- **Y** Supabase solo vive en Infrastructure

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase/Formik/Yup.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de creación de animal

1. Usuario navega a `/foundations/animals/add` (Presentation)
2. `AddAnimalPage` renderiza `AddAnimalForm` con Formik (Presentation)
3. Usuario completa formulario y sube imágenes (Presentation)
4. Usuario hace clic en ""Publish"" o ""Save Draft"" (Presentation)
5. `AddAnimalForm` llama a `CreateAnimalUseCase` (Presentation → Domain)
6. UseCase obtiene `foundation_id` del usuario (vía `GetSessionUseCase` o `FoundationMembershipRepository`)
7. UseCase llama a `AnimalRepository.createAnimal()` (Domain → Infrastructure)
8. `AnimalRepository.createAnimal()` crea registro en `animals` (Infrastructure → Supabase)
9. `AnimalRepository.createAnimalPhotos()` crea registros en `animal_photos` (Infrastructure → Supabase)
10. UseCase retorna animal creado
11. Presentation redirige a `/foundations/animals` con mensaje de éxito

### Obtener foundation_id del usuario

- Usar `supabaseClient.auth.getUser()` para obtener `user.id`.
- Query: `SELECT foundation_id FROM foundation_members WHERE user_id = :userId LIMIT 1`
- Si no existe membership, manejar como error (usuario sin fundación).
- Puede reutilizar lógica de `FoundationProfileRepository.getFoundationIdForUser()`.

### Crear animal en Supabase

- Insertar en `animals`:
  ```sql
  INSERT INTO animals (
    foundation_id, name, species, breed, sex, age_months, 
    size, status, description, cover_image_url, is_published
  ) VALUES (...)
  ```
- Retornar el `id` generado (identity).
- Manejar errores de validación (constraints de BD).

### Subir imágenes

- Por ahora, asumir que las imágenes ya están en Supabase Storage o son URLs públicas.
- Si se implementa upload real:
  - Subir a Supabase Storage bucket (ej: `animal-photos`)
  - Obtener URL pública de cada imagen
  - Crear registros en `animal_photos` con las URLs
- Si solo son URLs (mock o ya subidas):
  - Validar que sean URLs válidas
  - Crear registros en `animal_photos` directamente
- Ordenar imágenes por orden de subida (`sort_order`: 0, 1, 2, ...).
- Primera imagen (`sort_order = 0`) → establecer como `cover_image_url`.

### Validaciones con Formik y Yup

- Crear esquema de validación con Yup.
- Validar campos requeridos: `name`, `age`, `gender`, `description`, `status`.
- Validar formato y tamaño de imágenes.
- Validar longitud mínima de descripción (100 caracteres).
- Validar edad (número positivo).
- Mensajes de error traducidos usando `next-intl`.

### Mapeo de valores

- `gender`: ""Male"" → ""male"", ""Female"" → ""female""
- `size`: ""Small (0-10kg)"" → ""small"", ""Medium (11-25kg)"" → ""medium"", ""Large (26-40kg)"" → ""large"", ""Giant (41kg+)"" → ""large""
- `species`: según opciones del select (dog, cat, bird, other)
- `status`: según opciones del select (available, adopted, in_treatment, inactive)
- `age`: convertir según unidad (Years → meses, Months → meses)

### Manejo de errores

- Los errores de Supabase deben traducirse a mensajes legibles en español e inglés.
- Usar `PostgrestError` de Supabase para identificar tipos de error.
- Los mensajes de error deben estar en los archivos de traducción.
- Mostrar errores en la UI sin romper el layout.

### Traducciones
- **TODOS los mensajes visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/animals.json` (español)
  - `src/messages/en/animals.json` (inglés)
- Incluir traducciones para:
  - Labels de campos
  - Placeholders
  - Mensajes de error y validación
  - Mensajes de éxito
  - Opciones de selects
  - Textos de ayuda
- Usar `useTranslations('animals')` hook de `next-intl` para acceder a traducciones.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Formik y Yup ya están instalados (HU-014).
- Supabase ya está configurado (HU-011).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/app/[locale]/foundations/animals/add/
└── page.tsx                        # Página de agregar animal

src/presentation/components/animals/
├── AddAnimalForm.tsx              # Formulario principal con Formik
├── AnimalFormBasics.tsx            # Sección ""The Basics""
├── AnimalFormMedia.tsx             # Sección ""Media Gallery""
├── AnimalFormStory.tsx             # Sección ""Their Story""
├── ImageUploadArea.tsx             # Componente de upload de imágenes
├── ImagePreviewGrid.tsx            # Grid de previews de imágenes
└── addAnimalValidation.ts          # Schema de validación con Yup

src/domain/
├── models/
│   └── CreateAnimalInput.ts        # Input DTO para crear animal
├── repositories/
│   └── IAnimalRepository.ts         # Agregar método: createAnimal
└── usecases/
    └── animals/
        └── CreateAnimalUseCase.ts   # UseCase para crear animal

src/infrastructure/
├── repositories/
│   └── AnimalRepository.ts          # Implementar createAnimal, createAnimalPhotos
└── ioc/
    └── ...                          # Agregar bindings de CreateAnimalUseCase

src/messages/
├── es/
│   └── animals.json                 # Traducciones en español (extender)
└── en/
    └── animals.json                  # Traducciones en inglés (extender)
```

### Flujo de implementación:

1. **Extender IAnimalRepository**:
   ```typescript
   export interface CreateAnimalParams {
     foundationId: string;
     name: string;
     species: AnimalManagementSpecies;
     breed?: string | null;
     sex: AnimalManagementSex;
     ageMonths: number | null;
     size: AnimalManagementSize;
     status: AnimalManagementStatus;
     description: string;
     coverImageUrl?: string | null;
     isPublished: boolean;
   }
   
   export interface CreateAnimalPhotoParams {
     animalId: number;
     url: string;
     sortOrder: number;
   }
   
   export interface IAnimalRepository {
     getHomeAnimals(): Promise<HomeAnimals>;
     getAnimals(params: GetAnimalsParams): Promise<GetAnimalsResult>;
     createAnimal(params: CreateAnimalParams): Promise<AnimalManagement>; // Nuevo
     createAnimalPhotos(params: CreateAnimalPhotoParams[]): Promise<void>; // Nuevo
   }
   ```

2. **Implementar createAnimal en AnimalRepository**:
   - Insertar en `animals` con todos los campos
   - Retornar el animal creado (mapeado a `AnimalManagement`)
   - Manejar errores y traducirlos

3. **Implementar createAnimalPhotos en AnimalRepository**:
   - Insertar múltiples registros en `animal_photos`
   - Usar transacción o batch insert si es posible
   - Manejar errores

4. **Crear CreateAnimalUseCase**:
   ```typescript
   export interface CreateAnimalInput {
     name: string;
     species: AnimalManagementSpecies;
     breed?: string | null;
     sex: AnimalManagementSex;
     age: number;
     ageUnit: 'years' | 'months';
     size: AnimalManagementSize;
     status: AnimalManagementStatus;
     description: string;
     photos: string[]; // URLs de imágenes
     isPublished: boolean;
   }
   
   export class CreateAnimalUseCase {
     constructor(
       private readonly animalRepository: IAnimalRepository,
       private readonly foundationMembershipRepository: IFoundationMembershipRepository // Para obtener foundation_id
     ) {}
     
     async execute(input: CreateAnimalInput): Promise<AnimalManagement> {
       // 1. Obtener usuario autenticado
       // 2. Obtener foundation_id del usuario
       // 3. Convertir edad a meses
       // 4. Determinar cover_image_url (primera foto)
       // 5. Crear animal en BD
       // 6. Crear registros de fotos en BD
       // 7. Retornar animal creado
     }
   }
   ```

5. **Crear AddAnimalForm con Formik**:
   - Usar `useFormik` o `<Formik>`
   - Definir valores iniciales
   - Conectar con esquema de validación Yup
   - Manejar submit (llamar a `CreateAnimalUseCase`)
   - Manejar estados de loading y error
   - Redirigir después de éxito

6. **Crear componentes de secciones**:
   - `AnimalFormBasics`: campos básicos
   - `AnimalFormMedia`: upload y preview de imágenes
   - `AnimalFormStory`: descripción y estado

7. **Crear componente de upload de imágenes**:
   - Drag & drop
   - Click para seleccionar
   - Validación de formato y tamaño
   - Preview de imágenes
   - Eliminar imágenes

8. **Agregar traducciones**:
   - Extender `src/messages/es/animals.json` y `src/messages/en/animals.json`
   - Agregar todas las keys necesarias

9. **Conectar navegación**:
   - Agregar botón ""+ Add New Animal"" en `AnimalsManagementPage` que navegue a `/foundations/animals/add`

### Schema de validación sugerido:

```typescript
import * as Yup from 'yup';
import type { UseTranslationsType } from 'next-intl';

export const createAddAnimalValidationSchema = (t: UseTranslationsType<'animals'>) =>
  Yup.object().shape({
    name: Yup.string()
      .trim()
      .required(t('form.validation.nameRequired'))
      .min(2, t('form.validation.nameMin')),
    breed: Yup.string().trim().optional().nullable(),
    age: Yup.number()
      .required(t('form.validation.ageRequired'))
      .min(0, t('form.validation.ageMin'))
      .integer(t('form.validation.ageInteger')),
    ageUnit: Yup.string()
      .oneOf(['years', 'months'], t('form.validation.ageUnitInvalid'))
      .required(),
    gender: Yup.string()
      .oneOf(['male', 'female'], t('form.validation.genderRequired'))
      .required(t('form.validation.genderRequired')),
    size: Yup.string()
      .oneOf(['small', 'medium', 'large', 'unknown'], t('form.validation.sizeInvalid'))
      .optional()
      .nullable(),
    species: Yup.string()
      .oneOf(['dog', 'cat', 'bird', 'other'], t('form.validation.speciesRequired'))
      .required(t('form.validation.speciesRequired')),
    description: Yup.string()
      .trim()
      .required(t('form.validation.descriptionRequired'))
      .min(100, t('form.validation.descriptionMin')),
    status: Yup.string()
      .oneOf(['available', 'adopted', 'in_treatment', 'inactive'], t('form.validation.statusRequired'))
      .required(t('form.validation.statusRequired')),
    photos: Yup.array()
      .of(Yup.string().url(t('form.validation.photoUrlInvalid')))
      .min(1, t('form.validation.photosMin'))
      .max(10, t('form.validation.photosMax')),
    currentLocation: Yup.string().trim().optional().nullable(),
    healthStatus: Yup.object({
      vaccinated: Yup.boolean().optional(),
      spayedNeutered: Yup.boolean().optional(),
      wormed: Yup.boolean().optional(),
    }).optional(),
  });
```

### Estructura de traducciones sugerida:

**src/messages/es/animals.json** (extender):
```json
{
  ""form"": {
    ""title"": ""Agregar un Nuevo Amigo"",
    ""subtitle"": ""Completa los detalles a continuación para agregar un nuevo animal al catálogo de adopción."",
    ""sections"": {
      ""basics"": ""Información Básica"",
      ""media"": ""Galería de Medios"",
      ""story"": ""Su Historia""
    },
    ""fields"": {
      ""name"": {
        ""label"": ""Nombre del Animal"",
        ""placeholder"": ""ej. Buddy""
      },
      ""breed"": {
        ""label"": ""Raza"",
        ""hint"": ""(Mixta si se desconoce)""
      },
      ""age"": {
        ""label"": ""Edad"",
        ""placeholder"": ""0""
      },
      ""ageUnit"": {
        ""label"": ""Unidad"",
        ""years"": ""Años"",
        ""months"": ""Meses""
      },
      ""gender"": {
        ""label"": ""Género"",
        ""placeholder"": ""Seleccionar género"",
        ""male"": ""Macho"",
        ""female"": ""Hembra""
      },
      ""size"": {
        ""label"": ""Tamaño"",
        ""placeholder"": ""Seleccionar tamaño"",
        ""small"": ""Pequeño (0-10kg)"",
        ""medium"": ""Mediano (11-25kg)"",
        ""large"": ""Grande (26-40kg)"",
        ""giant"": ""Gigante (41kg+)""
      },
      ""currentLocation"": {
        ""label"": ""Ubicación Actual"",
        ""placeholder"": ""Ciudad, Nombre del Refugio""
      },
      ""description"": {
        ""label"": ""Descripción"",
        ""placeholder"": ""Cuéntanos sobre su personalidad, historia y qué tipo de hogar necesita..."",
        ""characters"": ""{count}/1000 caracteres""
      },
      ""status"": {
        ""label"": ""Estado"",
        ""available"": ""Disponible para Adopción"",
        ""sponsorship"": ""Solo Apadrinamiento"",
        ""foster"": ""Necesita Hogar Temporal"",
        ""pending"": ""Adopción Pendiente""
      },
      ""healthStatus"": {
        ""label"": ""Estado de Salud"",
        ""vaccinated"": ""Vacunado"",
        ""spayedNeutered"": ""Esterilizado/Castrado"",
        ""wormed"": ""Desparasitado""
      },
      ""photos"": {
        ""label"": ""Fotos"",
        ""uploadText"": ""Haz clic para subir o arrastra y suelta"",
        ""uploadHint"": ""SVG, PNG, JPG o GIF (MÁX. 5MB)"",
        ""minPhotos"": ""¡Las buenas fotos aumentan las posibilidades de adopción! Intenta subir al menos 3.""
      }
    },
    ""actions"": {
      ""saveDraft"": ""Guardar Borrador"",
      ""publish"": ""Publicar Perfil""
    },
    ""validation"": {
      ""nameRequired"": ""El nombre del animal es requerido"",
      ""nameMin"": ""El nombre debe tener al menos 2 caracteres"",
      ""ageRequired"": ""La edad es requerida"",
      ""ageMin"": ""La edad debe ser mayor o igual a 0"",
      ""ageInteger"": ""La edad debe ser un número entero"",
      ""ageUnitInvalid"": ""La unidad de edad no es válida"",
      ""genderRequired"": ""El género es requerido"",
      ""sizeInvalid"": ""El tamaño no es válido"",
      ""speciesRequired"": ""La especie es requerida"",
      ""descriptionRequired"": ""La descripción es requerida"",
      ""descriptionMin"": ""La descripción debe tener al menos 100 caracteres"",
      ""statusRequired"": ""El estado es requerido"",
      ""photoUrlInvalid"": ""La URL de la foto no es válida"",
      ""photosMin"": ""Debes subir al menos 1 foto"",
      ""photosMax"": ""No puedes subir más de 10 fotos""
    },
    ""success"": {
      ""created"": ""Animal creado exitosamente"",
      ""published"": ""Animal publicado exitosamente""
    },
    ""errors"": {
      ""createFailed"": ""Error al crear el animal"",
      ""uploadFailed"": ""Error al subir las imágenes"",
      ""unauthorized"": ""No tienes permisos para crear animales""
    }
  }
}
```

**src/messages/en/animals.json** (extender de manera similar con traducciones en inglés).

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el formulario funciona)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones manuales:
- [ ] El formulario se ve igual al diseño de referencia
- [ ] Todas las validaciones funcionan correctamente
- [ ] La subida de imágenes funciona
- [ ] El animal se crea correctamente en Supabase
- [ ] Las imágenes se guardan correctamente en `animal_photos`
- [ ] La redirección funciona después de crear
- [ ] El animal aparece en la lista
- [ ] Los mensajes de error están traducidos
- [ ] Los estados de loading funcionan
- [ ] El formulario es responsive

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de agregar animal creada y accesible
- [ ] Formulario completo implementado con todas las secciones
- [ ] Validaciones con Formik y Yup funcionando
- [ ] Subida de imágenes funcional
- [ ] Método `createAnimal` implementado en `IAnimalRepository` y `AnimalRepository`
- [ ] Método `createAnimalPhotos` implementado
- [ ] `CreateAnimalUseCase` creado y funcional
- [ ] `AddAnimalForm` conectado con `CreateAnimalUseCase`
- [ ] Animal se crea correctamente en Supabase
- [ ] Imágenes se guardan correctamente en `animal_photos`
- [ ] Redirección funciona después de crear
- [ ] Animal aparece en la lista de animales
- [ ] Manejo de errores implementado y traducido
- [ ] Estados de loading implementados
- [ ] Mapeo de datos correcto (edad, género, tamaño, especie, estado)
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/animals.json`
  - [ ] Textos agregados en `src/messages/en/animals.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Navegación desde botón ""+ Add New Animal"" funciona
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add create animal form with Supabase integration`",Backlog,Normal,HU
HU-025 — Dashboard de Fundación (UI y Funcionalidad con Supabase),"# HU-025 — Dashboard de Fundación (UI y Funcionalidad con Supabase)

**Como** usuario de una fundación  
**Quiero** ver un dashboard con métricas, gráficos y actividad reciente de mi fundación  
**Para** tener una vista general del estado de mis animales, eventos y operaciones

---

## Dependencias

- HU-011 (Conexión a Supabase configurada)
- HU-013 (Estrategia de roles y protección de rutas definida)
- HU-014 (Formik y Yup configurados)
- HU-016 (Sistema de traducciones configurado)
- HU-018 (Layout del dashboard de fundaciones con sidebar) - **REQUERIDO**
- HU-022 (UI de gestión de animales implementada)
- HU-023 (Funcionalidad de gestión de animales con Supabase)

---

## Contexto / Notas

- Esta HU implementa el **dashboard principal** de la fundación con métricas, gráficos y actividad reciente.
- El dashboard debe seguir el diseño exacto de `docs/design/dashboard_screen.png` y `docs/design/dashboard_code.html`.
- El dashboard se mostrará en `/foundations` (página principal del área de fundaciones).
- El layout del dashboard de fundaciones (HU-018) ya está implementado y debe usarse.
- **Adaptación al modelo de datos**: Algunas métricas no existen en la BD actual, se usarán mocks o valores calculados.

Modelo de datos disponible (según `docs/scripts/db.sql`):
- Tabla `animals`: `id`, `foundation_id`, `name`, `species`, `breed`, `status`, `cover_image_url`, `created_at`
- Tabla `events`: `id`, `foundation_id`, `title`, `description`, `starts_at`, `ends_at`, `created_at`
- Tabla `products`: `id`, `foundation_id`, `name`, `price`, `image_url`, `created_at`
- Tabla `foundations`: `id`, `name`, `logo_url`

Métricas disponibles desde BD:
- **Animales en Cuidado**: Contar `animals` de la fundación (todos los estados)
- **Patrocinios Activos**: No existe tabla de patrocinios → usar mock o 0
- **Adopciones Pendientes**: No existe tabla de adopciones → usar mock o 0
- **Recaudado (Mes)**: No existe tabla de transacciones → usar mock o 0

Embudo de Adopción:
- No existe tabla de adopciones → usar mock o datos calculados basados en animales con `status = 'adopted'`

Actividad Reciente:
- Mostrar animales recientes (últimos 5-10)
- Mostrar eventos recientes (últimos 3-5)
- Mostrar productos recientes (últimos 3-5)
- Combinar y ordenar por fecha

Requiere Atención:
- Animales con `status = 'in_treatment'` (revisión veterinaria)
- Productos con stock bajo (si existe campo, sino mock)
- Eventos próximos (si `starts_at` está cerca)

Reglas de autorización:
- El usuario debe estar autenticado y ser miembro de la fundación.
- Solo puede ver datos de su propia fundación.
- Obtener `foundation_id` del usuario autenticado (vía `foundation_members`).

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/dashboard_code.html`
- Imagen: `docs/design/dashboard_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del dashboard:
- **Header**:
  - Saludo: ""Hola, [Nombre Fundación]!""
  - Fecha: ""Oct 26, 2023 - Resumen diario de actividad""
  - Botón de notificaciones (icono)
  - Botón ""Modo Vista"" (dropdown o botón)
- **KPI Cards** (4 cards en grid):
  - **Animales en Cuidado**: número, icono de paw, badge de tendencia (+2%)
  - **Patrocinios Activos**: número, icono de corazón, badge de tendencia (+12%)
  - **Adopciones Pendientes**: número, icono de casa, badge de tendencia (0%)
  - **Recaudado (Mes)**: monto, icono de dinero, badge de tendencia (+5%)
- **Embudo de Adopción** (sección izquierda):
  - Título: ""Estado del Embudo de Adopción""
  - Botón ""Ver reporte""
  - 4 barras de progreso:
    - Solicitudes Recibidas (24, 100%)
    - Entrevistas Programadas (12, 50%)
    - Visitas Domiciliarias (5, 20%)
    - Adopciones Completadas (3, 12%)
  - Leyenda: ""En proceso"" (azul), ""Entrada total"" (gris)
- **Actividad Reciente** (tabla, sección izquierda):
  - Título: ""Actividad Reciente""
  - Tabla con columnas: Animal/Asunto, Tipo, Fecha, Estado
  - Filas con animales, eventos, productos recientes
  - Badges de estado según tipo
- **Acciones Rápidas** (sección derecha):
  - Título: ""Acciones Rápidas""
  - Botón primario: ""+ Nuevo Animal"" (navega a `/foundations/animals/add`)
  - Botón secundario: ""Registrar Gasto"" (solo UI, sin funcionalidad)
  - Botón secundario: ""Crear Campaña"" (solo UI, sin funcionalidad)
- **Requiere Atención** (sección derecha):
  - Título: ""Requiere Atención""
  - Badge con número de alertas (ej: ""3"")
  - Cards de alertas:
    - Revisión Veterinaria (rojo): ""Rocky necesita su vacuna anual antes del viernes.""
    - Stock Bajo (amarillo): ""Quedan menos de 5 bolsas de alimento cachorro.""
    - Voluntarios Sábado (gris): ""Faltan 2 cupos para la jornada de limpieza.""
  - Botón ""Ver todas las tareas"" (solo UI)

Reglas:
- Usar tokens del Design System.
- El dashboard debe ser responsive.
- Los KPI cards deben tener hover effects.
- Las barras de progreso deben ser visuales (CSS, no librerías de gráficos).
- La tabla debe ser responsive (scroll horizontal en móvil).

---

## Alcance

Incluye:
- Crear página `/foundations` (página principal del dashboard)
- Implementar header del dashboard con saludo y fecha
- Implementar 4 KPI cards con métricas:
  - Animales en Cuidado (desde BD)
  - Patrocinios Activos (mock, ya que no existe en BD)
  - Adopciones Pendientes (mock, ya que no existe en BD)
  - Recaudado (Mes) (mock, ya que no existe en BD)
- Implementar sección ""Embudo de Adopción"" con barras de progreso (mock o calculado)
- Implementar tabla ""Actividad Reciente"" con datos reales:
  - Animales recientes (desde BD)
  - Eventos recientes (desde BD)
  - Productos recientes (desde BD)
- Implementar sección ""Acciones Rápidas"" con botones
- Implementar sección ""Requiere Atención"" con alertas:
  - Animales con `status = 'in_treatment'` (desde BD)
  - Otras alertas (mock si no hay datos)
- Conectar con Supabase para cargar datos reales
- Obtener `foundation_id` del usuario autenticado
- Calcular métricas desde BD
- Manejar estados de loading
- Manejar errores y mostrar mensajes traducidos
- Agregar traducciones completas (español e inglés)
- Navegación funcional desde botones (ej: ""+ Nuevo Animal"" → `/foundations/animals/add`)

No incluye:
- Funcionalidad de ""Registrar Gasto"" (HU futura)
- Funcionalidad de ""Crear Campaña"" (HU futura)
- Funcionalidad de ""Ver reporte"" del embudo (HU futura)
- Funcionalidad de ""Ver todas las tareas"" (HU futura)
- Gestión de notificaciones (HU futura)
- Modo Vista (dropdown funcional, solo UI)
- Tests automatizados (si luego se define estrategia de tests, se hará en HU futura)
- Optimización avanzada de queries (indexes, etc. se asume que ya están en BD)

---

## Criterios de aceptación (Given / When / Then)

### 1) Página del dashboard creada

- **Dado** que necesito ver el dashboard de mi fundación
- **Cuando** navego a la ruta `/foundations`
- **Entonces** veo el dashboard completo
- **Y** la página usa el layout del dashboard de fundaciones (HU-018)
- **Y** la página se carga sin errores
- **Y** el sidebar muestra ""Dashboard"" como activo

---

### 2) Header del dashboard implementado

- **Dado** que estoy en el dashboard
- **Cuando** observo el header
- **Entonces** veo:
  - Saludo: ""Hola, [Nombre Fundación]!"" (nombre desde BD)
  - Fecha actual formateada: ""[Fecha] - Resumen diario de actividad""
  - Botón de notificaciones (icono)
  - Botón ""Modo Vista""
- **Y** el nombre de la fundación se obtiene desde Supabase

---

### 3) KPI Cards implementadas

- **Dado** que estoy en el dashboard
- **Cuando** observo las KPI cards
- **Entonces** veo 4 cards:
  - Animales en Cuidado (número desde BD)
  - Patrocinios Activos (mock o 0)
  - Adopciones Pendientes (mock o 0)
  - Recaudado (Mes) (mock o 0)
- **Y** cada card tiene icono, número, label y badge de tendencia
- **Y** las cards tienen hover effects
- **Y** el número de ""Animales en Cuidado"" se calcula desde BD

---

### 4) Métrica ""Animales en Cuidado"" desde BD

- **Dado** que tengo animales en mi fundación
- **Cuando** se carga el dashboard
- **Entonces** se consulta Supabase para contar animales de la fundación
- **Y** se muestra el total correcto
- **Y** se muestra badge de tendencia (mock o calculado vs mes anterior)

---

### 5) Sección ""Embudo de Adopción"" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección ""Embudo de Adopción""
- **Entonces** veo:
  - Título y botón ""Ver reporte""
  - 4 barras de progreso con valores y porcentajes
  - Leyenda con colores
- **Y** las barras son visuales (CSS)
- **Y** los datos son mock o calculados (ya que no existe tabla de adopciones)

---

### 6) Tabla ""Actividad Reciente"" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la tabla ""Actividad Reciente""
- **Entonces** veo una tabla con:
  - Headers: Animal/Asunto, Tipo, Fecha, Estado
  - Filas con animales, eventos y productos recientes
  - Badges de estado según tipo
- **Y** los datos se obtienen desde Supabase
- **Y** se ordenan por fecha (más recientes primero)
- **Y** se muestran máximo 10-15 items

---

### 7) Actividad Reciente desde BD

- **Dado** que tengo animales, eventos y productos en mi fundación
- **Cuando** se carga el dashboard
- **Entonces** se consultan:
  - Últimos 5-10 animales (desde `animals`)
  - Últimos 3-5 eventos (desde `events`)
  - Últimos 3-5 productos (desde `products`)
- **Y** se combinan y ordenan por fecha
- **Y** se muestran en la tabla con formato correcto

---

### 8) Sección ""Acciones Rápidas"" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección ""Acciones Rápidas""
- **Entonces** veo:
  - Título: ""Acciones Rápidas""
  - Botón primario: ""+ Nuevo Animal"" (navega a `/foundations/animals/add`)
  - Botón secundario: ""Registrar Gasto"" (solo UI)
  - Botón secundario: ""Crear Campaña"" (solo UI)
- **Y** el botón ""+ Nuevo Animal"" navega correctamente

---

### 9) Sección ""Requiere Atención"" implementada

- **Dado** que estoy en el dashboard
- **Cuando** observo la sección ""Requiere Atención""
- **Entonces** veo:
  - Título con badge de número de alertas
  - Cards de alertas con iconos y mensajes
  - Botón ""Ver todas las tareas""
- **Y** se muestran alertas basadas en datos reales:
  - Animales con `status = 'in_treatment'` (desde BD)
  - Otras alertas (mock si no hay datos)

---

### 10) Alertas desde BD

- **Dado** que tengo animales con `status = 'in_treatment'`
- **Cuando** se carga el dashboard
- **Entonces** se consultan animales con ese status
- **Y** se generan alertas de ""Revisión Veterinaria""
- **Y** se muestran en la sección ""Requiere Atención""

---

### 11) Estados de loading

- **Dado** que se cargan datos del dashboard
- **Cuando** se están consultando datos de Supabase
- **Entonces** se muestra un estado de loading (spinner, skeleton, etc.)
- **Y** la UI indica que se está cargando
- **Y** al finalizar, el estado de loading desaparece

---

### 12) Manejo de errores

- **Dado** que ocurre un error al cargar datos
- **Cuando** Supabase retorna error (sin permisos, conectividad, etc.)
- **Entonces** se muestra un mensaje traducido apropiado
- **Y** la UI no se rompe
- **Y** el usuario puede intentar nuevamente

---

### 13) Obtener foundation_id del usuario

- **Dado** que el usuario está autenticado
- **Cuando** se carga el dashboard
- **Entonces** se obtiene `foundation_id` del usuario (vía `foundation_members`)
- **Y** se usan todas las queries con ese `foundation_id`
- **Y** si no tiene fundación, se muestra error apropiado

---

### 14) Traducciones implementadas

- **Dado** que se implementa el dashboard
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations` de `next-intl`
- **Y** existen traducciones en `src/messages/es/dashboard.json` y `src/messages/en/dashboard.json`
- **Y** no hay textos hardcodeados

---

### 15) Layout responsive

- **Dado** que estoy en el dashboard
- **Cuando** cambio el tamaño de la ventana
- **Entonces** el dashboard se adapta:
  - Grid de KPI cards: 1 columna en móvil, 2 en tablet, 4 en desktop
  - Secciones se apilan verticalmente en móvil
  - Tabla tiene scroll horizontal en móvil
- **Y** todos los elementos son legibles y accesibles

---

### 16) Reglas de arquitectura cumplidas

- **Dado** que se implementa la funcionalidad
- **Cuando** se revisan imports y capas
- **Entonces** Domain no importa Supabase/React/Next/MUI/Tailwind/Inversify
- **Y** Presentation consume UseCases vía IoC
- **Y** Infrastructure contiene las implementaciones de repositorios y el wiring
- **Y** Supabase solo vive en Infrastructure

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- **Supabase solo vive en Infrastructure**: servicios y repositorios.

### Flujo de carga del dashboard

1. Usuario navega a `/foundations` (Presentation)
2. `DashboardPage` llama a `GetDashboardDataUseCase` (Presentation → Domain)
3. UseCase obtiene `foundation_id` del usuario (vía `GetSessionUseCase` o `FoundationMembershipRepository`)
4. UseCase llama a múltiples repositorios:
   - `AnimalRepository.getAnimalsCount()` (Domain → Infrastructure)
   - `AnimalRepository.getRecentAnimals()` (Domain → Infrastructure)
   - `EventRepository.getRecentEvents()` (Domain → Infrastructure)
   - `ProductRepository.getRecentProducts()` (Domain → Infrastructure)
5. Repositorios consultan Supabase
6. UseCase retorna datos consolidados
7. Presentation muestra datos en el dashboard

### Obtener foundation_id del usuario

- Usar `supabaseClient.auth.getUser()` para obtener `user.id`.
- Query: `SELECT foundation_id FROM foundation_members WHERE user_id = :userId LIMIT 1`
- Si no existe membership, manejar como error (usuario sin fundación).
- Puede reutilizar lógica de `FoundationProfileRepository.getFoundationIdForUser()`.

### Consultas de métricas

- **Animales en Cuidado**: `SELECT COUNT(*) FROM animals WHERE foundation_id = :foundationId`
- **Animales recientes**: `SELECT * FROM animals WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 10`
- **Eventos recientes**: `SELECT * FROM events WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 5`
- **Productos recientes**: `SELECT * FROM products WHERE foundation_id = :foundationId ORDER BY created_at DESC LIMIT 5`
- **Animales en tratamiento**: `SELECT * FROM animals WHERE foundation_id = :foundationId AND status = 'in_treatment'`

### Métricas mock

- **Patrocinios Activos**: Usar valor mock (ej: 120) o 0 si no hay datos
- **Adopciones Pendientes**: Usar valor mock (ej: 3) o 0 si no hay datos
- **Recaudado (Mes)**: Usar valor mock (ej: $1,250) o $0 si no hay datos
- **Embudo de Adopción**: Usar valores mock o calcular basado en animales con `status = 'adopted'`

### Formato de datos

- Fechas: Formatear con `Intl.DateTimeFormat` o librería de fechas
- Monedas: Formatear con `Intl.NumberFormat` (ej: ""$1,250"")
- Porcentajes: Calcular y formatear (ej: ""+2%"")
- Nombres de fundación: Obtener desde `foundations.name`

### Manejo de errores

- Los errores de Supabase deben traducirse a mensajes legibles en español e inglés.
- Usar `PostgrestError` de Supabase para identificar tipos de error.
- Los mensajes de error deben estar en los archivos de traducción.
- Mostrar errores en la UI sin romper el layout.

### Traducciones
- **TODOS los mensajes visibles en la UI deben estar traducidos** (español e inglés).
- Usar el sistema de traducciones configurado en HU-016 (`next-intl`).
- Agregar traducciones en:
  - `src/messages/es/dashboard.json` (español)
  - `src/messages/en/dashboard.json` (inglés)
- Incluir traducciones para:
  - Títulos y subtítulos
  - Labels de métricas
  - Mensajes de error
  - Estados de loading
  - Tipos de actividad
  - Alertas
- Usar `useTranslations('dashboard')` hook de `next-intl` para acceder a traducciones.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Supabase ya está configurado (HU-011).
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Estructura de archivos sugerida:

```
src/app/[locale]/foundations/
└── page.tsx                        # Página principal del dashboard

src/presentation/components/dashboard/
├── DashboardPage.tsx               # Componente principal del dashboard
├── DashboardHeader.tsx             # Header con saludo y fecha
├── DashboardKPICards.tsx          # Grid de 4 KPI cards
├── DashboardKPICard.tsx           # Card individual de KPI
├── AdoptionFunnelSection.tsx      # Sección del embudo de adopción
├── RecentActivityTable.tsx        # Tabla de actividad reciente
├── QuickActionsSection.tsx        # Sección de acciones rápidas
└── NeedsAttentionSection.tsx     # Sección de requiere atención

src/domain/
├── models/
│   └── DashboardData.ts           # Modelo de datos del dashboard
├── repositories/
│   ├── IAnimalRepository.ts       # Extender con getAnimalsCount, getRecentAnimals
│   ├── IEventRepository.ts        # Nuevo: para eventos
│   └── IProductRepository.ts      # Nuevo: para productos
└── usecases/
    └── dashboard/
        └── GetDashboardDataUseCase.ts # UseCase para obtener datos del dashboard

src/infrastructure/
├── repositories/
│   ├── AnimalRepository.ts        # Extender con nuevos métodos
│   ├── EventRepository.ts          # Nuevo: implementación para eventos
│   └── ProductRepository.ts       # Nuevo: implementación para productos
└── ioc/
    └── ...                        # Agregar bindings de nuevos repositorios y use cases

src/messages/
├── es/
│   └── dashboard.json             # Traducciones en español
└── en/
    └── dashboard.json             # Traducciones en inglés
```

### Flujo de implementación:

1. **Extender IAnimalRepository**:
   ```typescript
   export interface IAnimalRepository {
     getHomeAnimals(): Promise<HomeAnimals>;
     getAnimals(params: GetAnimalsParams): Promise<GetAnimalsResult>;
     getAnimalsCount(foundationId: string): Promise<number>; // Nuevo
     getRecentAnimals(foundationId: string, limit: number): Promise<AnimalManagement[]>; // Nuevo
     getAnimalsInTreatment(foundationId: string): Promise<AnimalManagement[]>; // Nuevo
   }
   ```

2. **Crear IEventRepository**:
   ```typescript
   export interface RecentEvent {
     id: number;
     title: string;
     startsAt: string | null;
     createdAt: string;
   }
   
   export interface IEventRepository {
     getRecentEvents(foundationId: string, limit: number): Promise<RecentEvent[]>;
   }
   ```

3. **Crear IProductRepository**:
   ```typescript
   export interface RecentProduct {
     id: number;
     name: string;
     price: number | null;
     createdAt: string;
   }
   
   export interface IProductRepository {
     getRecentProducts(foundationId: string, limit: number): Promise<RecentProduct[]>;
   }
   ```

4. **Crear GetDashboardDataUseCase**:
   ```typescript
   export interface DashboardData {
     foundationName: string;
     animalsCount: number;
     recentActivity: ActivityItem[];
     animalsInTreatment: AnimalManagement[];
     // Métricas mock
     sponsorshipsCount: number;
     pendingAdoptions: number;
     monthlyRevenue: number;
   }
   
   export class GetDashboardDataUseCase {
     constructor(
       private readonly animalRepository: IAnimalRepository,
       private readonly eventRepository: IEventRepository,
       private readonly productRepository: IProductRepository,
       private readonly foundationRepository: IFoundationRepository,
       private readonly foundationMembershipRepository: IFoundationMembershipRepository
     ) {}
     
     async execute(): Promise<DashboardData> {
       // 1. Obtener usuario autenticado
       // 2. Obtener foundation_id del usuario
       // 3. Obtener nombre de fundación
       // 4. Consultar métricas y datos recientes
       // 5. Consolidar y retornar
     }
   }
   ```

5. **Implementar repositorios**:
   - Extender `AnimalRepository` con nuevos métodos
   - Crear `EventRepository` con implementación en Supabase
   - Crear `ProductRepository` con implementación en Supabase

6. **Crear componentes del dashboard**:
   - `DashboardPage`: componente principal que estructura el dashboard
   - `DashboardHeader`: header con saludo y fecha
   - `DashboardKPICards`: grid de 4 cards
   - `AdoptionFunnelSection`: sección del embudo
   - `RecentActivityTable`: tabla de actividad
   - `QuickActionsSection`: acciones rápidas
   - `NeedsAttentionSection`: alertas

7. **Conectar con UseCase**:
   - Inyectar `GetDashboardDataUseCase` vía IoC
   - Cargar datos al montar el componente
   - Manejar estados de loading y error
   - Mostrar datos en los componentes

8. **Agregar traducciones**:
   - Extender `src/messages/es/dashboard.json` y `src/messages/en/dashboard.json`
   - Agregar todas las keys necesarias

### Estructura de traducciones sugerida:

**src/messages/es/dashboard.json:**
```json
{
  ""header"": {
    ""greeting"": ""Hola, {foundationName}!"",
    ""subtitle"": ""{date} - Resumen diario de actividad"",
    ""viewMode"": ""Modo Vista""
  },
  ""kpi"": {
    ""animalsInCare"": {
      ""label"": ""Animales en Cuidado"",
      ""trend"": ""+{percent}%""
    },
    ""activeSponsorships"": {
      ""label"": ""Patrocinios Activos"",
      ""trend"": ""+{percent}%""
    },
    ""pendingAdoptions"": {
      ""label"": ""Adopciones Pendientes"",
      ""trend"": ""{percent}%""
    },
    ""monthlyRevenue"": {
      ""label"": ""Recaudado (Mes)"",
      ""trend"": ""+{percent}%""
    }
  },
  ""adoptionFunnel"": {
    ""title"": ""Estado del Embudo de Adopción"",
    ""viewReport"": ""Ver reporte"",
    ""applicationsReceived"": ""Solicitudes Recibidas"",
    ""interviewsScheduled"": ""Entrevistas Programadas"",
    ""homeVisits"": ""Visitas Domiciliarias"",
    ""adoptionsCompleted"": ""Adopciones Completadas"",
    ""inProcess"": ""En proceso"",
    ""totalInput"": ""Entrada total""
  },
  ""recentActivity"": {
    ""title"": ""Actividad Reciente"",
    ""columns"": {
      ""subject"": ""Animal / Asunto"",
      ""type"": ""Tipo"",
      ""date"": ""Fecha"",
      ""status"": ""Estado""
    },
    ""types"": {
      ""animal"": ""Animal"",
      ""event"": ""Evento"",
      ""product"": ""Producto"",
      ""adoptionApplication"": ""Solicitud Adopción"",
      ""newSponsor"": ""Nuevo Padrino"",
      ""onlineSale"": ""Venta Online""
    },
    ""status"": {
      ""pending"": ""Pendiente"",
      ""active"": ""Activo"",
      ""sent"": ""Enviado""
    }
  },
  ""quickActions"": {
    ""title"": ""Acciones Rápidas"",
    ""newAnimal"": ""Nuevo Animal"",
    ""registerExpense"": ""Registrar Gasto"",
    ""createCampaign"": ""Crear Campaña""
  },
  ""needsAttention"": {
    ""title"": ""Requiere Atención"",
    ""viewAllTasks"": ""Ver todas las tareas"",
    ""alerts"": {
      ""veterinaryReview"": {
        ""title"": ""Revisión Veterinaria"",
        ""message"": ""{animalName} necesita su vacuna anual antes del {date}.""
      },
      ""lowStock"": {
        ""title"": ""Stock Bajo"",
        ""message"": ""Quedan menos de {count} bolsas de alimento cachorro.""
      },
      ""volunteersNeeded"": {
        ""title"": ""Voluntarios Sábado"",
        ""message"": ""Faltan {count} cupos para la jornada de limpieza.""
      }
    }
  },
  ""errors"": {
    ""loadFailed"": ""Error al cargar el dashboard"",
    ""unauthorized"": ""No tienes permisos para ver el dashboard""
  }
}
```

**src/messages/en/dashboard.json:** (traducciones en inglés de manera similar)

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que el dashboard se carga correctamente)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones manuales:
- [ ] El dashboard se ve igual al diseño de referencia
- [ ] Las métricas se cargan correctamente desde Supabase
- [ ] La actividad reciente muestra datos reales
- [ ] Las alertas se generan correctamente
- [ ] Los estados de loading funcionan
- [ ] Se manejan errores correctamente
- [ ] Los mensajes están traducidos
- [ ] El dashboard es responsive
- [ ] La navegación funciona correctamente

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página del dashboard creada y accesible
- [ ] Header del dashboard implementado
- [ ] 4 KPI cards implementadas (1 desde BD, 3 mock)
- [ ] Métrica ""Animales en Cuidado"" funciona con Supabase
- [ ] Sección ""Embudo de Adopción"" implementada (mock)
- [ ] Tabla ""Actividad Reciente"" implementada con datos reales
- [ ] Sección ""Acciones Rápidas"" implementada
- [ ] Sección ""Requiere Atención"" implementada con alertas desde BD
- [ ] `GetDashboardDataUseCase` creado y funcional
- [ ] Repositorios extendidos/creados (Animal, Event, Product)
- [ ] Dashboard conectado con UseCase
- [ ] Manejo de errores implementado y traducido
- [ ] Estados de loading implementados
- [ ] Obtener `foundation_id` del usuario funciona correctamente
- [ ] **Traducciones incluidas**:
  - [ ] Textos agregados en `src/messages/es/dashboard.json`
  - [ ] Textos agregados en `src/messages/en/dashboard.json`
  - [ ] Componentes usan `useTranslations` (no textos hardcodeados)
  - [ ] Keys consistentes entre idiomas
- [ ] Layout responsive
- [ ] Navegación funcional desde botones
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add foundation dashboard with metrics and recent activity`",Backlog,Normal,HU
HU-026 — Catálogo de Adopción (UI + Supabase),"# HU-026 — Catálogo de Adopción (UI + Supabase)

**Como** usuario externo  
**Quiero** navegar al catálogo de adopción desde el navbar  
**Para** ver animales disponibles y filtrar por mis preferencias

---

## Dependencias

- HU-001 (Next.js App Router)
- HU-007 (Tailwind configurado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-011 (Conexión a Supabase configurada)
- HU-016 (Sistema de traducciones configurado)

---

## Contexto / Notas

- Esta HU implementa el **catálogo público de adopción** con filtros, búsqueda y paginación.
- La UI debe seguir el diseño de `docs/design/adopt_screen.png` y `docs/design/adopt_code.html`.
- La ruta debe estar en `/adopt` (o `app/[locale]/adopt/page.tsx`).
- La data proviene de Supabase usando el modelo `animals` y `animal_photos` en `docs/scripts/db.sql`.
- **Solo se muestran animales disponibles** y publicados:
  - `status = 'available'`
  - `is_published = true`
- Si un animal no tiene `cover_image_url`, se usa la primera foto de `animal_photos` (si existe).
- Algunos elementos del diseño **no existen en la BD** (p. ej. “Urgent Need”):
  - Se adaptan con reglas derivadas de campos existentes (ver reglas técnicas).

Modelo de datos disponible (según `docs/scripts/db.sql`):
- Tabla `animals`:
  - `id`, `foundation_id`, `name`, `species`, `breed`, `sex`, `age_months`, `size`, `status`, `description`, `cover_image_url`, `is_published`, `created_at`
- Tabla `animal_photos` (relación 1:N):
  - `id`, `animal_id`, `url`, `sort_order`

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/adopt_code.html`
- Imagen: `docs/design/adopt_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del catálogo:
- **Navbar** (con opción “Adopta” activa)
- **Hero**:
  - Título principal
  - Subtítulo descriptivo
- **Sidebar de filtros**:
  - Toggle “Urgent Need” (adaptado a reglas derivadas)
  - Animal Type (Dogs, Cats, Others)
  - Age (Puppy, Young, Adult, Senior)
  - Size (Small, Medium, Large)
- **Barra superior**:
  - Search input (placeholder “Search by name, breed...”)
  - Sort dropdown (Newest Arrivals, Oldest Arrivals, Urgent Need)
- **Grid de cards**:
  - Imagen del animal
  - Nombre
  - Badge de sexo
  - Descripción corta
  - Edad y tamaño
  - CTA: “Adopt” + “Details”
- **Paginación** al final
- **Footer** público

Reglas:
- Respetar la jerarquía visual del diseño.
- Usar tokens del Design System.
- Grid responsive (1/2/3 columnas según breakpoints).
- Sidebar sticky en desktop.
- Paginación funcional.

---

## Alcance

Incluye:
- Crear página pública `/adopt`
- Renderizar el catálogo según diseño
- Traer animales desde Supabase
- Filtrar por:
  - Species (dog/cat/other)
  - Size (small/medium/large)
  - Age (derivado de `age_months`)
  - “Urgent Need” (derivado de `created_at` y/o `age_months`)
- Buscar por nombre y raza
- Ordenar por:
  - Newest Arrivals (`created_at DESC`)
  - Oldest Arrivals (`created_at ASC`)
  - Urgent Need (regla derivada)
- Paginación server-side
- Mostrar solo `status = available` y `is_published = true`
- Mostrar fallback de imagen usando `animal_photos`
- Botón “Details” navega a `/adopt/[id]` (HU-027)
- Traducciones completas (ES/EN)
- Estados de loading y error

No incluye:
- Favoritos reales (botón corazón solo UI)
- Adopción real (CTA “Adopt” sin flujo backend)
- Patrocinio real
- Sistema de solicitudes
- Tests automatizados

---

## Criterios de aceptación (Given / When / Then)

### 1) Ruta del catálogo creada

- **Dado** que navego al sitio
- **Cuando** hago clic en “Adopta” en el navbar
- **Entonces** navego a `/adopt`
- **Y** veo el catálogo completo

---

### 2) Catálogo muestra animales disponibles

- **Dado** animales con `status = 'available'` y `is_published = true`
- **Cuando** carga el catálogo
- **Entonces** se listan solo esos animales
- **Y** no aparecen animales `adopted`, `inactive` o no publicados

---

### 3) Imágenes con fallback

- **Dado** un animal sin `cover_image_url`
- **Cuando** se renderiza la card
- **Entonces** se usa la primera foto de `animal_photos` (sort_order asc)
- **Y** si no hay fotos, se muestra placeholder

---

### 4) Búsqueda funcional

- **Dado** que escribo un término en el search
- **Cuando** busco por nombre o raza
- **Entonces** se filtran los animales por `name` o `breed`
- **Y** la búsqueda es case-insensitive

---

### 5) Filtros por especie y tamaño

- **Dado** filtros seleccionados
- **Cuando** aplico Species/Size
- **Entonces** se actualiza el listado con los resultados
- **Y** los filtros pueden combinarse

---

### 6) Filtro por edad (derivado)

- **Dado** el filtro de edad
- **Cuando** selecciono Puppy/Young/Adult/Senior
- **Entonces** se filtra usando `age_months`:
  - Puppy: 0–11
  - Young: 12–35
  - Adult: 36–83
  - Senior: 84+

---

### 7) Filtro “Urgent Need”

- **Dado** que activo “Urgent Need”
- **Cuando** se filtra
- **Entonces** se muestran animales que cumplen la regla derivada:
  - `created_at` más antiguo que 90 días **o**
  - `age_months` <= 6 (cachorros)
- **Y** la regla usa solo datos existentes

---

### 8) Ordenamiento

- **Dado** que selecciono un orden
- **Cuando** aplico el sort
- **Entonces** se ordena por:
  - Newest Arrivals → `created_at DESC`
  - Oldest Arrivals → `created_at ASC`
  - Urgent Need → regla derivada con prioridad

---

### 9) Paginación server-side

- **Dado** que hay más resultados que el page size
- **Cuando** cambio de página
- **Entonces** se consulta Supabase con `range()`
- **Y** el listado se actualiza correctamente

---

### 10) Botón “Details”

- **Dado** un animal en la card
- **Cuando** hago clic en “Details”
- **Entonces** navego a `/adopt/[id]`

---

### 11) Estados de loading

- **Dado** que se consulta Supabase
- **Cuando** se carga el catálogo
- **Entonces** se muestra un estado de loading
- **Y** al finalizar desaparece

---

### 12) Manejo de errores

- **Dado** que ocurre un error al consultar
- **Cuando** Supabase retorna error
- **Entonces** se muestra un mensaje traducido
- **Y** la UI no se rompe

---

### 13) Traducciones

- **Dado** que se implementa la UI
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations`
- **Y** existen traducciones en `src/messages/es/adopt.json` y `src/messages/en/adopt.json`

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- Supabase solo vive en Infrastructure.

### Supabase / Queries
- Query base:
  - `SELECT * FROM animals WHERE status = 'available' AND is_published = true`
- Filtros:
  - `species` → `eq('species', value)`
  - `size` → `eq('size', value)`
  - `age_months` → rango según categoría
  - `search` → `or(name.ilike.%q%, breed.ilike.%q%)`
- Ordenamiento:
  - `created_at ASC/DESC`
  - “Urgent Need” → ordenar por `created_at ASC` y filtrar por regla derivada
- Paginación:
  - `range(from, to)` con `count: 'exact'`

### Urgent Need (regla derivada)
- No existe campo en BD.
- Se define como:
  - `created_at` <= hoy - 90 días **o**
  - `age_months` <= 6
- Badge “URGENT” se muestra si cumple la regla.

### Traducciones
- Usar `useTranslations('adopt')`.
- No hardcodear textos.

### Dependencias / Paquetes
- No agregar dependencias nuevas.

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/[locale]/adopt/page.tsx

src/presentation/components/adopt/
├── AdoptCatalogPage.tsx
├── AdoptFilters.tsx
├── AdoptSearchBar.tsx
├── AdoptSortSelect.tsx
├── AdoptGrid.tsx
├── AdoptCard.tsx
└── AdoptPagination.tsx

src/domain/
├── models/
│   └── AdoptCatalogItem.ts
├── repositories/
│   └── IAnimalRepository.ts (extender con getAdoptCatalog)
└── usecases/
    └── adopt/
        └── GetAdoptCatalogUseCase.ts

src/infrastructure/
├── repositories/
│   └── AnimalRepository.ts (implementar getAdoptCatalog)
└── ioc/
    └── bindings actualizados

src/messages/
├── es/
│   └── adopt.json
└── en/
    └── adopt.json
```

---

## Validación

Comandos mínimos:
- `npm run dev`
- `npm run build`

Verificaciones:
- El catálogo se ve igual al diseño
- Filtros y búsqueda funcionan
- Paginación funciona
- Datos reales desde Supabase
- Traducciones completas

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Catálogo público creado y funcional
- [ ] Filtros, búsqueda y ordenamiento funcionando
- [ ] Paginación server-side funcionando
- [ ] Datos de Supabase mostrados correctamente
- [ ] Traducciones incluidas (ES/EN)
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add adopt catalog with filters and supabase data`",Backlog,Normal,HU
HU-027 — Detalle de Animal en Adopción (UI + Supabase),"# HU-027 — Detalle de Animal en Adopción (UI + Supabase)

**Como** usuario externo  
**Quiero** ver el detalle completo de un animal del catálogo  
**Para** conocer su historia, fotos y características antes de adoptar

---

## Dependencias

- HU-001 (Next.js App Router)
- HU-007 (Tailwind configurado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-011 (Conexión a Supabase configurada)
- HU-016 (Sistema de traducciones configurado)
- HU-026 (Catálogo de adopción implementado) - **REQUERIDO**

---

## Contexto / Notas

- Esta HU implementa la **vista de detalle** de un animal desde el catálogo público.
- La UI debe seguir el diseño de `docs/design/info_adopt_screen.png` y `docs/design/info_adopt_code.html`.
- La ruta debe ser `/adopt/[id]` (o `app/[locale]/adopt/[id]/page.tsx`).
- La data proviene de Supabase (`animals` y `animal_photos`).
- Solo se muestran animales `is_published = true`.
- El diseño incluye secciones no soportadas por la BD (historial, salud):
  - **No se inventan datos**; se ocultan o se muestran placeholders de “sin datos”.

Modelo de datos disponible:
- `animals`: `id`, `name`, `species`, `breed`, `sex`, `age_months`, `size`, `status`, `description`, `cover_image_url`, `is_published`, `created_at`
- `animal_photos`: `animal_id`, `url`, `sort_order`

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/info_adopt_code.html`
- Imagen: `docs/design/info_adopt_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura del detalle:
- **Breadcrumbs**: Perros > Adopciones > [Nombre]
- **Galería**:
  - Imagen principal (cover)
  - Thumbnails (fotos adicionales)
  - Botón de favorito (UI)
  - Badge de status (Disponible)
- **Panel de información**:
  - Nombre
  - Ubicación (no disponible en BD → ocultar o placeholder)
  - Edad (derivada de `age_months`)
  - Chips (sexo, tamaño, especie)
  - Descripción completa
  - CTA: Adoptar / Apadrinar (UI)
- **Sección “Historial”** (no disponible en BD → ocultar o placeholder)
- **Sección “Otros amigos buscando hogar”** (recomendados)

---

## Alcance

Incluye:
- Crear página `/adopt/[id]`
- Obtener detalle del animal desde Supabase
- Obtener fotos desde `animal_photos`
- Mostrar galería con imagen principal y thumbnails
- Mostrar datos reales: nombre, edad, sexo, especie, tamaño, descripción, status
- Mostrar CTA de adopción (sin flujo real)
- Mostrar animales recomendados (otros `available` publicados)
- Manejar estado de loading y error
- Traducciones completas (ES/EN)

No incluye:
- Historial clínico o eventos (no existe en BD)
- Estado de salud (vacunado, esterilizado, etc.)
- Ubicación real (no existe en BD)
- Favoritos reales
- Flujo real de adopción/apadrinamiento
- Tests automatizados

---

## Criterios de aceptación (Given / When / Then)

### 1) Ruta de detalle creada

- **Dado** un animal en el catálogo
- **Cuando** hago clic en “Details”
- **Entonces** navego a `/adopt/[id]`
- **Y** veo la página de detalle

---

### 2) Datos del animal cargados

- **Dado** un animal publicado en Supabase
- **Cuando** carga la página
- **Entonces** se obtiene `animals` por `id`
- **Y** se muestran nombre, especie, sexo, tamaño, descripción, edad

---

### 3) Galería de fotos

- **Dado** que existen fotos en `animal_photos`
- **Cuando** se muestra la galería
- **Entonces** la imagen principal es `cover_image_url` o la primera foto
- **Y** los thumbnails muestran las demás fotos

---

### 4) Edad derivada

- **Dado** `age_months`
- **Cuando** se muestra la edad
- **Entonces** se formatea a años/meses según regla:
  - >= 12 → “X años”
  - < 12 → “X meses”

---

### 5) Status visible

- **Dado** `status` en BD
- **Cuando** se renderiza la card principal
- **Entonces** se muestra badge de estado traducido
- **Y** solo se permite acceder si `is_published = true`

---

### 6) Secciones sin datos en BD

- **Dado** que no existe “historial” ni “salud”
- **Cuando** se renderiza la página
- **Entonces** esas secciones se ocultan o muestran texto “sin información”
- **Y** no se inventan datos

---

### 7) Recomendados

- **Dado** el animal actual
- **Cuando** carga la sección “Otros amigos buscando hogar”
- **Entonces** se consultan otros animales `available` publicados
- **Y** se muestran en cards
- **Y** no incluye al animal actual

---

### 8) Estado de loading

- **Dado** que se consulta Supabase
- **Cuando** carga la página
- **Entonces** se muestra un estado de loading
- **Y** desaparece al finalizar

---

### 9) Manejo de errores

- **Dado** que el animal no existe o hay error
- **Cuando** se consulta Supabase
- **Entonces** se muestra un mensaje traducido
- **Y** la UI no se rompe

---

### 10) Traducciones

- **Dado** que se implementa la UI
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations`
- **Y** existen traducciones en `src/messages/es/adopt-detail.json` y `src/messages/en/adopt-detail.json`

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC.
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- Supabase solo vive en Infrastructure.

### Supabase / Queries
- Detalle:
  - `SELECT * FROM animals WHERE id = :id AND is_published = true`
- Fotos:
  - `SELECT * FROM animal_photos WHERE animal_id = :id ORDER BY sort_order`
- Recomendados:
  - `SELECT * FROM animals WHERE status = 'available' AND is_published = true AND id != :id LIMIT 4`

### Traducciones
- Usar `useTranslations('adoptDetail')`.
- No hardcodear textos.

### Dependencias / Paquetes
- No agregar dependencias nuevas.

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/[locale]/adopt/[id]/page.tsx

src/presentation/components/adopt-detail/
├── AdoptDetailPage.tsx
├── AdoptBreadcrumbs.tsx
├── AdoptGallery.tsx
├── AdoptInfoPanel.tsx
├── AdoptHistory.tsx (opcional, placeholder)
└── AdoptRelatedGrid.tsx

src/domain/
├── models/
│   └── AdoptDetail.ts
├── repositories/
│   └── IAnimalRepository.ts (extender con getAdoptDetail, getRelatedAnimals)
└── usecases/
    └── adopt/
        └── GetAdoptDetailUseCase.ts

src/infrastructure/
├── repositories/
│   └── AnimalRepository.ts (implementar getAdoptDetail, getRelatedAnimals)
└── ioc/
    └── bindings actualizados

src/messages/
├── es/
│   └── adopt-detail.json
└── en/
    └── adopt-detail.json
```

---

## Validación

Comandos mínimos:
- `npm run dev`
- `npm run build`

Verificaciones:
- Vista coincide con el diseño
- Datos reales desde Supabase
- Galería funcional
- Recomendados funcionan
- Traducciones completas

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Vista de detalle creada y funcional
- [ ] Datos reales desde Supabase
- [ ] Galería de fotos funcionando
- [ ] Recomendados funcionando
- [ ] Traducciones incluidas (ES/EN)
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add adopt animal detail with supabase data`",Backlog,Normal,HU
HU-028 — Tienda Solidaria (Catálogo de Productos con Supabase),"# HU-028 — Tienda Solidaria (Catálogo de Productos con Supabase)

**Como** usuario externo  
**Quiero** acceder a la tienda solidaria  
**Para** comprar productos de fundaciones y apoyar su labor

---

## Dependencias

- HU-001 (Next.js App Router)
- HU-007 (Tailwind configurado)
- HU-010 (Atomic Design - componentes reutilizables)
- HU-011 (Conexión a Supabase configurada)
- HU-016 (Sistema de traducciones configurado)

---

## Contexto / Notas

- Esta HU implementa la **Tienda Solidaria** como catálogo público de productos.
- El diseño está en `docs/design/shop_screen.png` y `docs/design/shop_code.html`.
- La ruta debe ser `/shop` (o `app/[locale]/shop/page.tsx`).
- La data proviene de Supabase usando el modelo `products` y `foundations` de `docs/scripts/db.sql`.
- Solo se muestran productos **publicados**:
  - `is_published = true`
- El catálogo se agrupa por fundación (secciones por fundación).
- No existen categorías ni stock en la BD → no se inventan datos.

Modelo de datos disponible (según `docs/scripts/db.sql`):
- Tabla `products`:
  - `id`, `foundation_id`, `name`, `description`, `price`, `image_url`, `is_published`, `created_at`
- Tabla `foundations`:
  - `id`, `name`, `logo_url`, `city`, `country`

---

## Diseño (OBLIGATORIO)

Referencias:
- Diseño: `docs/design/shop_code.html`
- Imagen: `docs/design/shop_screen.png`
- Design System: `docs/design/system.md`
- Esquema BD: `docs/scripts/db.sql`

Estructura de la página:
- **Navbar** (con opción “Tienda” activa)
- **Hero**:
  - Título: “Tienda Solidaria”
  - Subtítulo descriptivo
  - Barra de búsqueda + select de fundaciones + botón de buscar
- **Secciones por fundación**:
  - Encabezado con nombre y ubicación
  - Link “Ver todo”
  - Grid de cards de productos (4 columnas desktop)
- **Card de donación** (estática, diseño):
  - “Dona un Bulto” (UI, sin funcionalidad real)
- **Sección CTA**: “¿Tienes una fundación?”
- **Footer** público

Reglas:
- Respetar jerarquía visual del diseño.
- Usar tokens del Design System.
- Layout responsive.
- El catálogo debe parecer al diseño (sombras, bordes, badges).

---

## Alcance

Incluye:
- Crear página `/shop`
- Implementar UI completa según diseño
- Traer productos publicados desde Supabase
- Traer información de fundaciones desde Supabase
- Agrupar productos por fundación
- Búsqueda por nombre y descripción del producto
- Filtro por fundación (select)
- Paginación (si hay muchos productos)
- Mostrar precio con formato moneda
- Mostrar imagen del producto (`image_url`)
- Estados de loading y error
- Traducciones completas (ES/EN)

No incluye:
- Carrito de compras real
- Flujo de pago
- Stock o inventario (no existe en BD)
- Favoritos reales
- Categorías (no existe en BD)
- Tests automatizados

---

## Criterios de aceptación (Given / When / Then)

### 1) Ruta de tienda creada

- **Dado** que estoy en el sitio
- **Cuando** hago clic en “Tienda” en el navbar
- **Entonces** navego a `/shop`
- **Y** veo la tienda solidaria

---

### 2) Se muestran productos publicados

- **Dado** productos con `is_published = true`
- **Cuando** carga la tienda
- **Entonces** se muestran solo productos publicados
- **Y** los no publicados no aparecen

---

### 3) Agrupación por fundación

- **Dado** productos de varias fundaciones
- **Cuando** se renderiza el catálogo
- **Entonces** se agrupa por fundación
- **Y** cada sección muestra el nombre y ubicación de la fundación

---

### 4) Búsqueda funcional

- **Dado** que escribo un término en el buscador
- **Cuando** busco por nombre o descripción
- **Entonces** se filtran productos por `name` o `description`
- **Y** la búsqueda es case-insensitive

---

### 5) Filtro por fundación

- **Dado** el select de fundaciones
- **Cuando** elijo una fundación
- **Entonces** se muestran productos solo de esa fundación
- **Y** el título de la sección coincide con la fundación seleccionada

---

### 6) Botón “Ver todo”

- **Dado** una sección de fundación
- **Cuando** hago clic en “Ver todo”
- **Entonces** se aplica filtro por esa fundación
- **Y** se muestran sus productos

---

### 7) Formato de precio

- **Dado** un producto con `price`
- **Cuando** se renderiza la card
- **Entonces** el precio se muestra formateado (ej: `$85.000`)

---

### 8) Estados de loading

- **Dado** que se consulta Supabase
- **Cuando** carga la tienda
- **Entonces** se muestra un estado de loading
- **Y** desaparece al finalizar

---

### 9) Manejo de errores

- **Dado** que ocurre un error al consultar
- **Cuando** Supabase retorna error
- **Entonces** se muestra un mensaje traducido
- **Y** la UI no se rompe

---

### 10) Traducciones

- **Dado** que se implementa la UI
- **Cuando** se revisa el código
- **Entonces** todos los textos usan `useTranslations`
- **Y** existen traducciones en `src/messages/es/shop.json` y `src/messages/en/shop.json`

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC.
- Domain no importa React/Next/MUI/Tailwind/Inversify/Supabase.
- Infrastructure contiene implementaciones y wiring IoC.
- Supabase solo vive en Infrastructure.

### Supabase / Queries
- Productos publicados:
  - `SELECT * FROM products WHERE is_published = true`
- Filtro por fundación:
  - `eq('foundation_id', value)`
- Búsqueda:
  - `or(name.ilike.%q%, description.ilike.%q%)`
- Orden:
  - `created_at DESC` (por defecto)
- Paginación:
  - `range(from, to)` con `count: 'exact'`
- Fundaciones:
  - `SELECT id, name, city, country, logo_url FROM foundations`

### Traducciones
- Usar `useTranslations('shop')`.
- No hardcodear textos.

### Dependencias / Paquetes
- No agregar dependencias nuevas.

---

## Implementación sugerida

### Estructura de archivos sugerida:
```
src/app/[locale]/shop/page.tsx

src/presentation/components/shop/
├── ShopPage.tsx
├── ShopHero.tsx
├── ShopSearchBar.tsx
├── ShopFoundationSection.tsx
├── ShopProductCard.tsx
└── ShopPagination.tsx

src/domain/
├── models/
│   └── ShopProduct.ts
├── repositories/
│   ├── IProductRepository.ts (extender con getShopProducts)
│   └── IFoundationRepository.ts (extender con getFoundationsList)
└── usecases/
    └── shop/
        └── GetShopCatalogUseCase.ts

src/infrastructure/
├── repositories/
│   ├── ProductRepository.ts (implementar getShopProducts)
│   └── FoundationRepository.ts (implementar getFoundationsList)
└── ioc/
    └── bindings actualizados

src/messages/
├── es/
│   └── shop.json
└── en/
    └── shop.json
```

---

## Validación

Comandos mínimos:
- `npm run dev`
- `npm run build`

Verificaciones:
- La tienda se ve igual al diseño
- Productos reales desde Supabase
- Filtro y búsqueda funcionan
- Agrupación por fundación correcta
- Traducciones completas

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Página de tienda creada y funcional
- [ ] Productos publicados desde Supabase
- [ ] Filtro por fundación y búsqueda funcionando
- [ ] Agrupación por fundación correcta
- [ ] Traducciones incluidas (ES/EN)
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `feat: add shop catalog with supabase products`",Backlog,Normal,HU
HU-2001 — Responsividad completa de pantallas (hasta Ultra Wide),"# HU-2001 — Responsividad completa de pantallas (hasta Ultra Wide)

**Como** usuario  
**Quiero** que las pantallas se vean correctamente en todos los tamaños de pantalla, incluyendo ultra wide  
**Para** tener una experiencia óptima independientemente del dispositivo o resolución

---

## Dependencias

- HU-012 (Formulario de registro UI implementado)
- Página Home implementada

---

## Contexto / Notas

- Esta HU corrige problemas de responsividad en las pantallas ya construidas.
- Se debe validar desde móvil (320px) hasta ultra wide (2560px+).
- Breakpoints a considerar:
  - Móvil: 320px - 640px
  - Tablet: 641px - 1024px
  - Desktop: 1025px - 1920px
  - Large Desktop: 1921px - 2560px
  - Ultra Wide: 2561px+
- Las pantallas a revisar son: Home y Registro.
- Se debe asegurar que el contenido no se estire excesivamente en pantallas grandes.
- Los contenedores deben tener max-width apropiados para mantener legibilidad.

---

## Alcance

Incluye:
- Revisar y corregir responsividad de la página Home
- Revisar y corregir responsividad de la página de Registro
- Validar en todos los breakpoints (móvil a ultra wide)
- Ajustar contenedores y espaciados para pantallas grandes
- Asegurar que imágenes y contenido se adapten correctamente
- Verificar que los textos mantengan legibilidad en todos los tamaños
- Ajustar grid layouts para pantallas ultra wide

No incluye:
- Cambios en la funcionalidad
- Nuevas features
- Cambios en el diseño visual (solo ajustes de responsividad)
- Otras pantallas que no sean Home y Registro

---

## Criterios de aceptación (Given / When / Then)

### 1) Responsividad en móvil (320px - 640px)

- **Dado** que accedo a Home o Registro en móvil
- **Cuando** visualizo las pantallas
- **Entonces** todo el contenido es accesible sin scroll horizontal
- **Y** los elementos se apilan verticalmente cuando corresponde
- **Y** los textos son legibles sin zoom
- **Y** los botones tienen tamaño táctil adecuado (mínimo 44x44px)

---

### 2) Responsividad en tablet (641px - 1024px)

- **Dado** que accedo a Home o Registro en tablet
- **Cuando** visualizo las pantallas
- **Entonces** el layout se adapta correctamente
- **Y** los elementos tienen espaciado apropiado
- **Y** las imágenes mantienen sus proporciones
- **Y** no hay espacios vacíos excesivos

---

### 3) Responsividad en desktop (1025px - 1920px)

- **Dado** que accedo a Home o Registro en desktop
- **Cuando** visualizo las pantallas
- **Entonces** el contenido está centrado y bien distribuido
- **Y** los contenedores tienen max-width apropiado
- **Y** el layout de dos columnas (registro) funciona correctamente
- **Y** los elementos no se ven demasiado separados

---

### 4) Responsividad en large desktop (1921px - 2560px)

- **Dado** que accedo a Home o Registro en large desktop
- **Cuando** visualizo las pantallas
- **Entonces** el contenido no se estira excesivamente
- **Y** los contenedores mantienen max-width razonable
- **Y** hay márgenes laterales apropiados
- **Y** el contenido sigue siendo legible y bien distribuido

---

### 5) Responsividad en ultra wide (2561px+)

- **Dado** que accedo a Home o Registro en ultra wide
- **Cuando** visualizo las pantallas
- **Entonces** el contenido está centrado con márgenes laterales amplios
- **Y** los contenedores no exceden un ancho máximo razonable (ej: 1400px-1600px)
- **Y** no hay elementos que se estiren desproporcionadamente
- **Y** la experiencia visual sigue siendo agradable

---

### 6) Imágenes responsivas

- **Dado** que hay imágenes en las pantallas
- **Cuando** cambio el tamaño de la ventana
- **Entonces** las imágenes se adaptan correctamente
- **Y** mantienen sus proporciones (aspect ratio)
- **Y** no se pixelan en pantallas grandes
- **Y** usan `next/image` con optimización

---

### 7) Grids y layouts responsivos

- **Dado** que hay grids o layouts en las pantallas
- **Cuando** cambio el tamaño de la ventana
- **Entonces** los grids se adaptan correctamente
- **Y** el número de columnas cambia según el breakpoint
- **Y** no hay overflow horizontal
- **Y** los elementos se reorganizan apropiadamente

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.
- **Solo cambios en Presentation**: componentes y estilos.

### Responsive Design
- Usar Tailwind breakpoints: `sm`, `md`, `lg`, `xl`, `2xl`.
- Considerar breakpoints personalizados si es necesario para ultra wide.
- Usar `Container` de MUI con `maxWidth` apropiado.
- Evitar valores fijos de ancho, preferir porcentajes y max-width.

### Breakpoints sugeridos:
- `sm`: 640px (móvil grande)
- `md`: 768px (tablet)
- `lg`: 1024px (desktop pequeño)
- `xl`: 1280px (desktop)
- `2xl`: 1536px (desktop grande)
- Considerar `3xl` o custom para ultra wide si es necesario

### Contenedores
- Usar `maxWidth` en contenedores para evitar estiramiento excesivo.
- En ultra wide, considerar centrar contenido con márgenes laterales.
- Mantener legibilidad: líneas de texto no muy largas (idealmente 60-75 caracteres).

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Pantallas a revisar:

1. **Home (`src/app/page.tsx`)**:
   - HomeNavBar
   - HeroSection
   - AiBanner
   - FeaturedAnimalsSection
   - PartnersSection
   - StoreSection
   - HomeFooter

2. **Registro (`src/app/register/page.tsx`)**:
   - RegisterHeader
   - RegisterForm
   - RegisterImageSection
   - RegisterFooter

### Ajustes sugeridos:

1. **Contenedores**:
   - Verificar que `Container` de MUI tenga `maxWidth` apropiado
   - En ultra wide, considerar wrapper adicional con max-width

2. **Grids**:
   - Revisar `FeaturedAnimalsSection` grid
   - Ajustar número de columnas según breakpoint
   - En ultra wide, limitar número de columnas visibles

3. **Espaciados**:
   - Ajustar padding/margin para pantallas grandes
   - Evitar espaciados excesivos en ultra wide

4. **Imágenes**:
   - Verificar que usen `next/image`
   - Ajustar `sizes` prop según breakpoint
   - Asegurar aspect ratio correcto

5. **Textos**:
   - Verificar que no se estiren demasiado en pantallas grandes
   - Considerar max-width en textos largos

---

## Validación

Comandos mínimos:
- `npm run dev` (probar en diferentes tamaños de ventana)
- `npm run build` (verificar que no hay errores)

Verificaciones:
- Probar en Chrome DevTools con diferentes dispositivos
- Probar en resoluciones: 320px, 768px, 1024px, 1920px, 2560px, 3840px
- Verificar que no hay scroll horizontal en ningún tamaño
- Verificar que el contenido se ve bien en todos los breakpoints
- Verificar que las imágenes se cargan correctamente

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Responsividad validada en móvil (320px - 640px)
- [ ] Responsividad validada en tablet (641px - 1024px)
- [ ] Responsividad validada en desktop (1025px - 1920px)
- [ ] Responsividad validada en large desktop (1921px - 2560px)
- [ ] Responsividad validada en ultra wide (2561px+)
- [ ] Imágenes responsivas funcionando correctamente
- [ ] Grids y layouts adaptándose correctamente
- [ ] Sin scroll horizontal en ningún tamaño
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `fix: improve responsiveness for home and register pages up to ultra wide`",Backlog,Normal,HU
